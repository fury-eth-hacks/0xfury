import{s as Bi,n as Ri,g as He,c as Oe,b as Ci,a as H,d as Ti,_ as Pi,e as Li,f as Oi,i as Ui,p as Ni,h as $i,r as S,j as cs,u as us,B as Cn,k as lt,l as nt,m as st,C as tr,o as tn,q as _t,t as Kt,v as gr,w as me,x as ft,y as T,z,A as Tn,W as rn,J as nn,D as sn,E as Fi}from"./index-68a90e2f.js";import{n as Mi}from"./nacl-fast-12fe1236.js";var Jt=Bi.Buffer;function Ki(n){if(n.length>=255)throw new TypeError("Alphabet too long");for(var e=new Uint8Array(256),t=0;t<e.length;t++)e[t]=255;for(var r=0;r<n.length;r++){var s=n.charAt(r),i=s.charCodeAt(0);if(e[i]!==255)throw new TypeError(s+" is ambiguous");e[i]=r}var o=n.length,a=n.charAt(0),c=Math.log(o)/Math.log(256),u=Math.log(256)/Math.log(o);function l(h){if((Array.isArray(h)||h instanceof Uint8Array)&&(h=Jt.from(h)),!Jt.isBuffer(h))throw new TypeError("Expected Buffer");if(h.length===0)return"";for(var d=0,y=0,g=0,k=h.length;g!==k&&h[g]===0;)g++,d++;for(var v=(k-g)*u+1>>>0,b=new Uint8Array(v);g!==k;){for(var P=h[g],x=0,L=v-1;(P!==0||x<y)&&L!==-1;L--,x++)P+=256*b[L]>>>0,b[L]=P%o>>>0,P=P/o>>>0;if(P!==0)throw new Error("Non-zero carry");y=x,g++}for(var C=v-y;C!==v&&b[C]===0;)C++;for(var F=a.repeat(d);C<v;++C)F+=n.charAt(b[C]);return F}function f(h){if(typeof h!="string")throw new TypeError("Expected String");if(h.length===0)return Jt.alloc(0);for(var d=0,y=0,g=0;h[d]===a;)y++,d++;for(var k=(h.length-d)*c+1>>>0,v=new Uint8Array(k);h[d];){var b=e[h.charCodeAt(d)];if(b===255)return;for(var P=0,x=k-1;(b!==0||P<g)&&x!==-1;x--,P++)b+=o*v[x]>>>0,v[x]=b%256>>>0,b=b/256>>>0;if(b!==0)throw new Error("Non-zero carry");g=P,d++}for(var L=k-g;L!==k&&v[L]===0;)L++;var C=Jt.allocUnsafe(y+(k-L));C.fill(0,0,y);for(var F=y;L!==k;)C[F++]=v[L++];return C}function p(h){var d=f(h);if(d)return d;throw new Error("Non-base"+o+" character")}return{encode:l,decodeUnsafe:f,decode:p}}var qi=Ki,Hi=qi,Di="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",J=Hi(Di);function zr(n){if(!Number.isSafeInteger(n)||n<0)throw new Error(`Wrong positive integer: ${n}`)}function zi(n){if(typeof n!="boolean")throw new Error(`Expected boolean, not ${n}`)}function ls(n,...e){if(!(n instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(e.length>0&&!e.includes(n.length))throw new TypeError(`Expected Uint8Array of length ${e}, not of length=${n.length}`)}function ji(n){if(typeof n!="function"||typeof n.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");zr(n.outputLen),zr(n.blockLen)}function Wi(n,e=!0){if(n.destroyed)throw new Error("Hash instance has been destroyed");if(e&&n.finished)throw new Error("Hash#digest() has already been called")}function Gi(n,e){ls(n);const t=e.outputLen;if(n.length<t)throw new Error(`digestInto() expects output buffer of length at least ${t}`)}const ve={number:zr,bool:zi,bytes:ls,hash:ji,exists:Wi,output:Gi};/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Vi=n=>new Uint32Array(n.buffer,n.byteOffset,Math.floor(n.byteLength/4)),Cr=n=>new DataView(n.buffer,n.byteOffset,n.byteLength),Ce=(n,e)=>n<<32-e|n>>>e,Ji=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Ji)throw new Error("Non little-endian hardware is not supported");Array.from({length:256},(n,e)=>e.toString(16).padStart(2,"0"));function Zi(n){if(typeof n!="string")throw new TypeError(`utf8ToBytes expected string, got ${typeof n}`);return new TextEncoder().encode(n)}function qt(n){if(typeof n=="string"&&(n=Zi(n)),!(n instanceof Uint8Array))throw new TypeError(`Expected input type is Uint8Array (got ${typeof n})`);return n}class on{clone(){return this._cloneInto()}}function ht(n){const e=r=>n().update(qt(r)).digest(),t=n();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>n(),e}function Xi(n){const e=(r,s)=>n(s).update(qt(r)).digest(),t=n({});return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=r=>n(r),e}function Yi(n,e,t,r){if(typeof n.setBigUint64=="function")return n.setBigUint64(e,t,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(t>>s&i),a=Number(t&i),c=r?4:0,u=r?0:4;n.setUint32(e+c,o,r),n.setUint32(e+u,a,r)}class fs extends on{constructor(e,t,r,s){super(),this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Cr(this.buffer)}update(e){ve.exists(this);const{view:t,buffer:r,blockLen:s}=this;e=qt(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=Cr(e);for(;s<=i-o;o+=s)this.process(c,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){ve.exists(this),ve.output(e,this),this.finished=!0;const{buffer:t,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(r,0),o=0);for(let f=o;f<s;f++)t[f]=0;Yi(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=Cr(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=c/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(let f=0;f<u;f++)a.setUint32(4*f,l[f],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%t&&e.buffer.set(r),e}}const Zt=BigInt(2**32-1),jr=BigInt(32);function hs(n,e=!1){return e?{h:Number(n&Zt),l:Number(n>>jr&Zt)}:{h:Number(n>>jr&Zt)|0,l:Number(n&Zt)|0}}function Qi(n,e=!1){let t=new Uint32Array(n.length),r=new Uint32Array(n.length);for(let s=0;s<n.length;s++){const{h:i,l:o}=hs(n[s],e);[t[s],r[s]]=[i,o]}return[t,r]}const eo=(n,e)=>BigInt(n>>>0)<<jr|BigInt(e>>>0),to=(n,e,t)=>n>>>t,ro=(n,e,t)=>n<<32-t|e>>>t,no=(n,e,t)=>n>>>t|e<<32-t,so=(n,e,t)=>n<<32-t|e>>>t,io=(n,e,t)=>n<<64-t|e>>>t-32,oo=(n,e,t)=>n>>>t-32|e<<64-t,ao=(n,e)=>e,co=(n,e)=>n,uo=(n,e,t)=>n<<t|e>>>32-t,lo=(n,e,t)=>e<<t|n>>>32-t,fo=(n,e,t)=>e<<t-32|n>>>64-t,ho=(n,e,t)=>n<<t-32|e>>>64-t;function po(n,e,t,r){const s=(e>>>0)+(r>>>0);return{h:n+t+(s/2**32|0)|0,l:s|0}}const go=(n,e,t)=>(n>>>0)+(e>>>0)+(t>>>0),yo=(n,e,t,r)=>e+t+r+(n/2**32|0)|0,mo=(n,e,t,r)=>(n>>>0)+(e>>>0)+(t>>>0)+(r>>>0),wo=(n,e,t,r,s)=>e+t+r+s+(n/2**32|0)|0,bo=(n,e,t,r,s)=>(n>>>0)+(e>>>0)+(t>>>0)+(r>>>0)+(s>>>0),vo=(n,e,t,r,s,i)=>e+t+r+s+i+(n/2**32|0)|0,K={fromBig:hs,split:Qi,toBig:eo,shrSH:to,shrSL:ro,rotrSH:no,rotrSL:so,rotrBH:io,rotrBL:oo,rotr32H:ao,rotr32L:co,rotlSH:uo,rotlSL:lo,rotlBH:fo,rotlBL:ho,add:po,add3L:go,add3H:yo,add4L:mo,add4H:wo,add5H:vo,add5L:bo},[So,ko]=K.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(n=>BigInt(n))),ze=new Uint32Array(80),je=new Uint32Array(80);class yr extends fs{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:r,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:u,El:l,Fh:f,Fl:p,Gh:h,Gl:d,Hh:y,Hl:g}=this;return[e,t,r,s,i,o,a,c,u,l,f,p,h,d,y,g]}set(e,t,r,s,i,o,a,c,u,l,f,p,h,d,y,g){this.Ah=e|0,this.Al=t|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=u|0,this.El=l|0,this.Fh=f|0,this.Fl=p|0,this.Gh=h|0,this.Gl=d|0,this.Hh=y|0,this.Hl=g|0}process(e,t){for(let b=0;b<16;b++,t+=4)ze[b]=e.getUint32(t),je[b]=e.getUint32(t+=4);for(let b=16;b<80;b++){const P=ze[b-15]|0,x=je[b-15]|0,L=K.rotrSH(P,x,1)^K.rotrSH(P,x,8)^K.shrSH(P,x,7),C=K.rotrSL(P,x,1)^K.rotrSL(P,x,8)^K.shrSL(P,x,7),F=ze[b-2]|0,Y=je[b-2]|0,ke=K.rotrSH(F,Y,19)^K.rotrBH(F,Y,61)^K.shrSH(F,Y,6),De=K.rotrSL(F,Y,19)^K.rotrBL(F,Y,61)^K.shrSL(F,Y,6),Fe=K.add4L(C,De,je[b-7],je[b-16]),mt=K.add4H(Fe,L,ke,ze[b-7],ze[b-16]);ze[b]=mt|0,je[b]=Fe|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:u,Dl:l,Eh:f,El:p,Fh:h,Fl:d,Gh:y,Gl:g,Hh:k,Hl:v}=this;for(let b=0;b<80;b++){const P=K.rotrSH(f,p,14)^K.rotrSH(f,p,18)^K.rotrBH(f,p,41),x=K.rotrSL(f,p,14)^K.rotrSL(f,p,18)^K.rotrBL(f,p,41),L=f&h^~f&y,C=p&d^~p&g,F=K.add5L(v,x,C,ko[b],je[b]),Y=K.add5H(F,k,P,L,So[b],ze[b]),ke=F|0,De=K.rotrSH(r,s,28)^K.rotrBH(r,s,34)^K.rotrBH(r,s,39),Fe=K.rotrSL(r,s,28)^K.rotrBL(r,s,34)^K.rotrBL(r,s,39),mt=r&i^r&a^i&a,Rr=s&o^s&c^o&c;k=y|0,v=g|0,y=h|0,g=d|0,h=f|0,d=p|0,{h:f,l:p}=K.add(u|0,l|0,Y|0,ke|0),u=a|0,l=c|0,a=i|0,c=o|0,i=r|0,o=s|0;const Vt=K.add3L(ke,Fe,Rr);r=K.add3H(Vt,Y,De,mt),s=Vt|0}({h:r,l:s}=K.add(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=K.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=K.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:u,l}=K.add(this.Dh|0,this.Dl|0,u|0,l|0),{h:f,l:p}=K.add(this.Eh|0,this.El|0,f|0,p|0),{h,l:d}=K.add(this.Fh|0,this.Fl|0,h|0,d|0),{h:y,l:g}=K.add(this.Gh|0,this.Gl|0,y|0,g|0),{h:k,l:v}=K.add(this.Hh|0,this.Hl|0,k|0,v|0),this.set(r,s,i,o,a,c,u,l,f,p,h,d,y,g,k,v)}roundClean(){ze.fill(0),je.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class Ao extends yr{constructor(){super(),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735,this.outputLen=28}}class xo extends yr{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}}class _o extends yr{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}}const Eo=ht(()=>new yr);ht(()=>new Ao);ht(()=>new xo);ht(()=>new _o);/*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) */const ue=BigInt(0),W=BigInt(1),Ze=BigInt(2),Io=BigInt(8),Pn=BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),X=Object.freeze({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),l:Pn,n:Pn,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")}),ds=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000"),Lt=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742");const Bo=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),Ro=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),Co=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),To=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");class j{constructor(e,t,r,s){this.x=e,this.y=t,this.z=r,this.t=s}static fromAffine(e){if(!(e instanceof te))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return e.equals(te.ZERO)?j.ZERO:new j(e.x,e.y,W,A(e.x*e.y))}static toAffineBatch(e){const t=Oo(e.map(r=>r.z));return e.map((r,s)=>r.toAffine(t[s]))}static normalizeZ(e){return this.toAffineBatch(e).map(this.fromAffine)}equals(e){On(e);const{x:t,y:r,z:s}=this,{x:i,y:o,z:a}=e,c=A(t*a),u=A(i*s),l=A(r*a),f=A(o*s);return c===u&&l===f}negate(){return new j(A(-this.x),this.y,this.z,A(-this.t))}double(){const{x:e,y:t,z:r}=this,{a:s}=X,i=A(e*e),o=A(t*t),a=A(Ze*A(r*r)),c=A(s*i),u=e+t,l=A(A(u*u)-i-o),f=c+o,p=f-a,h=c-o,d=A(l*p),y=A(f*h),g=A(l*h),k=A(p*f);return new j(d,y,k,g)}add(e){On(e);const{x:t,y:r,z:s,t:i}=this,{x:o,y:a,z:c,t:u}=e,l=A((r-t)*(a+o)),f=A((r+t)*(a-o)),p=A(f-l);if(p===ue)return this.double();const h=A(s*Ze*u),d=A(i*Ze*c),y=d+h,g=f+l,k=d-h,v=A(y*p),b=A(g*k),P=A(y*k),x=A(p*g);return new j(v,b,x,P)}subtract(e){return this.add(e.negate())}precomputeWindow(e){const t=1+256/e,r=[];let s=this,i=s;for(let o=0;o<t;o++){i=s,r.push(i);for(let a=1;a<2**(e-1);a++)i=i.add(s),r.push(i);s=i.double()}return r}wNAF(e,t){!t&&this.equals(j.BASE)&&(t=te.BASE);const r=t&&t._WINDOW_SIZE||1;if(256%r)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let s=t&&Wr.get(t);s||(s=this.precomputeWindow(r),t&&r!==1&&(s=j.normalizeZ(s),Wr.set(t,s)));let i=j.ZERO,o=j.BASE;const a=1+256/r,c=2**(r-1),u=BigInt(2**r-1),l=2**r,f=BigInt(r);for(let p=0;p<a;p++){const h=p*c;let d=Number(e&u);e>>=f,d>c&&(d-=l,e+=W);const y=h,g=h+Math.abs(d)-1,k=p%2!==0,v=d<0;d===0?o=o.add(Ln(k,s[y])):i=i.add(Ln(v,s[g]))}return j.normalizeZ([i,o])[0]}multiply(e,t){return this.wNAF(nr(e,X.l),t)}multiplyUnsafe(e){let t=nr(e,X.l,!1);const r=j.BASE,s=j.ZERO;if(t===ue)return s;if(this.equals(s)||t===W)return this;if(this.equals(r))return this.wNAF(t);let i=s,o=this;for(;t>ue;)t&W&&(i=i.add(o)),o=o.double(),t>>=W;return i}isSmallOrder(){return this.multiplyUnsafe(X.h).equals(j.ZERO)}isTorsionFree(){let e=this.multiplyUnsafe(X.l/Ze).double();return X.l%Ze&&(e=e.add(this)),e.equals(j.ZERO)}toAffine(e){const{x:t,y:r,z:s}=this,i=this.equals(j.ZERO);e==null&&(e=i?Io:mr(s));const o=A(t*e),a=A(r*e),c=A(s*e);if(i)return te.ZERO;if(c!==W)throw new Error("invZ was invalid");return new te(o,a)}fromRistrettoBytes(){Pr()}toRistrettoBytes(){Pr()}fromRistrettoHash(){Pr()}}j.BASE=new j(X.Gx,X.Gy,W,A(X.Gx*X.Gy));j.ZERO=new j(ue,W,W,ue);function Ln(n,e){const t=e.negate();return n?t:e}function On(n){if(!(n instanceof j))throw new TypeError("ExtendedPoint expected")}function Tr(n){if(!(n instanceof Ee))throw new TypeError("RistrettoPoint expected")}function Pr(){throw new Error("Legacy method: switch to RistrettoPoint")}class Ee{constructor(e){this.ep=e}static calcElligatorRistrettoMap(e){const{d:t}=X,r=A(Lt*e*e),s=A((r+W)*Co);let i=BigInt(-1);const o=A((i-t*r)*A(r+t));let{isValid:a,value:c}=cn(s,o),u=A(c*e);Je(u)||(u=A(-u)),a||(c=u),a||(i=r);const l=A(i*(r-W)*To-o),f=c*c,p=A((c+c)*o),h=A(l*Bo),d=A(W-f),y=A(W+f);return new j(A(p*y),A(d*h),A(h*y),A(p*d))}static hashToCurve(e){e=tt(e,64);const t=Lr(e.slice(0,32)),r=this.calcElligatorRistrettoMap(t),s=Lr(e.slice(32,64)),i=this.calcElligatorRistrettoMap(s);return new Ee(r.add(i))}static fromHex(e){e=tt(e,32);const{a:t,d:r}=X,s="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",i=Lr(e);if(!No($t(i),e)||Je(i))throw new Error(s);const o=A(i*i),a=A(W+t*o),c=A(W-t*o),u=A(a*a),l=A(c*c),f=A(t*r*u-l),{isValid:p,value:h}=Nn(A(f*l)),d=A(h*c),y=A(h*d*f);let g=A((i+i)*d);Je(g)&&(g=A(-g));const k=A(a*y),v=A(g*k);if(!p||Je(v)||k===ue)throw new Error(s);return new Ee(new j(g,k,W,v))}toRawBytes(){let{x:e,y:t,z:r,t:s}=this.ep;const i=A(A(r+t)*A(r-t)),o=A(e*t),a=A(o*o),{value:c}=Nn(A(i*a)),u=A(c*i),l=A(c*o),f=A(u*l*s);let p;if(Je(s*f)){let d=A(t*Lt),y=A(e*Lt);e=d,t=y,p=A(u*Ro)}else p=l;Je(e*f)&&(t=A(-t));let h=A((r-t)*p);return Je(h)&&(h=A(-h)),$t(h)}toHex(){return Ht(this.toRawBytes())}toString(){return this.toHex()}equals(e){Tr(e);const t=this.ep,r=e.ep,s=A(t.x*r.y)===A(t.y*r.x),i=A(t.y*r.y)===A(t.x*r.x);return s||i}add(e){return Tr(e),new Ee(this.ep.add(e.ep))}subtract(e){return Tr(e),new Ee(this.ep.subtract(e.ep))}multiply(e){return new Ee(this.ep.multiply(e))}multiplyUnsafe(e){return new Ee(this.ep.multiplyUnsafe(e))}}Ee.BASE=new Ee(j.BASE);Ee.ZERO=new Ee(j.ZERO);const Wr=new WeakMap;class te{constructor(e,t){this.x=e,this.y=t}_setWindowSize(e){this._WINDOW_SIZE=e,Wr.delete(this)}static fromHex(e,t=!0){const{d:r,P:s}=X;e=tt(e,32);const i=e.slice();i[31]=e[31]&-129;const o=Dt(i);if(t&&o>=s)throw new Error("Expected 0 < hex < P");if(!t&&o>=ds)throw new Error("Expected 0 < hex < 2**256");const a=A(o*o),c=A(a-W),u=A(r*a+W);let{isValid:l,value:f}=cn(c,u);if(!l)throw new Error("Point.fromHex: invalid y coordinate");const p=(f&W)===W;return(e[31]&128)!==0!==p&&(f=A(-f)),new te(f,o)}static async fromPrivateKey(e){return(await ms(e)).point}toRawBytes(){const e=$t(this.y);return e[31]|=this.x&W?128:0,e}toHex(){return Ht(this.toRawBytes())}toX25519(){const{y:e}=this,t=A((W+e)*mr(W-e));return $t(t)}isTorsionFree(){return j.fromAffine(this).isTorsionFree()}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new te(A(-this.x),this.y)}add(e){return j.fromAffine(this).add(j.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return j.fromAffine(this).multiply(e,this).toAffine()}}te.BASE=new te(X.Gx,X.Gy);te.ZERO=new te(ue,W);class Nt{constructor(e,t){this.r=e,this.s=t,this.assertValidity()}static fromHex(e){const t=tt(e,64),r=te.fromHex(t.slice(0,32),!1),s=Dt(t.slice(32,64));return new Nt(r,s)}assertValidity(){const{r:e,s:t}=this;if(!(e instanceof te))throw new Error("Expected Point instance");return nr(t,X.l,!1),this}toRawBytes(){const e=new Uint8Array(64);return e.set(this.r.toRawBytes()),e.set($t(this.s),32),e}toHex(){return Ht(this.toRawBytes())}}function Un(...n){if(!n.every(r=>r instanceof Uint8Array))throw new Error("Expected Uint8Array list");if(n.length===1)return n[0];const e=n.reduce((r,s)=>r+s.length,0),t=new Uint8Array(e);for(let r=0,s=0;r<n.length;r++){const i=n[r];t.set(i,s),s+=i.length}return t}const Po=Array.from({length:256},(n,e)=>e.toString(16).padStart(2,"0"));function Ht(n){if(!(n instanceof Uint8Array))throw new Error("Uint8Array expected");let e="";for(let t=0;t<n.length;t++)e+=Po[n[t]];return e}function an(n){if(typeof n!="string")throw new TypeError("hexToBytes: expected string, got "+typeof n);if(n.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const e=new Uint8Array(n.length/2);for(let t=0;t<e.length;t++){const r=t*2,s=n.slice(r,r+2),i=Number.parseInt(s,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");e[t]=i}return e}function ps(n){const t=n.toString(16).padStart(64,"0");return an(t)}function $t(n){return ps(n).reverse()}function Je(n){return(A(n)&W)===W}function Dt(n){if(!(n instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+Ht(Uint8Array.from(n).reverse()))}const Lo=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function Lr(n){return A(Dt(n)&Lo)}function A(n,e=X.P){const t=n%e;return t>=ue?t:e+t}function mr(n,e=X.P){if(n===ue||e<=ue)throw new Error(`invert: expected positive integers, got n=${n} mod=${e}`);let t=A(n,e),r=e,s=ue,i=W;for(;t!==ue;){const a=r/t,c=r%t,u=s-i*a;r=t,t=c,s=i,i=u}if(r!==W)throw new Error("invert: does not exist");return A(s,e)}function Oo(n,e=X.P){const t=new Array(n.length),r=n.reduce((i,o,a)=>o===ue?i:(t[a]=i,A(i*o,e)),W),s=mr(r,e);return n.reduceRight((i,o,a)=>o===ue?i:(t[a]=A(i*t[a],e),A(i*o,e)),s),t}function Te(n,e){const{P:t}=X;let r=n;for(;e-- >ue;)r*=r,r%=t;return r}function Uo(n){const{P:e}=X,t=BigInt(5),r=BigInt(10),s=BigInt(20),i=BigInt(40),o=BigInt(80),c=n*n%e*n%e,u=Te(c,Ze)*c%e,l=Te(u,W)*n%e,f=Te(l,t)*l%e,p=Te(f,r)*f%e,h=Te(p,s)*p%e,d=Te(h,i)*h%e,y=Te(d,o)*d%e,g=Te(y,o)*d%e,k=Te(g,r)*f%e;return{pow_p_5_8:Te(k,Ze)*n%e,b2:c}}function cn(n,e){const t=A(e*e*e),r=A(t*t*e),s=Uo(n*r).pow_p_5_8;let i=A(n*t*s);const o=A(e*i*i),a=i,c=A(i*Lt),u=o===n,l=o===A(-n),f=o===A(-n*Lt);return u&&(i=a),(l||f)&&(i=c),Je(i)&&(i=A(-i)),{isValid:u||l,value:i}}function Nn(n){return cn(W,n)}function rr(n){return A(Dt(n),X.l)}function No(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function tt(n,e){const t=n instanceof Uint8Array?Uint8Array.from(n):an(n);if(typeof e=="number"&&t.length!==e)throw new Error(`Expected ${e} bytes`);return t}function nr(n,e,t=!0){if(!e)throw new TypeError("Specify max value");if(typeof n=="number"&&Number.isSafeInteger(n)&&(n=BigInt(n)),typeof n=="bigint"&&n<e){if(t){if(ue<n)return n}else if(ue<=n)return n}throw new TypeError("Expected valid scalar: 0 < scalar < max")}function $o(n){return n[0]&=248,n[31]&=127,n[31]|=64,n}function gs(n){if(n=typeof n=="bigint"||typeof n=="number"?ps(nr(n,ds)):tt(n),n.length!==32)throw new Error("Expected 32 bytes");return n}function ys(n){const e=$o(n.slice(0,32)),t=n.slice(32,64),r=rr(e),s=te.BASE.multiply(r),i=s.toRawBytes();return{head:e,prefix:t,scalar:r,point:s,pointBytes:i}}let Ot;function sr(...n){if(typeof Ot!="function")throw new Error("utils.sha512Sync must be set to use sync methods");return Ot(...n)}async function ms(n){return ys(await ut.sha512(gs(n)))}function un(n){return ys(sr(gs(n)))}function Fo(n){return un(n).pointBytes}function Mo(n,e){n=tt(n);const{prefix:t,scalar:r,pointBytes:s}=un(e),i=rr(sr(t,n)),o=te.BASE.multiply(i),a=rr(sr(o.toRawBytes(),s,n)),c=A(i+a*r,X.l);return new Nt(o,c).toRawBytes()}function Ko(n,e,t){e=tt(e),t instanceof te||(t=te.fromHex(t,!1));const{r,s}=n instanceof Nt?n.assertValidity():Nt.fromHex(n),i=j.BASE.multiplyUnsafe(s);return{r,s,SB:i,pub:t,msg:e}}function qo(n,e,t,r){const s=rr(r),i=j.fromAffine(n).multiplyUnsafe(s);return j.fromAffine(e).add(i).subtract(t).multiplyUnsafe(X.h).equals(j.ZERO)}function Ho(n,e,t){const{r,SB:s,msg:i,pub:o}=Ko(n,e,t),a=sr(r.toRawBytes(),o.toRawBytes(),i);return qo(o,r,s,a)}const ln={getExtendedPublicKey:un,getPublicKey:Fo,sign:Mo,verify:Ho};te.BASE._setWindowSize(8);const We={node:Ri,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0},ut={bytesToHex:Ht,hexToBytes:an,concatBytes:Un,getExtendedPublicKey:ms,mod:A,invert:mr,TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],hashToPrivateScalar:n=>{if(n=tt(n),n.length<40||n.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");return A(Dt(n),X.l-W)+W},randomBytes:(n=32)=>{if(We.web)return We.web.getRandomValues(new Uint8Array(n));if(We.node){const{randomBytes:e}=We.node;return new Uint8Array(e(n).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>ut.randomBytes(32),sha512:async(...n)=>{const e=Un(...n);if(We.web){const t=await We.web.subtle.digest("SHA-512",e.buffer);return new Uint8Array(t)}else{if(We.node)return Uint8Array.from(We.node.createHash("sha512").update(e).digest());throw new Error("The environment doesn't have sha512 function")}},precompute(n=8,e=te.BASE){const t=e.equals(te.BASE)?e:new te(e.x,e.y);return t._setWindowSize(n),t.multiply(Ze),t},sha512Sync:void 0};Object.defineProperties(ut,{sha512Sync:{configurable:!1,get(){return Ot},set(n){Ot||(Ot=n)}}});const Do=(n,e,t)=>n&e^~n&t,zo=(n,e,t)=>n&e^n&t^e&t,jo=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ge=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Ve=new Uint32Array(64);class ws extends fs{constructor(){super(64,32,8,!1),this.A=Ge[0]|0,this.B=Ge[1]|0,this.C=Ge[2]|0,this.D=Ge[3]|0,this.E=Ge[4]|0,this.F=Ge[5]|0,this.G=Ge[6]|0,this.H=Ge[7]|0}get(){const{A:e,B:t,C:r,D:s,E:i,F:o,G:a,H:c}=this;return[e,t,r,s,i,o,a,c]}set(e,t,r,s,i,o,a,c){this.A=e|0,this.B=t|0,this.C=r|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,t){for(let f=0;f<16;f++,t+=4)Ve[f]=e.getUint32(t,!1);for(let f=16;f<64;f++){const p=Ve[f-15],h=Ve[f-2],d=Ce(p,7)^Ce(p,18)^p>>>3,y=Ce(h,17)^Ce(h,19)^h>>>10;Ve[f]=y+Ve[f-7]+d+Ve[f-16]|0}let{A:r,B:s,C:i,D:o,E:a,F:c,G:u,H:l}=this;for(let f=0;f<64;f++){const p=Ce(a,6)^Ce(a,11)^Ce(a,25),h=l+p+Do(a,c,u)+jo[f]+Ve[f]|0,y=(Ce(r,2)^Ce(r,13)^Ce(r,22))+zo(r,s,i)|0;l=u,u=c,c=a,a=o+h|0,o=i,i=s,s=r,r=h+y|0}r=r+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,u=u+this.G|0,l=l+this.H|0,this.set(r,s,i,o,a,c,u,l)}roundClean(){Ve.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class Wo extends ws{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const Gr=ht(()=>new ws);ht(()=>new Wo);var ce={};function Ke(n,e,t){return e<=n&&n<=t}function wr(n){if(n===void 0)return{};if(n===Object(n))return n;throw TypeError("Could not convert argument to dictionary")}function Go(n){for(var e=String(n),t=e.length,r=0,s=[];r<t;){var i=e.charCodeAt(r);if(i<55296||i>57343)s.push(i);else if(56320<=i&&i<=57343)s.push(65533);else if(55296<=i&&i<=56319)if(r===t-1)s.push(65533);else{var o=n.charCodeAt(r+1);if(56320<=o&&o<=57343){var a=i&1023,c=o&1023;s.push(65536+(a<<10)+c),r+=1}else s.push(65533)}r+=1}return s}function Vo(n){for(var e="",t=0;t<n.length;++t){var r=n[t];r<=65535?e+=String.fromCharCode(r):(r-=65536,e+=String.fromCharCode((r>>10)+55296,(r&1023)+56320))}return e}var ir=-1;function fn(n){this.tokens=[].slice.call(n)}fn.prototype={endOfStream:function(){return!this.tokens.length},read:function(){return this.tokens.length?this.tokens.shift():ir},prepend:function(n){if(Array.isArray(n))for(var e=n;e.length;)this.tokens.unshift(e.pop());else this.tokens.unshift(n)},push:function(n){if(Array.isArray(n))for(var e=n;e.length;)this.tokens.push(e.shift());else this.tokens.push(n)}};var kt=-1;function Or(n,e){if(n)throw TypeError("Decoder error");return e||65533}var or="utf-8";function ar(n,e){if(!(this instanceof ar))return new ar(n,e);if(n=n!==void 0?String(n).toLowerCase():or,n!==or)throw new Error("Encoding not supported. Only utf-8 is supported");e=wr(e),this._streaming=!1,this._BOMseen=!1,this._decoder=null,this._fatal=!!e.fatal,this._ignoreBOM=!!e.ignoreBOM,Object.defineProperty(this,"encoding",{value:"utf-8"}),Object.defineProperty(this,"fatal",{value:this._fatal}),Object.defineProperty(this,"ignoreBOM",{value:this._ignoreBOM})}ar.prototype={decode:function(e,t){var r;typeof e=="object"&&e instanceof ArrayBuffer?r=new Uint8Array(e):typeof e=="object"&&"buffer"in e&&e.buffer instanceof ArrayBuffer?r=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):r=new Uint8Array(0),t=wr(t),this._streaming||(this._decoder=new Jo({fatal:this._fatal}),this._BOMseen=!1),this._streaming=!!t.stream;for(var s=new fn(r),i=[],o;!s.endOfStream()&&(o=this._decoder.handler(s,s.read()),o!==kt);)o!==null&&(Array.isArray(o)?i.push.apply(i,o):i.push(o));if(!this._streaming){do{if(o=this._decoder.handler(s,s.read()),o===kt)break;o!==null&&(Array.isArray(o)?i.push.apply(i,o):i.push(o))}while(!s.endOfStream());this._decoder=null}return i.length&&["utf-8"].indexOf(this.encoding)!==-1&&!this._ignoreBOM&&!this._BOMseen&&(i[0]===65279?(this._BOMseen=!0,i.shift()):this._BOMseen=!0),Vo(i)}};function cr(n,e){if(!(this instanceof cr))return new cr(n,e);if(n=n!==void 0?String(n).toLowerCase():or,n!==or)throw new Error("Encoding not supported. Only utf-8 is supported");e=wr(e),this._streaming=!1,this._encoder=null,this._options={fatal:!!e.fatal},Object.defineProperty(this,"encoding",{value:"utf-8"})}cr.prototype={encode:function(e,t){e=e?String(e):"",t=wr(t),this._streaming||(this._encoder=new Zo(this._options)),this._streaming=!!t.stream;for(var r=[],s=new fn(Go(e)),i;!s.endOfStream()&&(i=this._encoder.handler(s,s.read()),i!==kt);)Array.isArray(i)?r.push.apply(r,i):r.push(i);if(!this._streaming){for(;i=this._encoder.handler(s,s.read()),i!==kt;)Array.isArray(i)?r.push.apply(r,i):r.push(i);this._encoder=null}return new Uint8Array(r)}};function Jo(n){var e=n.fatal,t=0,r=0,s=0,i=128,o=191;this.handler=function(a,c){if(c===ir&&s!==0)return s=0,Or(e);if(c===ir)return kt;if(s===0){if(Ke(c,0,127))return c;if(Ke(c,194,223))s=1,t=c-192;else if(Ke(c,224,239))c===224&&(i=160),c===237&&(o=159),s=2,t=c-224;else if(Ke(c,240,244))c===240&&(i=144),c===244&&(o=143),s=3,t=c-240;else return Or(e);return t=t<<6*s,null}if(!Ke(c,i,o))return t=s=r=0,i=128,o=191,a.prepend(c),Or(e);if(i=128,o=191,r+=1,t+=c-128<<6*(s-r),r!==s)return null;var u=t;return t=s=r=0,u}}function Zo(n){n.fatal,this.handler=function(e,t){if(t===ir)return kt;if(Ke(t,0,127))return t;var r,s;Ke(t,128,2047)?(r=1,s=192):Ke(t,2048,65535)?(r=2,s=224):Ke(t,65536,1114111)&&(r=3,s=240);for(var i=[(t>>6*r)+s];r>0;){var o=t>>6*(r-1);i.push(128|o&63),r-=1}return i}}const Xo=Object.freeze(Object.defineProperty({__proto__:null,TextDecoder:ar,TextEncoder:cr},Symbol.toStringTag,{value:"Module"})),Yo=He(Xo);var Qo=Oe&&Oe.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),ea=Oe&&Oe.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),Ue=Oe&&Oe.__decorate||function(n,e,t,r){var s=arguments.length,i=s<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(n,e,t,r);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i},ta=Oe&&Oe.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)t!=="default"&&Object.hasOwnProperty.call(n,t)&&Qo(e,n,t);return ea(e,n),e},bs=Oe&&Oe.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(ce,"__esModule",{value:!0});var vs=ce.deserializeUnchecked=Es=ce.deserialize=_s=ce.serialize=ce.BinaryReader=ce.BinaryWriter=ce.BorshError=ce.baseDecode=ce.baseEncode=void 0;const Ye=bs(Ci),Ss=bs(J),ra=ta(Yo),na=typeof TextDecoder!="function"?ra.TextDecoder:TextDecoder,sa=new na("utf-8",{fatal:!0});function ia(n){return typeof n=="string"&&(n=Buffer.from(n,"utf8")),Ss.default.encode(Buffer.from(n))}ce.baseEncode=ia;function oa(n){return Buffer.from(Ss.default.decode(n))}ce.baseDecode=oa;const Ur=1024;class pe extends Error{constructor(e){super(e),this.fieldPath=[],this.originalMessage=e}addToFieldPath(e){this.fieldPath.splice(0,0,e),this.message=this.originalMessage+": "+this.fieldPath.join(".")}}ce.BorshError=pe;class ks{constructor(){this.buf=Buffer.alloc(Ur),this.length=0}maybeResize(){this.buf.length<16+this.length&&(this.buf=Buffer.concat([this.buf,Buffer.alloc(Ur)]))}writeU8(e){this.maybeResize(),this.buf.writeUInt8(e,this.length),this.length+=1}writeU16(e){this.maybeResize(),this.buf.writeUInt16LE(e,this.length),this.length+=2}writeU32(e){this.maybeResize(),this.buf.writeUInt32LE(e,this.length),this.length+=4}writeU64(e){this.maybeResize(),this.writeBuffer(Buffer.from(new Ye.default(e).toArray("le",8)))}writeU128(e){this.maybeResize(),this.writeBuffer(Buffer.from(new Ye.default(e).toArray("le",16)))}writeU256(e){this.maybeResize(),this.writeBuffer(Buffer.from(new Ye.default(e).toArray("le",32)))}writeU512(e){this.maybeResize(),this.writeBuffer(Buffer.from(new Ye.default(e).toArray("le",64)))}writeBuffer(e){this.buf=Buffer.concat([Buffer.from(this.buf.subarray(0,this.length)),e,Buffer.alloc(Ur)]),this.length+=e.length}writeString(e){this.maybeResize();const t=Buffer.from(e,"utf8");this.writeU32(t.length),this.writeBuffer(t)}writeFixedArray(e){this.writeBuffer(Buffer.from(e))}writeArray(e,t){this.maybeResize(),this.writeU32(e.length);for(const r of e)this.maybeResize(),t(r)}toArray(){return this.buf.subarray(0,this.length)}}ce.BinaryWriter=ks;function Ne(n,e,t){const r=t.value;t.value=function(...s){try{return r.apply(this,s)}catch(i){if(i instanceof RangeError){const o=i.code;if(["ERR_BUFFER_OUT_OF_BOUNDS","ERR_OUT_OF_RANGE"].indexOf(o)>=0)throw new pe("Reached the end of buffer when deserializing")}throw i}}}class Se{constructor(e){this.buf=e,this.offset=0}readU8(){const e=this.buf.readUInt8(this.offset);return this.offset+=1,e}readU16(){const e=this.buf.readUInt16LE(this.offset);return this.offset+=2,e}readU32(){const e=this.buf.readUInt32LE(this.offset);return this.offset+=4,e}readU64(){const e=this.readBuffer(8);return new Ye.default(e,"le")}readU128(){const e=this.readBuffer(16);return new Ye.default(e,"le")}readU256(){const e=this.readBuffer(32);return new Ye.default(e,"le")}readU512(){const e=this.readBuffer(64);return new Ye.default(e,"le")}readBuffer(e){if(this.offset+e>this.buf.length)throw new pe(`Expected buffer length ${e} isn't within bounds`);const t=this.buf.slice(this.offset,this.offset+e);return this.offset+=e,t}readString(){const e=this.readU32(),t=this.readBuffer(e);try{return sa.decode(t)}catch(r){throw new pe(`Error decoding UTF-8 string: ${r}`)}}readFixedArray(e){return new Uint8Array(this.readBuffer(e))}readArray(e){const t=this.readU32(),r=Array();for(let s=0;s<t;++s)r.push(e());return r}}Ue([Ne],Se.prototype,"readU8",null);Ue([Ne],Se.prototype,"readU16",null);Ue([Ne],Se.prototype,"readU32",null);Ue([Ne],Se.prototype,"readU64",null);Ue([Ne],Se.prototype,"readU128",null);Ue([Ne],Se.prototype,"readU256",null);Ue([Ne],Se.prototype,"readU512",null);Ue([Ne],Se.prototype,"readString",null);Ue([Ne],Se.prototype,"readFixedArray",null);Ue([Ne],Se.prototype,"readArray",null);ce.BinaryReader=Se;function As(n){return n.charAt(0).toUpperCase()+n.slice(1)}function ot(n,e,t,r,s){try{if(typeof r=="string")s[`write${As(r)}`](t);else if(r instanceof Array)if(typeof r[0]=="number"){if(t.length!==r[0])throw new pe(`Expecting byte array of length ${r[0]}, but got ${t.length} bytes`);s.writeFixedArray(t)}else if(r.length===2&&typeof r[1]=="number"){if(t.length!==r[1])throw new pe(`Expecting byte array of length ${r[1]}, but got ${t.length} bytes`);for(let i=0;i<r[1];i++)ot(n,null,t[i],r[0],s)}else s.writeArray(t,i=>{ot(n,e,i,r[0],s)});else if(r.kind!==void 0)switch(r.kind){case"option":{t==null?s.writeU8(0):(s.writeU8(1),ot(n,e,t,r.type,s));break}case"map":{s.writeU32(t.size),t.forEach((i,o)=>{ot(n,e,o,r.key,s),ot(n,e,i,r.value,s)});break}default:throw new pe(`FieldType ${r} unrecognized`)}else xs(n,t,s)}catch(i){throw i instanceof pe&&i.addToFieldPath(e),i}}function xs(n,e,t){if(typeof e.borshSerialize=="function"){e.borshSerialize(t);return}const r=n.get(e.constructor);if(!r)throw new pe(`Class ${e.constructor.name} is missing in schema`);if(r.kind==="struct")r.fields.map(([s,i])=>{ot(n,s,e[s],i,t)});else if(r.kind==="enum"){const s=e[r.field];for(let i=0;i<r.values.length;++i){const[o,a]=r.values[i];if(o===s){t.writeU8(i),ot(n,o,e[o],a,t);break}}}else throw new pe(`Unexpected schema kind: ${r.kind} for ${e.constructor.name}`)}function aa(n,e,t=ks){const r=new t;return xs(n,e,r),r.toArray()}var _s=ce.serialize=aa;function at(n,e,t,r){try{if(typeof t=="string")return r[`read${As(t)}`]();if(t instanceof Array){if(typeof t[0]=="number")return r.readFixedArray(t[0]);if(typeof t[1]=="number"){const s=[];for(let i=0;i<t[1];i++)s.push(at(n,null,t[0],r));return s}else return r.readArray(()=>at(n,e,t[0],r))}if(t.kind==="option")return r.readU8()?at(n,e,t.type,r):void 0;if(t.kind==="map"){let s=new Map;const i=r.readU32();for(let o=0;o<i;o++){const a=at(n,e,t.key,r),c=at(n,e,t.value,r);s.set(a,c)}return s}return hn(n,t,r)}catch(s){throw s instanceof pe&&s.addToFieldPath(e),s}}function hn(n,e,t){if(typeof e.borshDeserialize=="function")return e.borshDeserialize(t);const r=n.get(e);if(!r)throw new pe(`Class ${e.name} is missing in schema`);if(r.kind==="struct"){const s={};for(const[i,o]of n.get(e).fields)s[i]=at(n,i,o,t);return new e(s)}if(r.kind==="enum"){const s=t.readU8();if(s>=r.values.length)throw new pe(`Enum index: ${s} is out of range`);const[i,o]=r.values[s],a=at(n,i,o,t);return new e({[i]:a})}throw new pe(`Unexpected schema kind: ${r.kind} for ${e.constructor.name}`)}function ca(n,e,t,r=Se){const s=new r(t),i=hn(n,e,s);if(s.offset<t.length)throw new pe(`Unexpected ${t.length-s.offset} bytes after deserialized data`);return i}var Es=ce.deserialize=ca;function ua(n,e,t,r=Se){const s=new r(t);return hn(n,e,s)}vs=ce.deserializeUnchecked=ua;var w={};Object.defineProperty(w,"__esModule",{value:!0});w.s16=w.s8=w.nu64be=w.u48be=w.u40be=w.u32be=w.u24be=w.u16be=ae=w.nu64=w.u48=w.u40=N=w.u32=w.u24=Ae=w.u16=V=w.u8=ct=w.offset=w.greedy=w.Constant=w.UTF8=w.CString=w.Blob=w.Boolean=w.BitField=w.BitStructure=w.VariantLayout=w.Union=w.UnionLayoutDiscriminator=w.UnionDiscriminator=w.Structure=w.Sequence=w.DoubleBE=w.Double=w.FloatBE=w.Float=w.NearInt64BE=w.NearInt64=w.NearUInt64BE=w.NearUInt64=w.IntBE=w.Int=w.UIntBE=w.UInt=w.OffsetLayout=w.GreedyCount=w.ExternalLayout=w.bindConstructorLayout=w.nameWithProperty=w.Layout=w.uint8ArrayToBuffer=w.checkUint8Array=void 0;w.constant=w.utf8=w.cstr=re=w.blob=w.unionLayoutDiscriminator=w.union=ge=w.seq=w.bits=O=w.struct=w.f64be=w.f64=w.f32be=w.f32=w.ns64be=w.s48be=w.s40be=w.s32be=w.s24be=w.s16be=be=w.ns64=w.s48=w.s40=w.s32=w.s24=void 0;const dn=H;function Et(n){if(!(n instanceof Uint8Array))throw new TypeError("b must be a Uint8Array")}w.checkUint8Array=Et;function G(n){return Et(n),dn.Buffer.from(n.buffer,n.byteOffset,n.length)}w.uint8ArrayToBuffer=G;class Z{constructor(e,t){if(!Number.isInteger(e))throw new TypeError("span must be an integer");this.span=e,this.property=t}makeDestinationObject(){return{}}getSpan(e,t){if(0>this.span)throw new RangeError("indeterminate span");return this.span}replicate(e){const t=Object.create(this.constructor.prototype);return Object.assign(t,this),t.property=e,t}fromArray(e){}}w.Layout=Z;function pn(n,e){return e.property?n+"["+e.property+"]":n}w.nameWithProperty=pn;function la(n,e){if(typeof n!="function")throw new TypeError("Class must be constructor");if(Object.prototype.hasOwnProperty.call(n,"layout_"))throw new Error("Class is already bound to a layout");if(!(e&&e instanceof Z))throw new TypeError("layout must be a Layout");if(Object.prototype.hasOwnProperty.call(e,"boundConstructor_"))throw new Error("layout is already bound to a constructor");n.layout_=e,e.boundConstructor_=n,e.makeDestinationObject=()=>new n,Object.defineProperty(n.prototype,"encode",{value(t,r){return e.encode(this,t,r)},writable:!0}),Object.defineProperty(n,"decode",{value(t,r){return e.decode(t,r)},writable:!0})}w.bindConstructorLayout=la;class ye extends Z{isCount(){throw new Error("ExternalLayout is abstract")}}w.ExternalLayout=ye;class Is extends ye{constructor(e=1,t){if(!Number.isInteger(e)||0>=e)throw new TypeError("elementSpan must be a (positive) integer");super(-1,t),this.elementSpan=e}isCount(){return!0}decode(e,t=0){Et(e);const r=e.length-t;return Math.floor(r/this.elementSpan)}encode(e,t,r){return 0}}w.GreedyCount=Is;class gn extends ye{constructor(e,t=0,r){if(!(e instanceof Z))throw new TypeError("layout must be a Layout");if(!Number.isInteger(t))throw new TypeError("offset must be integer or undefined");super(e.span,r||e.property),this.layout=e,this.offset=t}isCount(){return this.layout instanceof Ie||this.layout instanceof Be}decode(e,t=0){return this.layout.decode(e,t+this.offset)}encode(e,t,r=0){return this.layout.encode(e,t,r+this.offset)}}w.OffsetLayout=gn;class Ie extends Z{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t=0){return G(e).readUIntLE(t,this.span)}encode(e,t,r=0){return G(t).writeUIntLE(e,r,this.span),this.span}}w.UInt=Ie;class Be extends Z{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t=0){return G(e).readUIntBE(t,this.span)}encode(e,t,r=0){return G(t).writeUIntBE(e,r,this.span),this.span}}w.UIntBE=Be;class dt extends Z{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t=0){return G(e).readIntLE(t,this.span)}encode(e,t,r=0){return G(t).writeIntLE(e,r,this.span),this.span}}w.Int=dt;class It extends Z{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t=0){return G(e).readIntBE(t,this.span)}encode(e,t,r=0){return G(t).writeIntBE(e,r,this.span),this.span}}w.IntBE=It;const Vr=Math.pow(2,32);function br(n){const e=Math.floor(n/Vr),t=n-e*Vr;return{hi32:e,lo32:t}}function vr(n,e){return n*Vr+e}class Bs extends Z{constructor(e){super(8,e)}decode(e,t=0){const r=G(e),s=r.readUInt32LE(t),i=r.readUInt32LE(t+4);return vr(i,s)}encode(e,t,r=0){const s=br(e),i=G(t);return i.writeUInt32LE(s.lo32,r),i.writeUInt32LE(s.hi32,r+4),8}}w.NearUInt64=Bs;class Rs extends Z{constructor(e){super(8,e)}decode(e,t=0){const r=G(e),s=r.readUInt32BE(t),i=r.readUInt32BE(t+4);return vr(s,i)}encode(e,t,r=0){const s=br(e),i=G(t);return i.writeUInt32BE(s.hi32,r),i.writeUInt32BE(s.lo32,r+4),8}}w.NearUInt64BE=Rs;class Cs extends Z{constructor(e){super(8,e)}decode(e,t=0){const r=G(e),s=r.readUInt32LE(t),i=r.readInt32LE(t+4);return vr(i,s)}encode(e,t,r=0){const s=br(e),i=G(t);return i.writeUInt32LE(s.lo32,r),i.writeInt32LE(s.hi32,r+4),8}}w.NearInt64=Cs;class Ts extends Z{constructor(e){super(8,e)}decode(e,t=0){const r=G(e),s=r.readInt32BE(t),i=r.readUInt32BE(t+4);return vr(s,i)}encode(e,t,r=0){const s=br(e),i=G(t);return i.writeInt32BE(s.hi32,r),i.writeUInt32BE(s.lo32,r+4),8}}w.NearInt64BE=Ts;class Ps extends Z{constructor(e){super(4,e)}decode(e,t=0){return G(e).readFloatLE(t)}encode(e,t,r=0){return G(t).writeFloatLE(e,r),4}}w.Float=Ps;class Ls extends Z{constructor(e){super(4,e)}decode(e,t=0){return G(e).readFloatBE(t)}encode(e,t,r=0){return G(t).writeFloatBE(e,r),4}}w.FloatBE=Ls;class Os extends Z{constructor(e){super(8,e)}decode(e,t=0){return G(e).readDoubleLE(t)}encode(e,t,r=0){return G(t).writeDoubleLE(e,r),8}}w.Double=Os;class Us extends Z{constructor(e){super(8,e)}decode(e,t=0){return G(e).readDoubleBE(t)}encode(e,t,r=0){return G(t).writeDoubleBE(e,r),8}}w.DoubleBE=Us;class Ns extends Z{constructor(e,t,r){if(!(e instanceof Z))throw new TypeError("elementLayout must be a Layout");if(!(t instanceof ye&&t.isCount()||Number.isInteger(t)&&0<=t))throw new TypeError("count must be non-negative integer or an unsigned integer ExternalLayout");let s=-1;!(t instanceof ye)&&0<e.span&&(s=t*e.span),super(s,r),this.elementLayout=e,this.count=t}getSpan(e,t=0){if(0<=this.span)return this.span;let r=0,s=this.count;if(s instanceof ye&&(s=s.decode(e,t)),0<this.elementLayout.span)r=s*this.elementLayout.span;else{let i=0;for(;i<s;)r+=this.elementLayout.getSpan(e,t+r),++i}return r}decode(e,t=0){const r=[];let s=0,i=this.count;for(i instanceof ye&&(i=i.decode(e,t));s<i;)r.push(this.elementLayout.decode(e,t)),t+=this.elementLayout.getSpan(e,t),s+=1;return r}encode(e,t,r=0){const s=this.elementLayout,i=e.reduce((o,a)=>o+s.encode(a,t,r+o),0);return this.count instanceof ye&&this.count.encode(e.length,t,r),i}}w.Sequence=Ns;class $s extends Z{constructor(e,t,r){if(!(Array.isArray(e)&&e.reduce((i,o)=>i&&o instanceof Z,!0)))throw new TypeError("fields must be array of Layout instances");typeof t=="boolean"&&r===void 0&&(r=t,t=void 0);for(const i of e)if(0>i.span&&i.property===void 0)throw new Error("fields cannot contain unnamed variable-length layout");let s=-1;try{s=e.reduce((i,o)=>i+o.getSpan(),0)}catch{}super(s,t),this.fields=e,this.decodePrefixes=!!r}getSpan(e,t=0){if(0<=this.span)return this.span;let r=0;try{r=this.fields.reduce((s,i)=>{const o=i.getSpan(e,t);return t+=o,s+o},0)}catch{throw new RangeError("indeterminate span")}return r}decode(e,t=0){Et(e);const r=this.makeDestinationObject();for(const s of this.fields)if(s.property!==void 0&&(r[s.property]=s.decode(e,t)),t+=s.getSpan(e,t),this.decodePrefixes&&e.length===t)break;return r}encode(e,t,r=0){const s=r;let i=0,o=0;for(const a of this.fields){let c=a.span;if(o=0<c?c:0,a.property!==void 0){const u=e[a.property];u!==void 0&&(o=a.encode(u,t,r),0>c&&(c=a.getSpan(t,r)))}i=r,r+=c}return i+o-s}fromArray(e){const t=this.makeDestinationObject();for(const r of this.fields)r.property!==void 0&&0<e.length&&(t[r.property]=e.shift());return t}layoutFor(e){if(typeof e!="string")throw new TypeError("property must be string");for(const t of this.fields)if(t.property===e)return t}offsetOf(e){if(typeof e!="string")throw new TypeError("property must be string");let t=0;for(const r of this.fields){if(r.property===e)return t;0>r.span?t=-1:0<=t&&(t+=r.span)}}}w.Structure=$s;class yn{constructor(e){this.property=e}decode(e,t){throw new Error("UnionDiscriminator is abstract")}encode(e,t,r){throw new Error("UnionDiscriminator is abstract")}}w.UnionDiscriminator=yn;class ur extends yn{constructor(e,t){if(!(e instanceof ye&&e.isCount()))throw new TypeError("layout must be an unsigned integer ExternalLayout");super(t||e.property||"variant"),this.layout=e}decode(e,t){return this.layout.decode(e,t)}encode(e,t,r){return this.layout.encode(e,t,r)}}w.UnionLayoutDiscriminator=ur;class mn extends Z{constructor(e,t,r){let s;if(e instanceof Ie||e instanceof Be)s=new ur(new gn(e));else if(e instanceof ye&&e.isCount())s=new ur(e);else if(e instanceof yn)s=e;else throw new TypeError("discr must be a UnionDiscriminator or an unsigned integer layout");if(t===void 0&&(t=null),!(t===null||t instanceof Z))throw new TypeError("defaultLayout must be null or a Layout");if(t!==null){if(0>t.span)throw new Error("defaultLayout must have constant span");t.property===void 0&&(t=t.replicate("content"))}let i=-1;t&&(i=t.span,0<=i&&(e instanceof Ie||e instanceof Be)&&(i+=s.layout.span)),super(i,r),this.discriminator=s,this.usesPrefixDiscriminator=e instanceof Ie||e instanceof Be,this.defaultLayout=t,this.registry={};let o=this.defaultGetSourceVariant.bind(this);this.getSourceVariant=function(a){return o(a)},this.configGetSourceVariant=function(a){o=a.bind(this)}}getSpan(e,t=0){if(0<=this.span)return this.span;const r=this.getVariant(e,t);if(!r)throw new Error("unable to determine span for unrecognized variant");return r.getSpan(e,t)}defaultGetSourceVariant(e){if(Object.prototype.hasOwnProperty.call(e,this.discriminator.property)){if(this.defaultLayout&&this.defaultLayout.property&&Object.prototype.hasOwnProperty.call(e,this.defaultLayout.property))return;const t=this.registry[e[this.discriminator.property]];if(t&&(!t.layout||t.property&&Object.prototype.hasOwnProperty.call(e,t.property)))return t}else for(const t in this.registry){const r=this.registry[t];if(r.property&&Object.prototype.hasOwnProperty.call(e,r.property))return r}throw new Error("unable to infer src variant")}decode(e,t=0){let r;const s=this.discriminator,i=s.decode(e,t),o=this.registry[i];if(o===void 0){const a=this.defaultLayout;let c=0;this.usesPrefixDiscriminator&&(c=s.layout.span),r=this.makeDestinationObject(),r[s.property]=i,r[a.property]=a.decode(e,t+c)}else r=o.decode(e,t);return r}encode(e,t,r=0){const s=this.getSourceVariant(e);if(s===void 0){const i=this.discriminator,o=this.defaultLayout;let a=0;return this.usesPrefixDiscriminator&&(a=i.layout.span),i.encode(e[i.property],t,r),a+o.encode(e[o.property],t,r+a)}return s.encode(e,t,r)}addVariant(e,t,r){const s=new Fs(this,e,t,r);return this.registry[e]=s,s}getVariant(e,t=0){let r;return e instanceof Uint8Array?r=this.discriminator.decode(e,t):r=e,this.registry[r]}}w.Union=mn;class Fs extends Z{constructor(e,t,r,s){if(!(e instanceof mn))throw new TypeError("union must be a Union");if(!Number.isInteger(t)||0>t)throw new TypeError("variant must be a (non-negative) integer");if(typeof r=="string"&&s===void 0&&(s=r,r=null),r){if(!(r instanceof Z))throw new TypeError("layout must be a Layout");if(e.defaultLayout!==null&&0<=r.span&&r.span>e.defaultLayout.span)throw new Error("variant span exceeds span of containing union");if(typeof s!="string")throw new TypeError("variant must have a String property")}let i=e.span;0>e.span&&(i=r?r.span:0,0<=i&&e.usesPrefixDiscriminator&&(i+=e.discriminator.layout.span)),super(i,s),this.union=e,this.variant=t,this.layout=r||null}getSpan(e,t=0){if(0<=this.span)return this.span;let r=0;this.union.usesPrefixDiscriminator&&(r=this.union.discriminator.layout.span);let s=0;return this.layout&&(s=this.layout.getSpan(e,t+r)),r+s}decode(e,t=0){const r=this.makeDestinationObject();if(this!==this.union.getVariant(e,t))throw new Error("variant mismatch");let s=0;return this.union.usesPrefixDiscriminator&&(s=this.union.discriminator.layout.span),this.layout?r[this.property]=this.layout.decode(e,t+s):this.property?r[this.property]=!0:this.union.usesPrefixDiscriminator&&(r[this.union.discriminator.property]=this.variant),r}encode(e,t,r=0){let s=0;if(this.union.usesPrefixDiscriminator&&(s=this.union.discriminator.layout.span),this.layout&&!Object.prototype.hasOwnProperty.call(e,this.property))throw new TypeError("variant lacks property "+this.property);this.union.discriminator.encode(this.variant,t,r);let i=s;if(this.layout&&(this.layout.encode(e[this.property],t,r+s),i+=this.layout.getSpan(t,r+s),0<=this.union.span&&i>this.union.span))throw new Error("encoded variant overruns containing union");return i}fromArray(e){if(this.layout)return this.layout.fromArray(e)}}w.VariantLayout=Fs;function wt(n){return 0>n&&(n+=4294967296),n}class wn extends Z{constructor(e,t,r){if(!(e instanceof Ie||e instanceof Be))throw new TypeError("word must be a UInt or UIntBE layout");if(typeof t=="string"&&r===void 0&&(r=t,t=!1),4<e.span)throw new RangeError("word cannot exceed 32 bits");super(e.span,r),this.word=e,this.msb=!!t,this.fields=[];let s=0;this._packedSetValue=function(i){return s=wt(i),this},this._packedGetValue=function(){return s}}decode(e,t=0){const r=this.makeDestinationObject(),s=this.word.decode(e,t);this._packedSetValue(s);for(const i of this.fields)i.property!==void 0&&(r[i.property]=i.decode(e));return r}encode(e,t,r=0){const s=this.word.decode(t,r);this._packedSetValue(s);for(const i of this.fields)if(i.property!==void 0){const o=e[i.property];o!==void 0&&i.encode(o)}return this.word.encode(this._packedGetValue(),t,r)}addField(e,t){const r=new bn(this,e,t);return this.fields.push(r),r}addBoolean(e){const t=new Ms(this,e);return this.fields.push(t),t}fieldFor(e){if(typeof e!="string")throw new TypeError("property must be string");for(const t of this.fields)if(t.property===e)return t}}w.BitStructure=wn;class bn{constructor(e,t,r){if(!(e instanceof wn))throw new TypeError("container must be a BitStructure");if(!Number.isInteger(t)||0>=t)throw new TypeError("bits must be positive integer");const s=8*e.span,i=e.fields.reduce((o,a)=>o+a.bits,0);if(t+i>s)throw new Error("bits too long for span remainder ("+(s-i)+" of "+s+" remain)");this.container=e,this.bits=t,this.valueMask=(1<<t)-1,t===32&&(this.valueMask=4294967295),this.start=i,this.container.msb&&(this.start=s-i-t),this.wordMask=wt(this.valueMask<<this.start),this.property=r}decode(e,t){const r=this.container._packedGetValue();return wt(r&this.wordMask)>>>this.start}encode(e){if(typeof e!="number"||!Number.isInteger(e)||e!==wt(e&this.valueMask))throw new TypeError(pn("BitField.encode",this)+" value must be integer not exceeding "+this.valueMask);const t=this.container._packedGetValue(),r=wt(e<<this.start);this.container._packedSetValue(wt(t&~this.wordMask)|r)}}w.BitField=bn;let Ms=class extends bn{constructor(e,t){super(e,1,t)}decode(e,t){return!!super.decode(e,t)}encode(e){typeof e=="boolean"&&(e=+e),super.encode(e)}};w.Boolean=Ms;class Ks extends Z{constructor(e,t){if(!(e instanceof ye&&e.isCount()||Number.isInteger(e)&&0<=e))throw new TypeError("length must be positive integer or an unsigned integer ExternalLayout");let r=-1;e instanceof ye||(r=e),super(r,t),this.length=e}getSpan(e,t){let r=this.span;return 0>r&&(r=this.length.decode(e,t)),r}decode(e,t=0){let r=this.span;return 0>r&&(r=this.length.decode(e,t)),G(e).slice(t,t+r)}encode(e,t,r){let s=this.length;if(this.length instanceof ye&&(s=e.length),!(e instanceof Uint8Array&&s===e.length))throw new TypeError(pn("Blob.encode",this)+" requires (length "+s+") Uint8Array as src");if(r+s>t.length)throw new RangeError("encoding overruns Uint8Array");const i=G(e);return G(t).write(i.toString("hex"),r,s,"hex"),this.length instanceof ye&&this.length.encode(s,t,r),s}}w.Blob=Ks;class qs extends Z{constructor(e){super(-1,e)}getSpan(e,t=0){Et(e);let r=t;for(;r<e.length&&e[r]!==0;)r+=1;return 1+r-t}decode(e,t=0){const r=this.getSpan(e,t);return G(e).slice(t,t+r-1).toString("utf-8")}encode(e,t,r=0){typeof e!="string"&&(e=String(e));const s=dn.Buffer.from(e,"utf8"),i=s.length;if(r+i>t.length)throw new RangeError("encoding overruns Buffer");const o=G(t);return s.copy(o,r),o[r+i]=0,i+1}}w.CString=qs;class Hs extends Z{constructor(e,t){if(typeof e=="string"&&t===void 0&&(t=e,e=void 0),e===void 0)e=-1;else if(!Number.isInteger(e))throw new TypeError("maxSpan must be an integer");super(-1,t),this.maxSpan=e}getSpan(e,t=0){return Et(e),e.length-t}decode(e,t=0){const r=this.getSpan(e,t);if(0<=this.maxSpan&&this.maxSpan<r)throw new RangeError("text length exceeds maxSpan");return G(e).slice(t,t+r).toString("utf-8")}encode(e,t,r=0){typeof e!="string"&&(e=String(e));const s=dn.Buffer.from(e,"utf8"),i=s.length;if(0<=this.maxSpan&&this.maxSpan<i)throw new RangeError("text length exceeds maxSpan");if(r+i>t.length)throw new RangeError("encoding overruns Buffer");return s.copy(G(t),r),i}}w.UTF8=Hs;class Ds extends Z{constructor(e,t){super(0,t),this.value=e}decode(e,t){return this.value}encode(e,t,r){return 0}}w.Constant=Ds;w.greedy=(n,e)=>new Is(n,e);var ct=w.offset=(n,e,t)=>new gn(n,e,t),V=w.u8=n=>new Ie(1,n),Ae=w.u16=n=>new Ie(2,n);w.u24=n=>new Ie(3,n);var N=w.u32=n=>new Ie(4,n);w.u40=n=>new Ie(5,n);w.u48=n=>new Ie(6,n);var ae=w.nu64=n=>new Bs(n);w.u16be=n=>new Be(2,n);w.u24be=n=>new Be(3,n);w.u32be=n=>new Be(4,n);w.u40be=n=>new Be(5,n);w.u48be=n=>new Be(6,n);w.nu64be=n=>new Rs(n);w.s8=n=>new dt(1,n);w.s16=n=>new dt(2,n);w.s24=n=>new dt(3,n);w.s32=n=>new dt(4,n);w.s40=n=>new dt(5,n);w.s48=n=>new dt(6,n);var be=w.ns64=n=>new Cs(n);w.s16be=n=>new It(2,n);w.s24be=n=>new It(3,n);w.s32be=n=>new It(4,n);w.s40be=n=>new It(5,n);w.s48be=n=>new It(6,n);w.ns64be=n=>new Ts(n);w.f32=n=>new Ps(n);w.f32be=n=>new Ls(n);w.f64=n=>new Os(n);w.f64be=n=>new Us(n);var O=w.struct=(n,e,t)=>new $s(n,e,t);w.bits=(n,e,t)=>new wn(n,e,t);var ge=w.seq=(n,e,t)=>new Ns(n,e,t);w.union=(n,e,t)=>new mn(n,e,t);w.unionLayoutDiscriminator=(n,e)=>new ur(n,e);var re=w.blob=(n,e)=>new Ks(n,e);w.cstr=n=>new qs(n);w.utf8=(n,e)=>new Hs(n,e);w.constant=(n,e)=>new Ds(n,e);var zt={};Object.defineProperty(zt,"__esModule",{value:!0});function fa(n){{const e=Buffer.from(n);e.reverse();const t=e.toString("hex");return t.length===0?BigInt(0):BigInt(`0x${t}`)}}var ha=zt.toBigIntLE=fa;function da(n){{const e=n.toString("hex");return e.length===0?BigInt(0):BigInt(`0x${e}`)}}zt.toBigIntBE=da;function pa(n,e){{const t=n.toString(16),r=Buffer.from(t.padStart(e*2,"0").slice(0,e*2),"hex");return r.reverse(),r}}var ga=zt.toBufferLE=pa;function ya(n,e){{const t=n.toString(16);return Buffer.from(t.padStart(e*2,"0").slice(0,e*2),"hex")}}zt.toBufferBE=ya;class ma extends TypeError{constructor(e,t){let r;const{message:s,...i}=e,{path:o}=e,a=o.length===0?s:"At path: "+o.join(".")+" -- "+s;super(a),Object.assign(this,i),this.name=this.constructor.name,this.failures=()=>{var c;return(c=r)!=null?c:r=[e,...t()]}}}function wa(n){return et(n)&&typeof n[Symbol.iterator]=="function"}function et(n){return typeof n=="object"&&n!=null}function Re(n){return typeof n=="string"?JSON.stringify(n):""+n}function ba(n){const{done:e,value:t}=n.next();return e?void 0:t}function va(n,e,t,r){if(n===!0)return;n===!1?n={}:typeof n=="string"&&(n={message:n});const{path:s,branch:i}=e,{type:o}=t,{refinement:a,message:c="Expected a value of type `"+o+"`"+(a?" with refinement `"+a+"`":"")+", but received: `"+Re(r)+"`"}=n;return{value:r,type:o,refinement:a,key:s[s.length-1],path:s,branch:i,...n,message:c}}function*$n(n,e,t,r){wa(n)||(n=[n]);for(const s of n){const i=va(s,e,t,r);i&&(yield i)}}function*vn(n,e,t={}){const{path:r=[],branch:s=[n],coerce:i=!1,mask:o=!1}=t,a={path:r,branch:s};if(i&&(n=e.coercer(n,a),o&&e.type!=="type"&&et(e.schema)&&et(n)&&!Array.isArray(n)))for(const u in n)e.schema[u]===void 0&&delete n[u];let c=!0;for(const u of e.validator(n,a))c=!1,yield[u,void 0];for(let[u,l,f]of e.entries(n,a)){const p=vn(l,f,{path:u===void 0?r:[...r,u],branch:u===void 0?s:[...s,l],coerce:i,mask:o});for(const h of p)h[0]?(c=!1,yield[h[0],void 0]):i&&(l=h[1],u===void 0?n=l:n instanceof Map?n.set(u,l):n instanceof Set?n.add(l):et(n)&&(n[u]=l))}if(c)for(const u of e.refiner(n,a))c=!1,yield[u,void 0];c&&(yield[void 0,n])}let $e=class{constructor(e){const{type:t,schema:r,validator:s,refiner:i,coercer:o=c=>c,entries:a=function*(){}}=e;this.type=t,this.schema=r,this.entries=a,this.coercer=o,s?this.validator=(c,u)=>{const l=s(c,u);return $n(l,u,this,c)}:this.validator=()=>[],i?this.refiner=(c,u)=>{const l=i(c,u);return $n(l,u,this,c)}:this.refiner=()=>[]}assert(e){return Sa(e,this)}create(e){return I(e,this)}is(e){return zs(e,this)}mask(e){return ka(e,this)}validate(e,t={}){return jt(e,this,t)}};function Sa(n,e){const t=jt(n,e);if(t[0])throw t[0]}function I(n,e){const t=jt(n,e,{coerce:!0});if(t[0])throw t[0];return t[1]}function ka(n,e){const t=jt(n,e,{coerce:!0,mask:!0});if(t[0])throw t[0];return t[1]}function zs(n,e){return!jt(n,e)[0]}function jt(n,e,t={}){const r=vn(n,e,t),s=ba(r);return s[0]?[new ma(s[0],function*(){for(const o of r)o[0]&&(yield o[0])}),void 0]:[void 0,s[1]]}function pt(n,e){return new $e({type:n,schema:null,validator:e})}function Aa(){return pt("any",()=>!0)}function B(n){return new $e({type:"array",schema:n,*entries(e){if(n&&Array.isArray(e))for(const[t,r]of e.entries())yield[t,r,n]},coercer(e){return Array.isArray(e)?e.slice():e},validator(e){return Array.isArray(e)||"Expected an array value, but received: "+Re(e)}})}function qe(){return pt("boolean",n=>typeof n=="boolean")}function Sn(n){return pt("instance",e=>e instanceof n||"Expected a `"+n.name+"` instance, but received: "+Re(e))}function ee(n){const e=Re(n),t=typeof n;return new $e({type:"literal",schema:t==="string"||t==="number"||t==="boolean"?n:null,validator(r){return r===n||"Expected the literal `"+e+"`, but received: "+Re(r)}})}function xa(){return pt("never",()=>!1)}function R(n){return new $e({...n,validator:(e,t)=>e===null||n.validator(e,t),refiner:(e,t)=>e===null||n.refiner(e,t)})}function m(){return pt("number",n=>typeof n=="number"&&!isNaN(n)||"Expected a number, but received: "+Re(n))}function M(n){return new $e({...n,validator:(e,t)=>e===void 0||n.validator(e,t),refiner:(e,t)=>e===void 0||n.refiner(e,t)})}function js(n,e){return new $e({type:"record",schema:null,*entries(t){if(et(t))for(const r in t){const s=t[r];yield[r,r,n],yield[r,s,e]}},validator(t){return et(t)||"Expected an object, but received: "+Re(t)}})}function E(){return pt("string",n=>typeof n=="string"||"Expected a string, but received: "+Re(n))}function kn(n){const e=xa();return new $e({type:"tuple",schema:null,*entries(t){if(Array.isArray(t)){const r=Math.max(n.length,t.length);for(let s=0;s<r;s++)yield[s,t[s],n[s]||e]}},validator(t){return Array.isArray(t)||"Expected an array, but received: "+Re(t)}})}function _(n){const e=Object.keys(n);return new $e({type:"type",schema:n,*entries(t){if(et(t))for(const r of e)yield[r,t[r],n[r]]},validator(t){return et(t)||"Expected an object, but received: "+Re(t)}})}function we(n){const e=n.map(t=>t.type).join(" | ");return new $e({type:"union",schema:null,validator(t,r){const s=[];for(const i of n){const[...o]=vn(t,i,r),[a]=o;if(a[0])for(const[c]of o)c&&s.push(c);else return[]}return["Expected the value to satisfy a union of `"+e+"`, but received: "+Re(t),...s]}})}function Wt(){return pt("unknown",()=>!0)}function Gt(n,e,t){return new $e({...n,coercer:(r,s)=>zs(r,e)?n.coercer(t(r,s),s):n.coercer(r,s)})}var Xt,_a=new Uint8Array(16);function Ws(){if(!Xt&&(Xt=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!Xt))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Xt(_a)}const Ea=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Sr(n){return typeof n=="string"&&Ea.test(n)}var oe=[];for(var Nr=0;Nr<256;++Nr)oe.push((Nr+256).toString(16).substr(1));function kr(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=(oe[n[e+0]]+oe[n[e+1]]+oe[n[e+2]]+oe[n[e+3]]+"-"+oe[n[e+4]]+oe[n[e+5]]+"-"+oe[n[e+6]]+oe[n[e+7]]+"-"+oe[n[e+8]]+oe[n[e+9]]+"-"+oe[n[e+10]]+oe[n[e+11]]+oe[n[e+12]]+oe[n[e+13]]+oe[n[e+14]]+oe[n[e+15]]).toLowerCase();if(!Sr(t))throw TypeError("Stringified UUID is invalid");return t}var Fn,$r,Fr=0,Mr=0;function Ia(n,e,t){var r=e&&t||0,s=e||new Array(16);n=n||{};var i=n.node||Fn,o=n.clockseq!==void 0?n.clockseq:$r;if(i==null||o==null){var a=n.random||(n.rng||Ws)();i==null&&(i=Fn=[a[0]|1,a[1],a[2],a[3],a[4],a[5]]),o==null&&(o=$r=(a[6]<<8|a[7])&16383)}var c=n.msecs!==void 0?n.msecs:Date.now(),u=n.nsecs!==void 0?n.nsecs:Mr+1,l=c-Fr+(u-Mr)/1e4;if(l<0&&n.clockseq===void 0&&(o=o+1&16383),(l<0||c>Fr)&&n.nsecs===void 0&&(u=0),u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Fr=c,Mr=u,$r=o,c+=122192928e5;var f=((c&268435455)*1e4+u)%4294967296;s[r++]=f>>>24&255,s[r++]=f>>>16&255,s[r++]=f>>>8&255,s[r++]=f&255;var p=c/4294967296*1e4&268435455;s[r++]=p>>>8&255,s[r++]=p&255,s[r++]=p>>>24&15|16,s[r++]=p>>>16&255,s[r++]=o>>>8|128,s[r++]=o&255;for(var h=0;h<6;++h)s[r+h]=i[h];return e||kr(s)}function Gs(n){if(!Sr(n))throw TypeError("Invalid UUID");var e,t=new Uint8Array(16);return t[0]=(e=parseInt(n.slice(0,8),16))>>>24,t[1]=e>>>16&255,t[2]=e>>>8&255,t[3]=e&255,t[4]=(e=parseInt(n.slice(9,13),16))>>>8,t[5]=e&255,t[6]=(e=parseInt(n.slice(14,18),16))>>>8,t[7]=e&255,t[8]=(e=parseInt(n.slice(19,23),16))>>>8,t[9]=e&255,t[10]=(e=parseInt(n.slice(24,36),16))/1099511627776&255,t[11]=e/4294967296&255,t[12]=e>>>24&255,t[13]=e>>>16&255,t[14]=e>>>8&255,t[15]=e&255,t}function Ba(n){n=unescape(encodeURIComponent(n));for(var e=[],t=0;t<n.length;++t)e.push(n.charCodeAt(t));return e}var Ra="6ba7b810-9dad-11d1-80b4-00c04fd430c8",Ca="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function Vs(n,e,t){function r(s,i,o,a){if(typeof s=="string"&&(s=Ba(s)),typeof i=="string"&&(i=Gs(i)),i.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var c=new Uint8Array(16+s.length);if(c.set(i),c.set(s,i.length),c=t(c),c[6]=c[6]&15|e,c[8]=c[8]&63|128,o){a=a||0;for(var u=0;u<16;++u)o[a+u]=c[u];return o}return kr(c)}try{r.name=n}catch{}return r.DNS=Ra,r.URL=Ca,r}function Ta(n){if(typeof n=="string"){var e=unescape(encodeURIComponent(n));n=new Uint8Array(e.length);for(var t=0;t<e.length;++t)n[t]=e.charCodeAt(t)}return Pa(La(Oa(n),n.length*8))}function Pa(n){for(var e=[],t=n.length*32,r="0123456789abcdef",s=0;s<t;s+=8){var i=n[s>>5]>>>s%32&255,o=parseInt(r.charAt(i>>>4&15)+r.charAt(i&15),16);e.push(o)}return e}function Js(n){return(n+64>>>9<<4)+14+1}function La(n,e){n[e>>5]|=128<<e%32,n[Js(e)-1]=e;for(var t=1732584193,r=-271733879,s=-1732584194,i=271733878,o=0;o<n.length;o+=16){var a=t,c=r,u=s,l=i;t=le(t,r,s,i,n[o],7,-680876936),i=le(i,t,r,s,n[o+1],12,-389564586),s=le(s,i,t,r,n[o+2],17,606105819),r=le(r,s,i,t,n[o+3],22,-1044525330),t=le(t,r,s,i,n[o+4],7,-176418897),i=le(i,t,r,s,n[o+5],12,1200080426),s=le(s,i,t,r,n[o+6],17,-1473231341),r=le(r,s,i,t,n[o+7],22,-45705983),t=le(t,r,s,i,n[o+8],7,1770035416),i=le(i,t,r,s,n[o+9],12,-1958414417),s=le(s,i,t,r,n[o+10],17,-42063),r=le(r,s,i,t,n[o+11],22,-1990404162),t=le(t,r,s,i,n[o+12],7,1804603682),i=le(i,t,r,s,n[o+13],12,-40341101),s=le(s,i,t,r,n[o+14],17,-1502002290),r=le(r,s,i,t,n[o+15],22,1236535329),t=fe(t,r,s,i,n[o+1],5,-165796510),i=fe(i,t,r,s,n[o+6],9,-1069501632),s=fe(s,i,t,r,n[o+11],14,643717713),r=fe(r,s,i,t,n[o],20,-373897302),t=fe(t,r,s,i,n[o+5],5,-701558691),i=fe(i,t,r,s,n[o+10],9,38016083),s=fe(s,i,t,r,n[o+15],14,-660478335),r=fe(r,s,i,t,n[o+4],20,-405537848),t=fe(t,r,s,i,n[o+9],5,568446438),i=fe(i,t,r,s,n[o+14],9,-1019803690),s=fe(s,i,t,r,n[o+3],14,-187363961),r=fe(r,s,i,t,n[o+8],20,1163531501),t=fe(t,r,s,i,n[o+13],5,-1444681467),i=fe(i,t,r,s,n[o+2],9,-51403784),s=fe(s,i,t,r,n[o+7],14,1735328473),r=fe(r,s,i,t,n[o+12],20,-1926607734),t=he(t,r,s,i,n[o+5],4,-378558),i=he(i,t,r,s,n[o+8],11,-2022574463),s=he(s,i,t,r,n[o+11],16,1839030562),r=he(r,s,i,t,n[o+14],23,-35309556),t=he(t,r,s,i,n[o+1],4,-1530992060),i=he(i,t,r,s,n[o+4],11,1272893353),s=he(s,i,t,r,n[o+7],16,-155497632),r=he(r,s,i,t,n[o+10],23,-1094730640),t=he(t,r,s,i,n[o+13],4,681279174),i=he(i,t,r,s,n[o],11,-358537222),s=he(s,i,t,r,n[o+3],16,-722521979),r=he(r,s,i,t,n[o+6],23,76029189),t=he(t,r,s,i,n[o+9],4,-640364487),i=he(i,t,r,s,n[o+12],11,-421815835),s=he(s,i,t,r,n[o+15],16,530742520),r=he(r,s,i,t,n[o+2],23,-995338651),t=de(t,r,s,i,n[o],6,-198630844),i=de(i,t,r,s,n[o+7],10,1126891415),s=de(s,i,t,r,n[o+14],15,-1416354905),r=de(r,s,i,t,n[o+5],21,-57434055),t=de(t,r,s,i,n[o+12],6,1700485571),i=de(i,t,r,s,n[o+3],10,-1894986606),s=de(s,i,t,r,n[o+10],15,-1051523),r=de(r,s,i,t,n[o+1],21,-2054922799),t=de(t,r,s,i,n[o+8],6,1873313359),i=de(i,t,r,s,n[o+15],10,-30611744),s=de(s,i,t,r,n[o+6],15,-1560198380),r=de(r,s,i,t,n[o+13],21,1309151649),t=de(t,r,s,i,n[o+4],6,-145523070),i=de(i,t,r,s,n[o+11],10,-1120210379),s=de(s,i,t,r,n[o+2],15,718787259),r=de(r,s,i,t,n[o+9],21,-343485551),t=Qe(t,a),r=Qe(r,c),s=Qe(s,u),i=Qe(i,l)}return[t,r,s,i]}function Oa(n){if(n.length===0)return[];for(var e=n.length*8,t=new Uint32Array(Js(e)),r=0;r<e;r+=8)t[r>>5]|=(n[r/8]&255)<<r%32;return t}function Qe(n,e){var t=(n&65535)+(e&65535),r=(n>>16)+(e>>16)+(t>>16);return r<<16|t&65535}function Ua(n,e){return n<<e|n>>>32-e}function Ar(n,e,t,r,s,i){return Qe(Ua(Qe(Qe(e,n),Qe(r,i)),s),t)}function le(n,e,t,r,s,i,o){return Ar(e&t|~e&r,n,e,s,i,o)}function fe(n,e,t,r,s,i,o){return Ar(e&r|t&~r,n,e,s,i,o)}function he(n,e,t,r,s,i,o){return Ar(e^t^r,n,e,s,i,o)}function de(n,e,t,r,s,i,o){return Ar(t^(e|~r),n,e,s,i,o)}var Na=Vs("v3",48,Ta);const $a=Na;function Fa(n,e,t){n=n||{};var r=n.random||(n.rng||Ws)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){t=t||0;for(var s=0;s<16;++s)e[t+s]=r[s];return e}return kr(r)}function Ma(n,e,t,r){switch(n){case 0:return e&t^~e&r;case 1:return e^t^r;case 2:return e&t^e&r^t&r;case 3:return e^t^r}}function Kr(n,e){return n<<e|n>>>32-e}function Ka(n){var e=[1518500249,1859775393,2400959708,3395469782],t=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof n=="string"){var r=unescape(encodeURIComponent(n));n=[];for(var s=0;s<r.length;++s)n.push(r.charCodeAt(s))}else Array.isArray(n)||(n=Array.prototype.slice.call(n));n.push(128);for(var i=n.length/4+2,o=Math.ceil(i/16),a=new Array(o),c=0;c<o;++c){for(var u=new Uint32Array(16),l=0;l<16;++l)u[l]=n[c*64+l*4]<<24|n[c*64+l*4+1]<<16|n[c*64+l*4+2]<<8|n[c*64+l*4+3];a[c]=u}a[o-1][14]=(n.length-1)*8/Math.pow(2,32),a[o-1][14]=Math.floor(a[o-1][14]),a[o-1][15]=(n.length-1)*8&4294967295;for(var f=0;f<o;++f){for(var p=new Uint32Array(80),h=0;h<16;++h)p[h]=a[f][h];for(var d=16;d<80;++d)p[d]=Kr(p[d-3]^p[d-8]^p[d-14]^p[d-16],1);for(var y=t[0],g=t[1],k=t[2],v=t[3],b=t[4],P=0;P<80;++P){var x=Math.floor(P/20),L=Kr(y,5)+Ma(x,g,k,v)+b+e[x]+p[P]>>>0;b=v,v=k,k=Kr(g,30)>>>0,g=y,y=L}t[0]=t[0]+y>>>0,t[1]=t[1]+g>>>0,t[2]=t[2]+k>>>0,t[3]=t[3]+v>>>0,t[4]=t[4]+b>>>0}return[t[0]>>24&255,t[0]>>16&255,t[0]>>8&255,t[0]&255,t[1]>>24&255,t[1]>>16&255,t[1]>>8&255,t[1]&255,t[2]>>24&255,t[2]>>16&255,t[2]>>8&255,t[2]&255,t[3]>>24&255,t[3]>>16&255,t[3]>>8&255,t[3]&255,t[4]>>24&255,t[4]>>16&255,t[4]>>8&255,t[4]&255]}var qa=Vs("v5",80,Ka);const Ha=qa,Da="00000000-0000-0000-0000-000000000000";function za(n){if(!Sr(n))throw TypeError("Invalid UUID");return parseInt(n.substr(14,1),16)}const ja=Object.freeze(Object.defineProperty({__proto__:null,NIL:Da,parse:Gs,stringify:kr,v1:Ia,v3:$a,v4:Fa,v5:Ha,validate:Sr,version:za},Symbol.toStringTag,{value:"Module"})),Zs=He(ja),Wa=Zs.v4,Ga=function(n,e,t,r){if(typeof n!="string")throw new TypeError(n+" must be a string");r=r||{};const s=typeof r.version=="number"?r.version:2;if(s!==1&&s!==2)throw new TypeError(s+" must be 1 or 2");const i={method:n};if(s===2&&(i.jsonrpc="2.0"),e){if(typeof e!="object"&&!Array.isArray(e))throw new TypeError(e+" must be an object, array or omitted");i.params=e}if(typeof t>"u"){const o=typeof r.generator=="function"?r.generator:function(){return Wa()};i.id=o(i,r)}else s===2&&t===null?r.notificationIdNull&&(i.id=null):i.id=t;return i};var Va=Ga;const Ja=Zs.v4,Za=Va,Ft=function(n,e){if(!(this instanceof Ft))return new Ft(n,e);e||(e={}),this.options={reviver:typeof e.reviver<"u"?e.reviver:null,replacer:typeof e.replacer<"u"?e.replacer:null,generator:typeof e.generator<"u"?e.generator:function(){return Ja()},version:typeof e.version<"u"?e.version:2,notificationIdNull:typeof e.notificationIdNull=="boolean"?e.notificationIdNull:!1},this.callServer=n};var Xa=Ft;Ft.prototype.request=function(n,e,t,r){const s=this;let i=null;const o=Array.isArray(n)&&typeof e=="function";if(this.options.version===1&&o)throw new TypeError("JSON-RPC 1.0 does not support batching");if(o||!o&&n&&typeof n=="object"&&typeof e=="function")r=e,i=n;else{typeof t=="function"&&(r=t,t=void 0);const u=typeof r=="function";try{i=Za(n,e,t,{generator:this.options.generator,version:this.options.version,notificationIdNull:this.options.notificationIdNull})}catch(l){if(u)return r(l);throw l}if(!u)return i}let c;try{c=JSON.stringify(i,this.options.replacer)}catch(u){return r(u)}return this.callServer(c,function(u,l){s._parseResponse(u,l,r)}),i};Ft.prototype._parseResponse=function(n,e,t){if(n){t(n);return}if(!e)return t();let r;try{r=JSON.parse(e,this.options.reviver)}catch(s){return t(s)}if(t.length===3)if(Array.isArray(r)){const s=function(o){return typeof o.error<"u"},i=function(o){return!s(o)};return t(null,r.filter(s),r.filter(i))}else return t(null,r.error,r.result);t(null,r)};var Xs={},lr={},Ya={get exports(){return lr},set exports(n){lr=n}};(function(n){function e(t){return t&&t.__esModule?t:{default:t}}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(Ya);const Qa=He(Ti),ec=He(Pi),Ys=He(Li),Qs=He(Oi),ei=He(Ui),ti=He(Ni),ri=He($i);var fr={},tc={get exports(){return fr},set exports(n){fr=n}},Mn;function ni(){return Mn||(Mn=1,function(n){var e=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function s(c,u,l){this.fn=c,this.context=u,this.once=l||!1}function i(c,u,l,f,p){if(typeof l!="function")throw new TypeError("The listener must be a function");var h=new s(l,f||c,p),d=t?t+u:u;return c._events[d]?c._events[d].fn?c._events[d]=[c._events[d],h]:c._events[d].push(h):(c._events[d]=h,c._eventsCount++),c}function o(c,u){--c._eventsCount===0?c._events=new r:delete c._events[u]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var u=[],l,f;if(this._eventsCount===0)return u;for(f in l=this._events)e.call(l,f)&&u.push(t?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(l)):u},a.prototype.listeners=function(u){var l=t?t+u:u,f=this._events[l];if(!f)return[];if(f.fn)return[f.fn];for(var p=0,h=f.length,d=new Array(h);p<h;p++)d[p]=f[p].fn;return d},a.prototype.listenerCount=function(u){var l=t?t+u:u,f=this._events[l];return f?f.fn?1:f.length:0},a.prototype.emit=function(u,l,f,p,h,d){var y=t?t+u:u;if(!this._events[y])return!1;var g=this._events[y],k=arguments.length,v,b;if(g.fn){switch(g.once&&this.removeListener(u,g.fn,void 0,!0),k){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,l),!0;case 3:return g.fn.call(g.context,l,f),!0;case 4:return g.fn.call(g.context,l,f,p),!0;case 5:return g.fn.call(g.context,l,f,p,h),!0;case 6:return g.fn.call(g.context,l,f,p,h,d),!0}for(b=1,v=new Array(k-1);b<k;b++)v[b-1]=arguments[b];g.fn.apply(g.context,v)}else{var P=g.length,x;for(b=0;b<P;b++)switch(g[b].once&&this.removeListener(u,g[b].fn,void 0,!0),k){case 1:g[b].fn.call(g[b].context);break;case 2:g[b].fn.call(g[b].context,l);break;case 3:g[b].fn.call(g[b].context,l,f);break;case 4:g[b].fn.call(g[b].context,l,f,p);break;default:if(!v)for(x=1,v=new Array(k-1);x<k;x++)v[x-1]=arguments[x];g[b].fn.apply(g[b].context,v)}}return!0},a.prototype.on=function(u,l,f){return i(this,u,l,f,!1)},a.prototype.once=function(u,l,f){return i(this,u,l,f,!0)},a.prototype.removeListener=function(u,l,f,p){var h=t?t+u:u;if(!this._events[h])return this;if(!l)return o(this,h),this;var d=this._events[h];if(d.fn)d.fn===l&&(!p||d.once)&&(!f||d.context===f)&&o(this,h);else{for(var y=0,g=[],k=d.length;y<k;y++)(d[y].fn!==l||p&&!d[y].once||f&&d[y].context!==f)&&g.push(d[y]);g.length?this._events[h]=g.length===1?g[0]:g:o(this,h)}return this},a.prototype.removeAllListeners=function(u){var l;return u?(l=t?t+u:u,this._events[l]&&o(this,l)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=t,a.EventEmitter=a,n.exports=a}(tc)),fr}(function(n){var e=lr;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(S),r=e(Qa),s=e(ec),i=e(Ys),o=e(Qs),a=e(ei),c=e(ti),u=e(ri),l=ni();function f(y){var g=p();return function(){var v=(0,u.default)(y),b;if(g){var P=(0,u.default)(this).constructor;b=Reflect.construct(v,arguments,P)}else b=v.apply(this,arguments);return(0,c.default)(this,b)}}function p(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var h=function(y,g){var k={};for(var v in y)Object.prototype.hasOwnProperty.call(y,v)&&g.indexOf(v)<0&&(k[v]=y[v]);if(y!=null&&typeof Object.getOwnPropertySymbols=="function")for(var b=0,v=Object.getOwnPropertySymbols(y);b<v.length;b++)g.indexOf(v[b])<0&&Object.prototype.propertyIsEnumerable.call(y,v[b])&&(k[v[b]]=y[v[b]]);return k},d=function(y){(0,a.default)(k,y);var g=f(k);function k(v){var b,P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"ws://localhost:8080",x=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},L=arguments.length>3?arguments[3]:void 0;(0,i.default)(this,k);var C=x.autoconnect,F=C===void 0?!0:C,Y=x.reconnect,ke=Y===void 0?!0:Y,De=x.reconnect_interval,Fe=De===void 0?1e3:De,mt=x.max_reconnects,Rr=mt===void 0?5:mt,Vt=h(x,["autoconnect","reconnect","reconnect_interval","max_reconnects"]);return b=g.call(this),b.webSocketFactory=v,b.queue={},b.rpc_id=0,b.address=P,b.autoconnect=F,b.ready=!1,b.reconnect=ke,b.reconnect_timer_id=void 0,b.reconnect_interval=Fe,b.max_reconnects=Rr,b.rest_options=Vt,b.current_reconnects=0,b.generate_request_id=L||function(){return++b.rpc_id},b.autoconnect&&b._connect(b.address,Object.assign({autoconnect:b.autoconnect,reconnect:b.reconnect,reconnect_interval:b.reconnect_interval,max_reconnects:b.max_reconnects},b.rest_options)),b}return(0,o.default)(k,[{key:"connect",value:function(){this.socket||this._connect(this.address,Object.assign({autoconnect:this.autoconnect,reconnect:this.reconnect,reconnect_interval:this.reconnect_interval,max_reconnects:this.max_reconnects},this.rest_options))}},{key:"call",value:function(b,P,x,L){var C=this;return!L&&(0,s.default)(x)==="object"&&(L=x,x=null),new Promise(function(F,Y){if(!C.ready)return Y(new Error("socket not ready"));var ke=C.generate_request_id(b,P),De={jsonrpc:"2.0",method:b,params:P||null,id:ke};C.socket.send(JSON.stringify(De),L,function(Fe){if(Fe)return Y(Fe);C.queue[ke]={promise:[F,Y]},x&&(C.queue[ke].timeout=setTimeout(function(){delete C.queue[ke],Y(new Error("reply timeout"))},x))})})}},{key:"login",value:function(){var v=(0,r.default)(t.default.mark(function P(x){var L;return t.default.wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.next=2,this.call("rpc.login",x);case 2:if(L=F.sent,L){F.next=5;break}throw new Error("authentication failed");case 5:return F.abrupt("return",L);case 6:case"end":return F.stop()}},P,this)}));function b(P){return v.apply(this,arguments)}return b}()},{key:"listMethods",value:function(){var v=(0,r.default)(t.default.mark(function P(){return t.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.next=2,this.call("__listMethods");case 2:return L.abrupt("return",L.sent);case 3:case"end":return L.stop()}},P,this)}));function b(){return v.apply(this,arguments)}return b}()},{key:"notify",value:function(b,P){var x=this;return new Promise(function(L,C){if(!x.ready)return C(new Error("socket not ready"));var F={jsonrpc:"2.0",method:b,params:P||null};x.socket.send(JSON.stringify(F),function(Y){if(Y)return C(Y);L()})})}},{key:"subscribe",value:function(){var v=(0,r.default)(t.default.mark(function P(x){var L;return t.default.wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return typeof x=="string"&&(x=[x]),F.next=3,this.call("rpc.on",x);case 3:if(L=F.sent,!(typeof x=="string"&&L[x]!=="ok")){F.next=6;break}throw new Error("Failed subscribing to an event '"+x+"' with: "+L[x]);case 6:return F.abrupt("return",L);case 7:case"end":return F.stop()}},P,this)}));function b(P){return v.apply(this,arguments)}return b}()},{key:"unsubscribe",value:function(){var v=(0,r.default)(t.default.mark(function P(x){var L;return t.default.wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return typeof x=="string"&&(x=[x]),F.next=3,this.call("rpc.off",x);case 3:if(L=F.sent,!(typeof x=="string"&&L[x]!=="ok")){F.next=6;break}throw new Error("Failed unsubscribing from an event with: "+L);case 6:return F.abrupt("return",L);case 7:case"end":return F.stop()}},P,this)}));function b(P){return v.apply(this,arguments)}return b}()},{key:"close",value:function(b,P){this.socket.close(b||1e3,P)}},{key:"_connect",value:function(b,P){var x=this;clearTimeout(this.reconnect_timer_id),this.socket=this.webSocketFactory(b,P),this.socket.addEventListener("open",function(){x.ready=!0,x.emit("open"),x.current_reconnects=0}),this.socket.addEventListener("message",function(L){var C=L.data;C instanceof ArrayBuffer&&(C=Buffer.from(C).toString());try{C=JSON.parse(C)}catch{return}if(C.notification&&x.listeners(C.notification).length){if(!Object.keys(C.params).length)return x.emit(C.notification);var F=[C.notification];if(C.params.constructor===Object)F.push(C.params);else for(var Y=0;Y<C.params.length;Y++)F.push(C.params[Y]);return Promise.resolve().then(function(){x.emit.apply(x,F)})}if(!x.queue[C.id])return C.method&&C.params?Promise.resolve().then(function(){x.emit(C.method,C.params)}):void 0;"error"in C=="result"in C&&x.queue[C.id].promise[1](new Error('Server response malformed. Response must include either "result" or "error", but not both.')),x.queue[C.id].timeout&&clearTimeout(x.queue[C.id].timeout),C.error?x.queue[C.id].promise[1](C.error):x.queue[C.id].promise[0](C.result),delete x.queue[C.id]}),this.socket.addEventListener("error",function(L){return x.emit("error",L)}),this.socket.addEventListener("close",function(L){var C=L.code,F=L.reason;x.ready&&setTimeout(function(){return x.emit("close",C,F)},0),x.ready=!1,x.socket=void 0,C!==1e3&&(x.current_reconnects++,x.reconnect&&(x.max_reconnects>x.current_reconnects||x.max_reconnects===0)&&(x.reconnect_timer_id=setTimeout(function(){return x._connect(b,P)},x.reconnect_interval)))})}}]),k}(l.EventEmitter);n.default=d})(Xs);const rc=cs(Xs);var si={};(function(n){var e=lr;Object.defineProperty(n,"__esModule",{value:!0}),n.default=f;var t=e(Ys),r=e(Qs),s=e(ei),i=e(ti),o=e(ri),a=ni();function c(p){var h=u();return function(){var y=(0,o.default)(p),g;if(h){var k=(0,o.default)(this).constructor;g=Reflect.construct(y,arguments,k)}else g=y.apply(this,arguments);return(0,i.default)(this,g)}}function u(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var l=function(p){(0,s.default)(d,p);var h=c(d);function d(y,g,k){var v;return(0,t.default)(this,d),v=h.call(this),v.socket=new window.WebSocket(y,k),v.socket.onopen=function(){return v.emit("open")},v.socket.onmessage=function(b){return v.emit("message",b.data)},v.socket.onerror=function(b){return v.emit("error",b)},v.socket.onclose=function(b){v.emit("close",b.code,b.reason)},v}return(0,r.default)(d,[{key:"send",value:function(g,k,v){var b=v||k;try{this.socket.send(g),b()}catch(P){b(P)}}},{key:"close",value:function(g,k){this.socket.close(g,k)}},{key:"addEventListener",value:function(g,k,v){this.socket.addEventListener(g,k,v)}}]),d}(a.EventEmitter);function f(p,h){return new l(p,h)}})(si);const nc=cs(si),[ii,oi,ai]=[[],[],[]],sc=BigInt(0),Rt=BigInt(1),ic=BigInt(2),oc=BigInt(7),ac=BigInt(256),cc=BigInt(113);for(let n=0,e=Rt,t=1,r=0;n<24;n++){[t,r]=[r,(2*t+3*r)%5],ii.push(2*(5*r+t)),oi.push((n+1)*(n+2)/2%64);let s=sc;for(let i=0;i<7;i++)e=(e<<Rt^(e>>oc)*cc)%ac,e&ic&&(s^=Rt<<(Rt<<BigInt(i))-Rt);ai.push(s)}const[uc,lc]=K.split(ai,!0),Kn=(n,e,t)=>t>32?K.rotlBH(n,e,t):K.rotlSH(n,e,t),qn=(n,e,t)=>t>32?K.rotlBL(n,e,t):K.rotlSL(n,e,t);function fc(n,e=24){const t=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)t[o]=n[o]^n[o+10]^n[o+20]^n[o+30]^n[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,u=t[c],l=t[c+1],f=Kn(u,l,1)^t[a],p=qn(u,l,1)^t[a+1];for(let h=0;h<50;h+=10)n[o+h]^=f,n[o+h+1]^=p}let s=n[2],i=n[3];for(let o=0;o<24;o++){const a=oi[o],c=Kn(s,i,a),u=qn(s,i,a),l=ii[o];s=n[l],i=n[l+1],n[l]=c,n[l+1]=u}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)t[a]=n[o+a];for(let a=0;a<10;a++)n[o+a]^=~t[(a+2)%10]&t[(a+4)%10]}n[0]^=uc[r],n[1]^=lc[r]}t.fill(0)}class xr extends on{constructor(e,t,r,s=!1,i=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=s,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,ve.number(r),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=Vi(this.state)}keccak(){fc(this.state32,this.rounds),this.posOut=0,this.pos=0}update(e){ve.exists(this);const{blockLen:t,state:r}=this;e=qt(e);const s=e.length;for(let i=0;i<s;){const o=Math.min(t-this.pos,s-i);for(let a=0;a<o;a++)r[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:r,blockLen:s}=this;e[r]^=t,t&128&&r===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){ve.exists(this,!1),ve.bytes(e),this.finish();const t=this.state,{blockLen:r}=this;for(let s=0,i=e.length;s<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-s);e.set(t.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return ve.number(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(ve.output(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:r,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new xr(t,r,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}}const it=(n,e,t)=>ht(()=>new xr(e,n,t));it(6,144,224/8);it(6,136,256/8);it(6,104,384/8);it(6,72,512/8);it(1,144,224/8);it(1,136,256/8);it(1,104,384/8);it(1,72,512/8);const ci=(n,e,t)=>Xi((r={})=>new xr(e,n,r.dkLen===void 0?t:r.dkLen,!0));ci(31,168,128/8);ci(31,136,256/8);class ui extends on{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,ve.hash(e);const r=qt(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new TypeError("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(r.length>s?e.create().update(r).digest():r);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),i.fill(0)}update(e){return ve.exists(this),this.iHash.update(e),this}digestInto(e){ve.exists(this),ve.bytes(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:r,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const li=(n,e,t)=>new ui(n,e).update(t).digest();li.create=(n,e)=>new ui(n,e);ut.sha512Sync=(...n)=>Eo(ut.concatBytes(...n));ut.randomPrivateKey;const Hn=()=>{const n=ut.randomPrivateKey(),e=Jr(n),t=new Uint8Array(64);return t.set(n),t.set(e,32),{publicKey:e,secretKey:t}},Jr=ln.getPublicKey;function Dn(n){try{return te.fromHex(n,!0),!0}catch{return!1}}const hc=(n,e)=>ln.sign(n,e.slice(0,32)),dc=ln.verify,At=n=>H.Buffer.isBuffer(n)?n:n instanceof Uint8Array?H.Buffer.from(n.buffer,n.byteOffset,n.byteLength):H.Buffer.from(n);class pc{constructor(e){Object.assign(this,e)}encode(){return H.Buffer.from(_s(er,this))}static decode(e){return Es(er,this,e)}static decodeUnchecked(e){return vs(er,this,e)}}const er=new Map;let fi;const gc=32,Le=32;function yc(n){return n._bn!==void 0}let zn=1;fi=Symbol.toStringTag;class $ extends pc{constructor(e){if(super({}),this._bn=void 0,yc(e))this._bn=e._bn;else{if(typeof e=="string"){const t=J.decode(e);if(t.length!=Le)throw new Error("Invalid public key input");this._bn=new Cn(t)}else this._bn=new Cn(e);if(this._bn.byteLength()>Le)throw new Error("Invalid public key input")}}static unique(){const e=new $(zn);return zn+=1,new $(e.toBuffer())}equals(e){return this._bn.eq(e._bn)}toBase58(){return J.encode(this.toBytes())}toJSON(){return this.toBase58()}toBytes(){const e=this.toBuffer();return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}toBuffer(){const e=this._bn.toArrayLike(H.Buffer);if(e.length===Le)return e;const t=H.Buffer.alloc(32);return e.copy(t,32-e.length),t}get[fi](){return`PublicKey(${this.toString()})`}toString(){return this.toBase58()}static async createWithSeed(e,t,r){const s=H.Buffer.concat([e.toBuffer(),H.Buffer.from(t),r.toBuffer()]),i=Gr(s);return new $(i)}static createProgramAddressSync(e,t){let r=H.Buffer.alloc(0);e.forEach(function(i){if(i.length>gc)throw new TypeError("Max seed length exceeded");r=H.Buffer.concat([r,At(i)])}),r=H.Buffer.concat([r,t.toBuffer(),H.Buffer.from("ProgramDerivedAddress")]);const s=Gr(r);if(Dn(s))throw new Error("Invalid seeds, address must fall off the curve");return new $(s)}static async createProgramAddress(e,t){return this.createProgramAddressSync(e,t)}static findProgramAddressSync(e,t){let r=255,s;for(;r!=0;){try{const i=e.concat(H.Buffer.from([r]));s=this.createProgramAddressSync(i,t)}catch(i){if(i instanceof TypeError)throw i;r--;continue}return[s,r]}throw new Error("Unable to find a viable program address nonce")}static async findProgramAddress(e,t){return this.findProgramAddressSync(e,t)}static isOnCurve(e){const t=new $(e);return Dn(t.toBytes())}}$.default=new $("11111111111111111111111111111111");er.set($,{kind:"struct",fields:[["_bn","u256"]]});new $("BPFLoader1111111111111111111111111111111111");const St=1280-40-8,hi=127,Zr=64;class di extends Error{constructor(e){super(`Signature ${e} has expired: block height exceeded.`),this.signature=void 0,this.signature=e}}Object.defineProperty(di.prototype,"name",{value:"TransactionExpiredBlockheightExceededError"});class pi extends Error{constructor(e,t){super(`Transaction was not confirmed in ${t.toFixed(2)} seconds. It is unknown if it succeeded or failed. Check signature ${e} using the Solana Explorer or CLI tools.`),this.signature=void 0,this.signature=e}}Object.defineProperty(pi.prototype,"name",{value:"TransactionExpiredTimeoutError"});class Tt extends Error{constructor(e){super(`Signature ${e} has expired: the nonce is no longer valid.`),this.signature=void 0,this.signature=e}}Object.defineProperty(Tt.prototype,"name",{value:"TransactionExpiredNonceInvalidError"});class hr{constructor(e,t){this.staticAccountKeys=void 0,this.accountKeysFromLookups=void 0,this.staticAccountKeys=e,this.accountKeysFromLookups=t}keySegments(){const e=[this.staticAccountKeys];return this.accountKeysFromLookups&&(e.push(this.accountKeysFromLookups.writable),e.push(this.accountKeysFromLookups.readonly)),e}get(e){for(const t of this.keySegments()){if(e<t.length)return t[e];e-=t.length}}get length(){return this.keySegments().flat().length}compileInstructions(e){if(this.length>255+1)throw new Error("Account index overflow encountered during compilation");const r=new Map;this.keySegments().flat().forEach((i,o)=>{r.set(i.toBase58(),o)});const s=i=>{const o=r.get(i.toBase58());if(o===void 0)throw new Error("Encountered an unknown instruction account key during compilation");return o};return e.map(i=>({programIdIndex:s(i.programId),accountKeyIndexes:i.keys.map(o=>s(o.pubkey)),data:i.data}))}}const D=(n="publicKey")=>re(32,n),vt=(n="string")=>{const e=O([N("length"),N("lengthPadding"),re(ct(N(),-8),"chars")],n),t=e.decode.bind(e),r=e.encode.bind(e),s=e;return s.decode=(i,o)=>t(i,o).chars.toString(),s.encode=(i,o,a)=>{const c={chars:H.Buffer.from(i,"utf8")};return r(c,o,a)},s.alloc=i=>N().span+N().span+H.Buffer.from(i,"utf8").length,s},mc=(n="authorized")=>O([D("staker"),D("withdrawer")],n),wc=(n="lockup")=>O([be("unixTimestamp"),be("epoch"),D("custodian")],n),bc=(n="voteInit")=>O([D("nodePubkey"),D("authorizedVoter"),D("authorizedWithdrawer"),V("commission")],n),vc=(n="voteAuthorizeWithSeedArgs")=>O([N("voteAuthorizationType"),D("currentAuthorityDerivedKeyOwnerPubkey"),vt("currentAuthorityDerivedKeySeed"),D("newAuthorized")],n);function xe(n){let e=0,t=0;for(;;){let r=n.shift();if(e|=(r&127)<<t*7,t+=1,!(r&128))break}return e}function _e(n,e){let t=e;for(;;){let r=t&127;if(t>>=7,t==0){n.push(r);break}else r|=128,n.push(r)}}function ne(n,e){if(!n)throw new Error(e||"Assertion failed")}class _r{constructor(e,t){this.payer=void 0,this.keyMetaMap=void 0,this.payer=e,this.keyMetaMap=t}static compile(e,t){const r=new Map,s=o=>{const a=o.toBase58();let c=r.get(a);return c===void 0&&(c={isSigner:!1,isWritable:!1,isInvoked:!1},r.set(a,c)),c},i=s(t);i.isSigner=!0,i.isWritable=!0;for(const o of e){s(o.programId).isInvoked=!0;for(const a of o.keys){const c=s(a.pubkey);c.isSigner||(c.isSigner=a.isSigner),c.isWritable||(c.isWritable=a.isWritable)}}return new _r(t,r)}getMessageComponents(){const e=[...this.keyMetaMap.entries()];ne(e.length<=256,"Max static account keys length exceeded");const t=e.filter(([,c])=>c.isSigner&&c.isWritable),r=e.filter(([,c])=>c.isSigner&&!c.isWritable),s=e.filter(([,c])=>!c.isSigner&&c.isWritable),i=e.filter(([,c])=>!c.isSigner&&!c.isWritable),o={numRequiredSignatures:t.length+r.length,numReadonlySignedAccounts:r.length,numReadonlyUnsignedAccounts:i.length};{ne(t.length>0,"Expected at least one writable signer key");const[c]=t[0];ne(c===this.payer.toBase58(),"Expected first writable signer key to be the fee payer")}const a=[...t.map(([c])=>new $(c)),...r.map(([c])=>new $(c)),...s.map(([c])=>new $(c)),...i.map(([c])=>new $(c))];return[o,a]}extractTableLookup(e){const[t,r]=this.drainKeysFoundInLookupTable(e.state.addresses,o=>!o.isSigner&&!o.isInvoked&&o.isWritable),[s,i]=this.drainKeysFoundInLookupTable(e.state.addresses,o=>!o.isSigner&&!o.isInvoked&&!o.isWritable);if(!(t.length===0&&s.length===0))return[{accountKey:e.key,writableIndexes:t,readonlyIndexes:s},{writable:r,readonly:i}]}drainKeysFoundInLookupTable(e,t){const r=new Array,s=new Array;for(const[i,o]of this.keyMetaMap.entries())if(t(o)){const a=new $(i),c=e.findIndex(u=>u.equals(a));c>=0&&(ne(c<256,"Max lookup table index exceeded"),r.push(c),s.push(a),this.keyMetaMap.delete(i))}return[r,s]}}class rt{constructor(e){this.header=void 0,this.accountKeys=void 0,this.recentBlockhash=void 0,this.instructions=void 0,this.indexToProgramIds=new Map,this.header=e.header,this.accountKeys=e.accountKeys.map(t=>new $(t)),this.recentBlockhash=e.recentBlockhash,this.instructions=e.instructions,this.instructions.forEach(t=>this.indexToProgramIds.set(t.programIdIndex,this.accountKeys[t.programIdIndex]))}get version(){return"legacy"}get staticAccountKeys(){return this.accountKeys}get compiledInstructions(){return this.instructions.map(e=>({programIdIndex:e.programIdIndex,accountKeyIndexes:e.accounts,data:J.decode(e.data)}))}get addressTableLookups(){return[]}getAccountKeys(){return new hr(this.staticAccountKeys)}static compile(e){const t=_r.compile(e.instructions,e.payerKey),[r,s]=t.getMessageComponents(),o=new hr(s).compileInstructions(e.instructions).map(a=>({programIdIndex:a.programIdIndex,accounts:a.accountKeyIndexes,data:J.encode(a.data)}));return new rt({header:r,accountKeys:s,recentBlockhash:e.recentBlockhash,instructions:o})}isAccountSigner(e){return e<this.header.numRequiredSignatures}isAccountWritable(e){const t=this.header.numRequiredSignatures;if(e>=this.header.numRequiredSignatures){const r=e-t,i=this.accountKeys.length-t-this.header.numReadonlyUnsignedAccounts;return r<i}else{const r=t-this.header.numReadonlySignedAccounts;return e<r}}isProgramId(e){return this.indexToProgramIds.has(e)}programIds(){return[...this.indexToProgramIds.values()]}nonProgramIds(){return this.accountKeys.filter((e,t)=>!this.isProgramId(t))}serialize(){const e=this.accountKeys.length;let t=[];_e(t,e);const r=this.instructions.map(f=>{const{accounts:p,programIdIndex:h}=f,d=Array.from(J.decode(f.data));let y=[];_e(y,p.length);let g=[];return _e(g,d.length),{programIdIndex:h,keyIndicesCount:H.Buffer.from(y),keyIndices:p,dataLength:H.Buffer.from(g),data:d}});let s=[];_e(s,r.length);let i=H.Buffer.alloc(St);H.Buffer.from(s).copy(i);let o=s.length;r.forEach(f=>{const h=O([V("programIdIndex"),re(f.keyIndicesCount.length,"keyIndicesCount"),ge(V("keyIndex"),f.keyIndices.length,"keyIndices"),re(f.dataLength.length,"dataLength"),ge(V("userdatum"),f.data.length,"data")]).encode(f,i,o);o+=h}),i=i.slice(0,o);const a=O([re(1,"numRequiredSignatures"),re(1,"numReadonlySignedAccounts"),re(1,"numReadonlyUnsignedAccounts"),re(t.length,"keyCount"),ge(D("key"),e,"keys"),D("recentBlockhash")]),c={numRequiredSignatures:H.Buffer.from([this.header.numRequiredSignatures]),numReadonlySignedAccounts:H.Buffer.from([this.header.numReadonlySignedAccounts]),numReadonlyUnsignedAccounts:H.Buffer.from([this.header.numReadonlyUnsignedAccounts]),keyCount:H.Buffer.from(t),keys:this.accountKeys.map(f=>At(f.toBytes())),recentBlockhash:J.decode(this.recentBlockhash)};let u=H.Buffer.alloc(2048);const l=a.encode(c,u);return i.copy(u,l),u.slice(0,l+i.length)}static from(e){let t=[...e];const r=t.shift();if(r!==(r&hi))throw new Error("Versioned messages must be deserialized with VersionedMessage.deserialize()");const s=t.shift(),i=t.shift(),o=xe(t);let a=[];for(let p=0;p<o;p++){const h=t.slice(0,Le);t=t.slice(Le),a.push(new $(H.Buffer.from(h)))}const c=t.slice(0,Le);t=t.slice(Le);const u=xe(t);let l=[];for(let p=0;p<u;p++){const h=t.shift(),d=xe(t),y=t.slice(0,d);t=t.slice(d);const g=xe(t),k=t.slice(0,g),v=J.encode(H.Buffer.from(k));t=t.slice(g),l.push({programIdIndex:h,accounts:y,data:v})}const f={header:{numRequiredSignatures:r,numReadonlySignedAccounts:s,numReadonlyUnsignedAccounts:i},recentBlockhash:J.encode(H.Buffer.from(c)),accountKeys:a,instructions:l};return new rt(f)}}class dr{constructor(e){this.header=void 0,this.staticAccountKeys=void 0,this.recentBlockhash=void 0,this.compiledInstructions=void 0,this.addressTableLookups=void 0,this.header=e.header,this.staticAccountKeys=e.staticAccountKeys,this.recentBlockhash=e.recentBlockhash,this.compiledInstructions=e.compiledInstructions,this.addressTableLookups=e.addressTableLookups}get version(){return 0}get numAccountKeysFromLookups(){let e=0;for(const t of this.addressTableLookups)e+=t.readonlyIndexes.length+t.writableIndexes.length;return e}getAccountKeys(e){let t;if(e&&"accountKeysFromLookups"in e&&e.accountKeysFromLookups){if(this.numAccountKeysFromLookups!=e.accountKeysFromLookups.writable.length+e.accountKeysFromLookups.readonly.length)throw new Error("Failed to get account keys because of a mismatch in the number of account keys from lookups");t=e.accountKeysFromLookups}else if(e&&"addressLookupTableAccounts"in e&&e.addressLookupTableAccounts)t=this.resolveAddressTableLookups(e.addressLookupTableAccounts);else if(this.addressTableLookups.length>0)throw new Error("Failed to get account keys because address table lookups were not resolved");return new hr(this.staticAccountKeys,t)}isAccountSigner(e){return e<this.header.numRequiredSignatures}isAccountWritable(e){const t=this.header.numRequiredSignatures,r=this.staticAccountKeys.length;if(e>=r){const s=e-r,i=this.addressTableLookups.reduce((o,a)=>o+a.writableIndexes.length,0);return s<i}else if(e>=this.header.numRequiredSignatures){const s=e-t,o=r-t-this.header.numReadonlyUnsignedAccounts;return s<o}else{const s=t-this.header.numReadonlySignedAccounts;return e<s}}resolveAddressTableLookups(e){const t={writable:[],readonly:[]};for(const r of this.addressTableLookups){const s=e.find(i=>i.key.equals(r.accountKey));if(!s)throw new Error(`Failed to find address lookup table account for table key ${r.accountKey.toBase58()}`);for(const i of r.writableIndexes)if(i<s.state.addresses.length)t.writable.push(s.state.addresses[i]);else throw new Error(`Failed to find address for index ${i} in address lookup table ${r.accountKey.toBase58()}`);for(const i of r.readonlyIndexes)if(i<s.state.addresses.length)t.readonly.push(s.state.addresses[i]);else throw new Error(`Failed to find address for index ${i} in address lookup table ${r.accountKey.toBase58()}`)}return t}static compile(e){const t=_r.compile(e.instructions,e.payerKey),r=new Array,s={writable:new Array,readonly:new Array},i=e.addressLookupTableAccounts||[];for(const l of i){const f=t.extractTableLookup(l);if(f!==void 0){const[p,{writable:h,readonly:d}]=f;r.push(p),s.writable.push(...h),s.readonly.push(...d)}}const[o,a]=t.getMessageComponents(),u=new hr(a,s).compileInstructions(e.instructions);return new dr({header:o,staticAccountKeys:a,recentBlockhash:e.recentBlockhash,compiledInstructions:u,addressTableLookups:r})}serialize(){const e=Array();_e(e,this.staticAccountKeys.length);const t=this.serializeInstructions(),r=Array();_e(r,this.compiledInstructions.length);const s=this.serializeAddressTableLookups(),i=Array();_e(i,this.addressTableLookups.length);const o=O([V("prefix"),O([V("numRequiredSignatures"),V("numReadonlySignedAccounts"),V("numReadonlyUnsignedAccounts")],"header"),re(e.length,"staticAccountKeysLength"),ge(D(),this.staticAccountKeys.length,"staticAccountKeys"),D("recentBlockhash"),re(r.length,"instructionsLength"),re(t.length,"serializedInstructions"),re(i.length,"addressTableLookupsLength"),re(s.length,"serializedAddressTableLookups")]),a=new Uint8Array(St),c=1<<7,u=o.encode({prefix:c,header:this.header,staticAccountKeysLength:new Uint8Array(e),staticAccountKeys:this.staticAccountKeys.map(l=>l.toBytes()),recentBlockhash:J.decode(this.recentBlockhash),instructionsLength:new Uint8Array(r),serializedInstructions:t,addressTableLookupsLength:new Uint8Array(i),serializedAddressTableLookups:s},a);return a.slice(0,u)}serializeInstructions(){let e=0;const t=new Uint8Array(St);for(const r of this.compiledInstructions){const s=Array();_e(s,r.accountKeyIndexes.length);const i=Array();_e(i,r.data.length);const o=O([V("programIdIndex"),re(s.length,"encodedAccountKeyIndexesLength"),ge(V(),r.accountKeyIndexes.length,"accountKeyIndexes"),re(i.length,"encodedDataLength"),re(r.data.length,"data")]);e+=o.encode({programIdIndex:r.programIdIndex,encodedAccountKeyIndexesLength:new Uint8Array(s),accountKeyIndexes:r.accountKeyIndexes,encodedDataLength:new Uint8Array(i),data:r.data},t,e)}return t.slice(0,e)}serializeAddressTableLookups(){let e=0;const t=new Uint8Array(St);for(const r of this.addressTableLookups){const s=Array();_e(s,r.writableIndexes.length);const i=Array();_e(i,r.readonlyIndexes.length);const o=O([D("accountKey"),re(s.length,"encodedWritableIndexesLength"),ge(V(),r.writableIndexes.length,"writableIndexes"),re(i.length,"encodedReadonlyIndexesLength"),ge(V(),r.readonlyIndexes.length,"readonlyIndexes")]);e+=o.encode({accountKey:r.accountKey.toBytes(),encodedWritableIndexesLength:new Uint8Array(s),writableIndexes:r.writableIndexes,encodedReadonlyIndexesLength:new Uint8Array(i),readonlyIndexes:r.readonlyIndexes},t,e)}return t.slice(0,e)}static deserialize(e){let t=[...e];const r=t.shift(),s=r&hi;ne(r!==s,"Expected versioned message but received legacy message");const i=s;ne(i===0,`Expected versioned message with version 0 but found version ${i}`);const o={numRequiredSignatures:t.shift(),numReadonlySignedAccounts:t.shift(),numReadonlyUnsignedAccounts:t.shift()},a=[],c=xe(t);for(let d=0;d<c;d++)a.push(new $(t.splice(0,Le)));const u=J.encode(t.splice(0,Le)),l=xe(t),f=[];for(let d=0;d<l;d++){const y=t.shift(),g=xe(t),k=t.splice(0,g),v=xe(t),b=new Uint8Array(t.splice(0,v));f.push({programIdIndex:y,accountKeyIndexes:k,data:b})}const p=xe(t),h=[];for(let d=0;d<p;d++){const y=new $(t.splice(0,Le)),g=xe(t),k=t.splice(0,g),v=xe(t),b=t.splice(0,v);h.push({accountKey:y,writableIndexes:k,readonlyIndexes:b})}return new dr({header:o,staticAccountKeys:a,recentBlockhash:u,compiledInstructions:f,addressTableLookups:h})}}let Pe;(function(n){n[n.BLOCKHEIGHT_EXCEEDED=0]="BLOCKHEIGHT_EXCEEDED",n[n.PROCESSED=1]="PROCESSED",n[n.TIMED_OUT=2]="TIMED_OUT",n[n.NONCE_INVALID=3]="NONCE_INVALID"})(Pe||(Pe={}));const Sc=H.Buffer.alloc(Zr).fill(0);class jn{constructor(e){this.keys=void 0,this.programId=void 0,this.data=H.Buffer.alloc(0),this.programId=e.programId,this.keys=e.keys,e.data&&(this.data=e.data)}toJSON(){return{keys:this.keys.map(({pubkey:e,isSigner:t,isWritable:r})=>({pubkey:e.toJSON(),isSigner:t,isWritable:r})),programId:this.programId.toJSON(),data:[...this.data]}}}class Xe{get signature(){return this.signatures.length>0?this.signatures[0].signature:null}constructor(e){if(this.signatures=[],this.feePayer=void 0,this.instructions=[],this.recentBlockhash=void 0,this.lastValidBlockHeight=void 0,this.nonceInfo=void 0,this.minNonceContextSlot=void 0,this._message=void 0,this._json=void 0,!!e)if(e.feePayer&&(this.feePayer=e.feePayer),e.signatures&&(this.signatures=e.signatures),Object.prototype.hasOwnProperty.call(e,"nonceInfo")){const{minContextSlot:t,nonceInfo:r}=e;this.minNonceContextSlot=t,this.nonceInfo=r}else if(Object.prototype.hasOwnProperty.call(e,"lastValidBlockHeight")){const{blockhash:t,lastValidBlockHeight:r}=e;this.recentBlockhash=t,this.lastValidBlockHeight=r}else{const{recentBlockhash:t,nonceInfo:r}=e;r&&(this.nonceInfo=r),this.recentBlockhash=t}}toJSON(){return{recentBlockhash:this.recentBlockhash||null,feePayer:this.feePayer?this.feePayer.toJSON():null,nonceInfo:this.nonceInfo?{nonce:this.nonceInfo.nonce,nonceInstruction:this.nonceInfo.nonceInstruction.toJSON()}:null,instructions:this.instructions.map(e=>e.toJSON()),signers:this.signatures.map(({publicKey:e})=>e.toJSON())}}add(...e){if(e.length===0)throw new Error("No instructions");return e.forEach(t=>{"instructions"in t?this.instructions=this.instructions.concat(t.instructions):"data"in t&&"programId"in t&&"keys"in t?this.instructions.push(t):this.instructions.push(new jn(t))}),this}compileMessage(){if(this._message&&JSON.stringify(this.toJSON())===JSON.stringify(this._json))return this._message;let e,t;if(this.nonceInfo?(e=this.nonceInfo.nonce,this.instructions[0]!=this.nonceInfo.nonceInstruction?t=[this.nonceInfo.nonceInstruction,...this.instructions]:t=this.instructions):(e=this.recentBlockhash,t=this.instructions),!e)throw new Error("Transaction recentBlockhash required");t.length<1&&console.warn("No instructions provided");let r;if(this.feePayer)r=this.feePayer;else if(this.signatures.length>0&&this.signatures[0].publicKey)r=this.signatures[0].publicKey;else throw new Error("Transaction fee payer required");for(let y=0;y<t.length;y++)if(t[y].programId===void 0)throw new Error(`Transaction instruction index ${y} has undefined program id`);const s=[],i=[];t.forEach(y=>{y.keys.forEach(k=>{i.push({...k})});const g=y.programId.toString();s.includes(g)||s.push(g)}),s.forEach(y=>{i.push({pubkey:new $(y),isSigner:!1,isWritable:!1})});const o=[];i.forEach(y=>{const g=y.pubkey.toString(),k=o.findIndex(v=>v.pubkey.toString()===g);k>-1?(o[k].isWritable=o[k].isWritable||y.isWritable,o[k].isSigner=o[k].isSigner||y.isSigner):o.push(y)}),o.sort(function(y,g){return y.isSigner!==g.isSigner?y.isSigner?-1:1:y.isWritable!==g.isWritable?y.isWritable?-1:1:y.pubkey.toBase58().localeCompare(g.pubkey.toBase58())});const a=o.findIndex(y=>y.pubkey.equals(r));if(a>-1){const[y]=o.splice(a,1);y.isSigner=!0,y.isWritable=!0,o.unshift(y)}else o.unshift({pubkey:r,isSigner:!0,isWritable:!0});for(const y of this.signatures){const g=o.findIndex(k=>k.pubkey.equals(y.publicKey));if(g>-1)o[g].isSigner||(o[g].isSigner=!0,console.warn("Transaction references a signature that is unnecessary, only the fee payer and instruction signer accounts should sign a transaction. This behavior is deprecated and will throw an error in the next major version release."));else throw new Error(`unknown signer: ${y.publicKey.toString()}`)}let c=0,u=0,l=0;const f=[],p=[];o.forEach(({pubkey:y,isSigner:g,isWritable:k})=>{g?(f.push(y.toString()),c+=1,k||(u+=1)):(p.push(y.toString()),k||(l+=1))});const h=f.concat(p),d=t.map(y=>{const{data:g,programId:k}=y;return{programIdIndex:h.indexOf(k.toString()),accounts:y.keys.map(v=>h.indexOf(v.pubkey.toString())),data:J.encode(g)}});return d.forEach(y=>{ne(y.programIdIndex>=0),y.accounts.forEach(g=>ne(g>=0))}),new rt({header:{numRequiredSignatures:c,numReadonlySignedAccounts:u,numReadonlyUnsignedAccounts:l},accountKeys:h,recentBlockhash:e,instructions:d})}_compile(){const e=this.compileMessage(),t=e.accountKeys.slice(0,e.header.numRequiredSignatures);return this.signatures.length===t.length&&this.signatures.every((s,i)=>t[i].equals(s.publicKey))||(this.signatures=t.map(r=>({signature:null,publicKey:r}))),e}serializeMessage(){return this._compile().serialize()}async getEstimatedFee(e){return(await e.getFeeForMessage(this.compileMessage())).value}setSigners(...e){if(e.length===0)throw new Error("No signers");const t=new Set;this.signatures=e.filter(r=>{const s=r.toString();return t.has(s)?!1:(t.add(s),!0)}).map(r=>({signature:null,publicKey:r}))}sign(...e){if(e.length===0)throw new Error("No signers");const t=new Set,r=[];for(const i of e){const o=i.publicKey.toString();t.has(o)||(t.add(o),r.push(i))}this.signatures=r.map(i=>({signature:null,publicKey:i.publicKey}));const s=this._compile();this._partialSign(s,...r)}partialSign(...e){if(e.length===0)throw new Error("No signers");const t=new Set,r=[];for(const i of e){const o=i.publicKey.toString();t.has(o)||(t.add(o),r.push(i))}const s=this._compile();this._partialSign(s,...r)}_partialSign(e,...t){const r=e.serialize();t.forEach(s=>{const i=hc(r,s.secretKey);this._addSignature(s.publicKey,At(i))})}addSignature(e,t){this._compile(),this._addSignature(e,t)}_addSignature(e,t){ne(t.length===64);const r=this.signatures.findIndex(s=>e.equals(s.publicKey));if(r<0)throw new Error(`unknown signer: ${e.toString()}`);this.signatures[r].signature=H.Buffer.from(t)}verifySignatures(e){return this._verifySignatures(this.serializeMessage(),e===void 0?!0:e)}_verifySignatures(e,t){for(const{signature:r,publicKey:s}of this.signatures)if(r===null){if(t)return!1}else if(!dc(r,e,s.toBytes()))return!1;return!0}serialize(e){const{requireAllSignatures:t,verifySignatures:r}=Object.assign({requireAllSignatures:!0,verifySignatures:!0},e),s=this.serializeMessage();if(r&&!this._verifySignatures(s,t))throw new Error("Signature verification failed");return this._serialize(s)}_serialize(e){const{signatures:t}=this,r=[];_e(r,t.length);const s=r.length+t.length*64+e.length,i=H.Buffer.alloc(s);return ne(t.length<256),H.Buffer.from(r).copy(i,0),t.forEach(({signature:o},a)=>{o!==null&&(ne(o.length===64,"signature has invalid length"),H.Buffer.from(o).copy(i,r.length+a*64))}),e.copy(i,r.length+t.length*64),ne(i.length<=St,`Transaction too large: ${i.length} > ${St}`),i}get keys(){return ne(this.instructions.length===1),this.instructions[0].keys.map(e=>e.pubkey)}get programId(){return ne(this.instructions.length===1),this.instructions[0].programId}get data(){return ne(this.instructions.length===1),this.instructions[0].data}static from(e){let t=[...e];const r=xe(t);let s=[];for(let i=0;i<r;i++){const o=t.slice(0,Zr);t=t.slice(Zr),s.push(J.encode(H.Buffer.from(o)))}return Xe.populate(rt.from(t),s)}static populate(e,t=[]){const r=new Xe;return r.recentBlockhash=e.recentBlockhash,e.header.numRequiredSignatures>0&&(r.feePayer=e.accountKeys[0]),t.forEach((s,i)=>{const o={signature:s==J.encode(Sc)?null:J.decode(s),publicKey:e.accountKeys[i]};r.signatures.push(o)}),e.instructions.forEach(s=>{const i=s.accounts.map(o=>{const a=e.accountKeys[o];return{pubkey:a,isSigner:r.signatures.some(c=>c.publicKey.toString()===a.toString())||e.isAccountSigner(o),isWritable:e.isAccountWritable(o)}});r.instructions.push(new jn({keys:i,programId:e.accountKeys[s.programIdIndex],data:J.decode(s.data)}))}),r._message=e,r._json=r.toJSON(),r}}new $("SysvarC1ock11111111111111111111111111111111");new $("SysvarEpochSchedu1e111111111111111111111111");new $("Sysvar1nstructions1111111111111111111111111");new $("SysvarRecentB1ockHashes11111111111111111111");new $("SysvarRent111111111111111111111111111111111");new $("SysvarRewards111111111111111111111111111111");new $("SysvarS1otHashes111111111111111111111111111");new $("SysvarS1otHistory11111111111111111111111111");new $("SysvarStakeHistory1111111111111111111111111");function bt(n){return new Promise(e=>setTimeout(e,n))}const kc=ae("lamportsPerSignature"),gi=O([N("version"),N("state"),D("authorizedPubkey"),D("nonce"),O([kc],"feeCalculator")]);gi.span;class An{constructor(e){this.authorizedPubkey=void 0,this.nonce=void 0,this.feeCalculator=void 0,this.authorizedPubkey=e.authorizedPubkey,this.nonce=e.nonce,this.feeCalculator=e.feeCalculator}static fromAccountData(e){const t=gi.decode(At(e),0);return new An({authorizedPubkey:new $(t.authorizedPubkey),nonce:new $(t.nonce).toString(),feeCalculator:t.feeCalculator})}}const Ac=n=>{const e=n.decode.bind(n),t=n.encode.bind(n);return{decode:e,encode:t}},xc=n=>e=>{const t=re(n,e),{encode:r,decode:s}=Ac(t),i=t;return i.decode=(o,a)=>{const c=s(o,a);return ha(H.Buffer.from(c))},i.encode=(o,a,c)=>{const u=ga(o,n);return r(u,a,c)},i},xt=xc(8);Object.freeze({Create:{index:0,layout:O([N("instruction"),be("lamports"),be("space"),D("programId")])},Assign:{index:1,layout:O([N("instruction"),D("programId")])},Transfer:{index:2,layout:O([N("instruction"),xt("lamports")])},CreateWithSeed:{index:3,layout:O([N("instruction"),D("base"),vt("seed"),be("lamports"),be("space"),D("programId")])},AdvanceNonceAccount:{index:4,layout:O([N("instruction")])},WithdrawNonceAccount:{index:5,layout:O([N("instruction"),be("lamports")])},InitializeNonceAccount:{index:6,layout:O([N("instruction"),D("authorized")])},AuthorizeNonceAccount:{index:7,layout:O([N("instruction"),D("authorized")])},Allocate:{index:8,layout:O([N("instruction"),be("space")])},AllocateWithSeed:{index:9,layout:O([N("instruction"),D("base"),vt("seed"),be("space"),D("programId")])},AssignWithSeed:{index:10,layout:O([N("instruction"),D("base"),vt("seed"),D("programId")])},TransferWithSeed:{index:11,layout:O([N("instruction"),xt("lamports"),vt("seed"),D("programId")])},UpgradeNonceAccount:{index:12,layout:O([N("instruction")])}});new $("11111111111111111111111111111111");new $("BPFLoader2111111111111111111111111111111111");var _c=Object.prototype.toString,Ec=Object.keys||function(n){var e=[];for(var t in n)e.push(t);return e};function Pt(n,e){var t,r,s,i,o,a,c;if(n===!0)return"true";if(n===!1)return"false";switch(typeof n){case"object":if(n===null)return null;if(n.toJSON&&typeof n.toJSON=="function")return Pt(n.toJSON(),e);if(c=_c.call(n),c==="[object Array]"){for(s="[",r=n.length-1,t=0;t<r;t++)s+=Pt(n[t],!0)+",";return r>-1&&(s+=Pt(n[t],!0)),s+"]"}else if(c==="[object Object]"){for(i=Ec(n).sort(),r=i.length,s="",t=0;t<r;)o=i[t],a=Pt(n[o],!1),a!==void 0&&(s&&(s+=","),s+=JSON.stringify(o)+":"+a),t++;return"{"+s+"}"}else return JSON.stringify(n);case"function":case"undefined":return e?null:void 0;case"string":return JSON.stringify(n);default:return isFinite(n)?n:null}}var Ic=function(n){var e=Pt(n,!1);if(e!==void 0)return""+e},Wn=Ic;const Ct=32;function qr(n){let e=0;for(;n>1;)n/=2,e++;return e}function Bc(n){return n===0?1:(n--,n|=n>>1,n|=n>>2,n|=n>>4,n|=n>>8,n|=n>>16,n|=n>>32,n+1)}class Rc{constructor(e,t,r,s,i){this.slotsPerEpoch=void 0,this.leaderScheduleSlotOffset=void 0,this.warmup=void 0,this.firstNormalEpoch=void 0,this.firstNormalSlot=void 0,this.slotsPerEpoch=e,this.leaderScheduleSlotOffset=t,this.warmup=r,this.firstNormalEpoch=s,this.firstNormalSlot=i}getEpoch(e){return this.getEpochAndSlotIndex(e)[0]}getEpochAndSlotIndex(e){if(e<this.firstNormalSlot){const t=qr(Bc(e+Ct+1))-qr(Ct)-1,r=this.getSlotsInEpoch(t),s=e-(r-Ct);return[t,s]}else{const t=e-this.firstNormalSlot,r=Math.floor(t/this.slotsPerEpoch),s=this.firstNormalEpoch+r,i=t%this.slotsPerEpoch;return[s,i]}}getFirstSlotInEpoch(e){return e<=this.firstNormalEpoch?(Math.pow(2,e)-1)*Ct:(e-this.firstNormalEpoch)*this.slotsPerEpoch+this.firstNormalSlot}getLastSlotInEpoch(e){return this.getFirstSlotInEpoch(e)+this.getSlotsInEpoch(e)-1}getSlotsInEpoch(e){return e<this.firstNormalEpoch?Math.pow(2,e+qr(Ct)):this.slotsPerEpoch}}class Gn extends Error{constructor(e,t){super(e),this.logs=void 0,this.logs=t}}class U extends Error{constructor({code:e,message:t,data:r},s){super(s!=null?`${s}: ${t}`:t),this.code=void 0,this.data=void 0,this.code=e,this.data=r,this.name="SolanaJSONRPCError"}}var Cc=globalThis.fetch;class Tc extends rc{constructor(e,t,r){const s=i=>{const o=nc(i,{autoconnect:!0,max_reconnects:5,reconnect:!0,reconnect_interval:1e3,...t});return"socket"in o?this.underlyingSocket=o.socket:this.underlyingSocket=o,o};super(s,e,t,r),this.underlyingSocket=void 0}call(...e){var r;const t=(r=this.underlyingSocket)==null?void 0:r.readyState;return t===1?super.call(...e):Promise.reject(new Error("Tried to call a JSON-RPC method `"+e[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+t+")"))}notify(...e){var r;const t=(r=this.underlyingSocket)==null?void 0:r.readyState;return t===1?super.notify(...e):Promise.reject(new Error("Tried to send a JSON-RPC notification `"+e[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+t+")"))}}const Pc=160,Lc=64,Oc=Pc/Lc,Uc=1e3/Oc;function Nc(n,e){let t;try{t=n.layout.decode(e)}catch(r){throw new Error("invalid instruction; "+r)}if(t.typeIndex!==n.index)throw new Error(`invalid account data; account type mismatch ${t.typeIndex} != ${n.index}`);return t}const Vn=56;class Jn{constructor(e){this.key=void 0,this.state=void 0,this.key=e.key,this.state=e.state}isActive(){const e=BigInt("0xffffffffffffffff");return this.state.deactivationSlot===e}static deserialize(e){const t=Nc($c,e),r=e.length-Vn;ne(r>=0,"lookup table is invalid"),ne(r%32===0,"lookup table is invalid");const s=r/32,{addresses:i}=O([ge(D(),s,"addresses")]).decode(e.slice(Vn));return{deactivationSlot:t.deactivationSlot,lastExtendedSlot:t.lastExtendedSlot,lastExtendedSlotStartIndex:t.lastExtendedStartIndex,authority:t.authority.length!==0?new $(t.authority[0]):void 0,addresses:i.map(o=>new $(o))}}}const $c={index:1,layout:O([N("typeIndex"),xt("deactivationSlot"),ae("lastExtendedSlot"),V("lastExtendedStartIndex"),V(),ge(D(),ct(V(),-1),"authority")])},Fc=/^[^:]+:\/\/([^:[]+|\[[^\]]+\])(:\d+)?(.*)/i;function Mc(n){const e=n.match(Fc);if(e==null)throw TypeError(`Failed to validate endpoint URL \`${n}\``);const[t,r,s,i]=e,o=n.startsWith("https:")?"wss:":"ws:",a=s==null?null:parseInt(s.slice(1),10),c=a==null?"":`:${a+1}`;return`${o}//${r}${c}${i}`}const ie=Gt(Sn($),E(),n=>new $(n)),yi=kn([E(),ee("base64")]),xn=Gt(Sn(H.Buffer),yi,n=>H.Buffer.from(n[0],"base64")),Kc=30*1e3;function qc(n){if(/^https?:/.test(n)===!1)throw new TypeError("Endpoint URL must start with `http:` or `https:`.");return n}function Q(n){let e,t;if(typeof n=="string")e=n;else if(n){const{commitment:r,...s}=n;e=r,t=s}return{commitment:e,config:t}}function mi(n){return we([_({jsonrpc:ee("2.0"),id:E(),result:n}),_({jsonrpc:ee("2.0"),id:E(),error:_({code:Wt(),message:E(),data:M(Aa())})})])}const Hc=mi(Wt());function q(n){return Gt(mi(n),Hc,e=>"error"in e?e:{...e,result:I(e.result,n)})}function se(n){return q(_({context:_({slot:m()}),value:n}))}function Er(n){return _({context:_({slot:m()}),value:n})}function Hr(n,e){return n===0?new dr({header:e.header,staticAccountKeys:e.accountKeys.map(t=>new $(t)),recentBlockhash:e.recentBlockhash,compiledInstructions:e.instructions.map(t=>({programIdIndex:t.programIdIndex,accountKeyIndexes:t.accounts,data:J.decode(t.data)})),addressTableLookups:e.addressTableLookups}):new rt(e)}const Dc=_({foundation:m(),foundationTerm:m(),initial:m(),taper:m(),terminal:m()}),zc=q(B(R(_({epoch:m(),effectiveSlot:m(),amount:m(),postBalance:m(),commission:M(R(m()))})))),jc=B(_({slot:m(),prioritizationFee:m()})),Wc=_({total:m(),validator:m(),foundation:m(),epoch:m()}),Gc=_({epoch:m(),slotIndex:m(),slotsInEpoch:m(),absoluteSlot:m(),blockHeight:M(m()),transactionCount:M(m())}),Vc=_({slotsPerEpoch:m(),leaderScheduleSlotOffset:m(),warmup:qe(),firstNormalEpoch:m(),firstNormalSlot:m()}),Jc=js(E(),B(m())),gt=R(we([_({}),E()])),Zc=_({err:gt}),Xc=ee("receivedSignature"),Yc=_({"solana-core":E(),"feature-set":M(m())}),Zn=se(_({err:R(we([_({}),E()])),logs:R(B(E())),accounts:M(R(B(R(_({executable:qe(),owner:E(),lamports:m(),data:B(E()),rentEpoch:M(m())}))))),unitsConsumed:M(m()),returnData:M(R(_({programId:E(),data:kn([E(),ee("base64")])})))})),Qc=se(_({byIdentity:js(E(),B(m())),range:_({firstSlot:m(),lastSlot:m()})}));function eu(n,e,t,r,s,i){const o=t||Cc;let a;i!=null&&console.warn("You have supplied an `httpAgent` when creating a `Connection` in a browser environment.It has been ignored; `httpAgent` is only used in Node environments.");let c;return r&&(c=async(l,f)=>{const p=await new Promise((h,d)=>{try{r(l,f,(y,g)=>h([y,g]))}catch(y){d(y)}});return await o(...p)}),new Xa(async(l,f)=>{const p={method:"POST",body:l,agent:a,headers:Object.assign({"Content-Type":"application/json"},e||{},el)};try{let h=5,d,y=500;for(;c?d=await c(n,p):d=await o(n,p),!(d.status!==429||s===!0||(h-=1,h===0));)console.log(`Server responded with ${d.status} ${d.statusText}.  Retrying after ${y}ms delay...`),await bt(y),y*=2;const g=await d.text();d.ok?f(null,g):f(new Error(`${d.status} ${d.statusText}: ${g}`))}catch(h){h instanceof Error&&f(h)}},{})}function tu(n){return(e,t)=>new Promise((r,s)=>{n.request(e,t,(i,o)=>{if(i){s(i);return}r(o)})})}function ru(n){return e=>new Promise((t,r)=>{e.length===0&&t([]);const s=e.map(i=>n.request(i.methodName,i.args));n.request(s,(i,o)=>{if(i){r(i);return}t(o)})})}const nu=q(Dc),su=q(Wc),iu=q(jc),ou=q(Gc),au=q(Vc),cu=q(Jc),uu=q(m()),lu=se(_({total:m(),circulating:m(),nonCirculating:m(),nonCirculatingAccounts:B(ie)})),Xr=_({amount:E(),uiAmount:R(m()),decimals:m(),uiAmountString:M(E())}),fu=se(B(_({address:ie,amount:E(),uiAmount:R(m()),decimals:m(),uiAmountString:M(E())}))),hu=se(B(_({pubkey:ie,account:_({executable:qe(),owner:ie,lamports:m(),data:xn,rentEpoch:m()})}))),Yr=_({program:E(),parsed:Wt(),space:m()}),du=se(B(_({pubkey:ie,account:_({executable:qe(),owner:ie,lamports:m(),data:Yr,rentEpoch:m()})}))),pu=se(B(_({lamports:m(),address:ie}))),Mt=_({executable:qe(),owner:ie,lamports:m(),data:xn,rentEpoch:m()}),gu=_({pubkey:ie,account:Mt}),yu=Gt(we([Sn(H.Buffer),Yr]),we([yi,Yr]),n=>Array.isArray(n)?I(n,xn):n),Qr=_({executable:qe(),owner:ie,lamports:m(),data:yu,rentEpoch:m()}),mu=_({pubkey:ie,account:Qr}),wu=_({state:we([ee("active"),ee("inactive"),ee("activating"),ee("deactivating")]),active:m(),inactive:m()}),bu=q(B(_({signature:E(),slot:m(),err:gt,memo:R(E()),blockTime:M(R(m()))}))),vu=q(B(_({signature:E(),slot:m(),err:gt,memo:R(E()),blockTime:M(R(m()))}))),Su=_({subscription:m(),result:Er(Mt)}),ku=_({pubkey:ie,account:Mt}),Au=_({subscription:m(),result:Er(ku)}),xu=_({parent:m(),slot:m(),root:m()}),_u=_({subscription:m(),result:xu}),Eu=we([_({type:we([ee("firstShredReceived"),ee("completed"),ee("optimisticConfirmation"),ee("root")]),slot:m(),timestamp:m()}),_({type:ee("createdBank"),parent:m(),slot:m(),timestamp:m()}),_({type:ee("frozen"),slot:m(),timestamp:m(),stats:_({numTransactionEntries:m(),numSuccessfulTransactions:m(),numFailedTransactions:m(),maxTransactionsPerEntry:m()})}),_({type:ee("dead"),slot:m(),timestamp:m(),err:E()})]),Iu=_({subscription:m(),result:Eu}),Bu=_({subscription:m(),result:Er(we([Zc,Xc]))}),Ru=_({subscription:m(),result:m()}),Cu=_({pubkey:E(),gossip:R(E()),tpu:R(E()),rpc:R(E()),version:R(E())}),Xn=_({votePubkey:E(),nodePubkey:E(),activatedStake:m(),epochVoteAccount:qe(),epochCredits:B(kn([m(),m(),m()])),commission:m(),lastVote:m(),rootSlot:R(m())}),Tu=q(_({current:B(Xn),delinquent:B(Xn)})),Pu=we([ee("processed"),ee("confirmed"),ee("finalized")]),Lu=_({slot:m(),confirmations:R(m()),err:gt,confirmationStatus:M(Pu)}),Ou=se(B(R(Lu))),Uu=q(m()),wi=_({accountKey:ie,writableIndexes:B(m()),readonlyIndexes:B(m())}),_n=_({signatures:B(E()),message:_({accountKeys:B(E()),header:_({numRequiredSignatures:m(),numReadonlySignedAccounts:m(),numReadonlyUnsignedAccounts:m()}),instructions:B(_({accounts:B(m()),data:E(),programIdIndex:m()})),recentBlockhash:E(),addressTableLookups:M(B(wi))})}),bi=_({pubkey:ie,signer:qe(),writable:qe(),source:M(we([ee("transaction"),ee("lookupTable")]))}),vi=_({accountKeys:B(bi),signatures:B(E())}),Si=_({parsed:Wt(),program:E(),programId:ie}),ki=_({accounts:B(ie),data:E(),programId:ie}),Nu=we([ki,Si]),$u=we([_({parsed:Wt(),program:E(),programId:E()}),_({accounts:B(E()),data:E(),programId:E()})]),Ai=Gt(Nu,$u,n=>"accounts"in n?I(n,ki):I(n,Si)),xi=_({signatures:B(E()),message:_({accountKeys:B(bi),instructions:B(Ai),recentBlockhash:E(),addressTableLookups:M(R(B(wi)))})}),pr=_({accountIndex:m(),mint:E(),owner:M(E()),uiTokenAmount:Xr}),_i=_({writable:B(ie),readonly:B(ie)}),Ir=_({err:gt,fee:m(),innerInstructions:M(R(B(_({index:m(),instructions:B(_({accounts:B(m()),data:E(),programIdIndex:m()}))})))),preBalances:B(m()),postBalances:B(m()),logMessages:M(R(B(E()))),preTokenBalances:M(R(B(pr))),postTokenBalances:M(R(B(pr))),loadedAddresses:M(_i),computeUnitsConsumed:M(m())}),En=_({err:gt,fee:m(),innerInstructions:M(R(B(_({index:m(),instructions:B(Ai)})))),preBalances:B(m()),postBalances:B(m()),logMessages:M(R(B(E()))),preTokenBalances:M(R(B(pr))),postTokenBalances:M(R(B(pr))),loadedAddresses:M(_i),computeUnitsConsumed:M(m())}),Bt=we([ee(0),ee("legacy")]),yt=_({pubkey:E(),lamports:m(),postBalance:R(m()),rewardType:R(E()),commission:M(R(m()))}),Fu=q(R(_({blockhash:E(),previousBlockhash:E(),parentSlot:m(),transactions:B(_({transaction:_n,meta:R(Ir),version:M(Bt)})),rewards:M(B(yt)),blockTime:R(m()),blockHeight:R(m())}))),Mu=q(R(_({blockhash:E(),previousBlockhash:E(),parentSlot:m(),rewards:M(B(yt)),blockTime:R(m()),blockHeight:R(m())}))),Ku=q(R(_({blockhash:E(),previousBlockhash:E(),parentSlot:m(),transactions:B(_({transaction:vi,meta:R(Ir),version:M(Bt)})),rewards:M(B(yt)),blockTime:R(m()),blockHeight:R(m())}))),qu=q(R(_({blockhash:E(),previousBlockhash:E(),parentSlot:m(),transactions:B(_({transaction:xi,meta:R(En),version:M(Bt)})),rewards:M(B(yt)),blockTime:R(m()),blockHeight:R(m())}))),Hu=q(R(_({blockhash:E(),previousBlockhash:E(),parentSlot:m(),transactions:B(_({transaction:vi,meta:R(En),version:M(Bt)})),rewards:M(B(yt)),blockTime:R(m()),blockHeight:R(m())}))),Du=q(R(_({blockhash:E(),previousBlockhash:E(),parentSlot:m(),rewards:M(B(yt)),blockTime:R(m()),blockHeight:R(m())}))),zu=q(R(_({blockhash:E(),previousBlockhash:E(),parentSlot:m(),transactions:B(_({transaction:_n,meta:R(Ir)})),rewards:M(B(yt)),blockTime:R(m())}))),Yn=q(R(_({blockhash:E(),previousBlockhash:E(),parentSlot:m(),signatures:B(E()),blockTime:R(m())}))),Dr=q(R(_({slot:m(),meta:Ir,blockTime:M(R(m())),transaction:_n,version:M(Bt)}))),Yt=q(R(_({slot:m(),transaction:xi,meta:R(En),blockTime:M(R(m())),version:M(Bt)}))),ju=se(_({blockhash:E(),feeCalculator:_({lamportsPerSignature:m()})})),Wu=se(_({blockhash:E(),lastValidBlockHeight:m()})),Gu=_({slot:m(),numTransactions:m(),numSlots:m(),samplePeriodSecs:m()}),Vu=q(B(Gu)),Ju=se(R(_({feeCalculator:_({lamportsPerSignature:m()})}))),Zu=q(E()),Xu=q(E()),Yu=_({err:gt,logs:B(E()),signature:E()}),Qu=_({result:Er(Yu),subscription:m()}),el={"solana-client":"js/0.0.0-development"};class In{constructor(e,t){this._commitment=void 0,this._confirmTransactionInitialTimeout=void 0,this._rpcEndpoint=void 0,this._rpcWsEndpoint=void 0,this._rpcClient=void 0,this._rpcRequest=void 0,this._rpcBatchRequest=void 0,this._rpcWebSocket=void 0,this._rpcWebSocketConnected=!1,this._rpcWebSocketHeartbeat=null,this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketGeneration=0,this._disableBlockhashCaching=!1,this._pollingBlockhash=!1,this._blockhashInfo={latestBlockhash:null,lastFetch:0,transactionSignatures:[],simulatedSignatures:[]},this._nextClientSubscriptionId=0,this._subscriptionDisposeFunctionsByClientSubscriptionId={},this._subscriptionHashByClientSubscriptionId={},this._subscriptionStateChangeCallbacksByHash={},this._subscriptionCallbacksByServerSubscriptionId={},this._subscriptionsByHash={},this._subscriptionsAutoDisposedByRpc=new Set,this.getBlockHeight=(()=>{const u={};return async l=>{const{commitment:f,config:p}=Q(l),h=this._buildArgs([],f,void 0,p),d=Wn(h);return u[d]=u[d]??(async()=>{try{const y=await this._rpcRequest("getBlockHeight",h),g=I(y,q(m()));if("error"in g)throw new U(g.error,"failed to get block height information");return g.result}finally{delete u[d]}})(),await u[d]}})();let r,s,i,o,a,c;t&&typeof t=="string"?this._commitment=t:t&&(this._commitment=t.commitment,this._confirmTransactionInitialTimeout=t.confirmTransactionInitialTimeout,r=t.wsEndpoint,s=t.httpHeaders,i=t.fetch,o=t.fetchMiddleware,a=t.disableRetryOnRateLimit,c=t.httpAgent),this._rpcEndpoint=qc(e),this._rpcWsEndpoint=r||Mc(e),this._rpcClient=eu(e,s,i,o,a,c),this._rpcRequest=tu(this._rpcClient),this._rpcBatchRequest=ru(this._rpcClient),this._rpcWebSocket=new Tc(this._rpcWsEndpoint,{autoconnect:!1,max_reconnects:1/0}),this._rpcWebSocket.on("open",this._wsOnOpen.bind(this)),this._rpcWebSocket.on("error",this._wsOnError.bind(this)),this._rpcWebSocket.on("close",this._wsOnClose.bind(this)),this._rpcWebSocket.on("accountNotification",this._wsOnAccountNotification.bind(this)),this._rpcWebSocket.on("programNotification",this._wsOnProgramAccountNotification.bind(this)),this._rpcWebSocket.on("slotNotification",this._wsOnSlotNotification.bind(this)),this._rpcWebSocket.on("slotsUpdatesNotification",this._wsOnSlotUpdatesNotification.bind(this)),this._rpcWebSocket.on("signatureNotification",this._wsOnSignatureNotification.bind(this)),this._rpcWebSocket.on("rootNotification",this._wsOnRootNotification.bind(this)),this._rpcWebSocket.on("logsNotification",this._wsOnLogsNotification.bind(this))}get commitment(){return this._commitment}get rpcEndpoint(){return this._rpcEndpoint}async getBalanceAndContext(e,t){const{commitment:r,config:s}=Q(t),i=this._buildArgs([e.toBase58()],r,void 0,s),o=await this._rpcRequest("getBalance",i),a=I(o,se(m()));if("error"in a)throw new U(a.error,`failed to get balance for ${e.toBase58()}`);return a.result}async getBalance(e,t){return await this.getBalanceAndContext(e,t).then(r=>r.value).catch(r=>{throw new Error("failed to get balance of account "+e.toBase58()+": "+r)})}async getBlockTime(e){const t=await this._rpcRequest("getBlockTime",[e]),r=I(t,q(R(m())));if("error"in r)throw new U(r.error,`failed to get block time for slot ${e}`);return r.result}async getMinimumLedgerSlot(){const e=await this._rpcRequest("minimumLedgerSlot",[]),t=I(e,q(m()));if("error"in t)throw new U(t.error,"failed to get minimum ledger slot");return t.result}async getFirstAvailableBlock(){const e=await this._rpcRequest("getFirstAvailableBlock",[]),t=I(e,uu);if("error"in t)throw new U(t.error,"failed to get first available block");return t.result}async getSupply(e){let t={};typeof e=="string"?t={commitment:e}:e?t={...e,commitment:e&&e.commitment||this.commitment}:t={commitment:this.commitment};const r=await this._rpcRequest("getSupply",[t]),s=I(r,lu);if("error"in s)throw new U(s.error,"failed to get supply");return s.result}async getTokenSupply(e,t){const r=this._buildArgs([e.toBase58()],t),s=await this._rpcRequest("getTokenSupply",r),i=I(s,se(Xr));if("error"in i)throw new U(i.error,"failed to get token supply");return i.result}async getTokenAccountBalance(e,t){const r=this._buildArgs([e.toBase58()],t),s=await this._rpcRequest("getTokenAccountBalance",r),i=I(s,se(Xr));if("error"in i)throw new U(i.error,"failed to get token account balance");return i.result}async getTokenAccountsByOwner(e,t,r){const{commitment:s,config:i}=Q(r);let o=[e.toBase58()];"mint"in t?o.push({mint:t.mint.toBase58()}):o.push({programId:t.programId.toBase58()});const a=this._buildArgs(o,s,"base64",i),c=await this._rpcRequest("getTokenAccountsByOwner",a),u=I(c,hu);if("error"in u)throw new U(u.error,`failed to get token accounts owned by account ${e.toBase58()}`);return u.result}async getParsedTokenAccountsByOwner(e,t,r){let s=[e.toBase58()];"mint"in t?s.push({mint:t.mint.toBase58()}):s.push({programId:t.programId.toBase58()});const i=this._buildArgs(s,r,"jsonParsed"),o=await this._rpcRequest("getTokenAccountsByOwner",i),a=I(o,du);if("error"in a)throw new U(a.error,`failed to get token accounts owned by account ${e.toBase58()}`);return a.result}async getLargestAccounts(e){const t={...e,commitment:e&&e.commitment||this.commitment},r=t.filter||t.commitment?[t]:[],s=await this._rpcRequest("getLargestAccounts",r),i=I(s,pu);if("error"in i)throw new U(i.error,"failed to get largest accounts");return i.result}async getTokenLargestAccounts(e,t){const r=this._buildArgs([e.toBase58()],t),s=await this._rpcRequest("getTokenLargestAccounts",r),i=I(s,fu);if("error"in i)throw new U(i.error,"failed to get token largest accounts");return i.result}async getAccountInfoAndContext(e,t){const{commitment:r,config:s}=Q(t),i=this._buildArgs([e.toBase58()],r,"base64",s),o=await this._rpcRequest("getAccountInfo",i),a=I(o,se(R(Mt)));if("error"in a)throw new U(a.error,`failed to get info about account ${e.toBase58()}`);return a.result}async getParsedAccountInfo(e,t){const{commitment:r,config:s}=Q(t),i=this._buildArgs([e.toBase58()],r,"jsonParsed",s),o=await this._rpcRequest("getAccountInfo",i),a=I(o,se(R(Qr)));if("error"in a)throw new U(a.error,`failed to get info about account ${e.toBase58()}`);return a.result}async getAccountInfo(e,t){try{return(await this.getAccountInfoAndContext(e,t)).value}catch(r){throw new Error("failed to get info about account "+e.toBase58()+": "+r)}}async getMultipleParsedAccounts(e,t){const{commitment:r,config:s}=Q(t),i=e.map(u=>u.toBase58()),o=this._buildArgs([i],r,"jsonParsed",s),a=await this._rpcRequest("getMultipleAccounts",o),c=I(a,se(B(R(Qr))));if("error"in c)throw new U(c.error,`failed to get info for accounts ${i}`);return c.result}async getMultipleAccountsInfoAndContext(e,t){const{commitment:r,config:s}=Q(t),i=e.map(u=>u.toBase58()),o=this._buildArgs([i],r,"base64",s),a=await this._rpcRequest("getMultipleAccounts",o),c=I(a,se(B(R(Mt))));if("error"in c)throw new U(c.error,`failed to get info for accounts ${i}`);return c.result}async getMultipleAccountsInfo(e,t){return(await this.getMultipleAccountsInfoAndContext(e,t)).value}async getStakeActivation(e,t,r){const{commitment:s,config:i}=Q(t),o=this._buildArgs([e.toBase58()],s,void 0,{...i,epoch:r??(i==null?void 0:i.epoch)}),a=await this._rpcRequest("getStakeActivation",o),c=I(a,q(wu));if("error"in c)throw new U(c.error,`failed to get Stake Activation ${e.toBase58()}`);return c.result}async getProgramAccounts(e,t){const{commitment:r,config:s}=Q(t),{encoding:i,...o}=s||{},a=this._buildArgs([e.toBase58()],r,i||"base64",o),c=await this._rpcRequest("getProgramAccounts",a),u=I(c,q(B(gu)));if("error"in u)throw new U(u.error,`failed to get accounts owned by program ${e.toBase58()}`);return u.result}async getParsedProgramAccounts(e,t){const{commitment:r,config:s}=Q(t),i=this._buildArgs([e.toBase58()],r,"jsonParsed",s),o=await this._rpcRequest("getProgramAccounts",i),a=I(o,q(B(mu)));if("error"in a)throw new U(a.error,`failed to get accounts owned by program ${e.toBase58()}`);return a.result}async confirmTransaction(e,t){var i;let r;if(typeof e=="string")r=e;else{const o=e;if((i=o.abortSignal)!=null&&i.aborted)return Promise.reject(o.abortSignal.reason);r=o.signature}let s;try{s=J.decode(r)}catch{throw new Error("signature must be base58 encoded: "+r)}return ne(s.length===64,"signature has invalid length"),typeof e=="string"?await this.confirmTransactionUsingLegacyTimeoutStrategy({commitment:t||this.commitment,signature:r}):"lastValidBlockHeight"in e?await this.confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:t||this.commitment,strategy:e}):await this.confirmTransactionUsingDurableNonceStrategy({commitment:t||this.commitment,strategy:e})}getCancellationPromise(e){return new Promise((t,r)=>{e!=null&&(e.aborted?r(e.reason):e.addEventListener("abort",()=>{r(e.reason)}))})}getTransactionConfirmationPromise({commitment:e,signature:t}){let r,s,i=!1;const o=new Promise((c,u)=>{try{r=this.onSignature(t,(f,p)=>{r=void 0;const h={context:p,value:f};c({__type:Pe.PROCESSED,response:h})},e);const l=new Promise(f=>{r==null?f():s=this._onSubscriptionStateChange(r,p=>{p==="subscribed"&&f()})});(async()=>{if(await l,i)return;const f=await this.getSignatureStatus(t);if(i||f==null)return;const{context:p,value:h}=f;if(h!=null)if(h!=null&&h.err)u(h.err);else{switch(e){case"confirmed":case"single":case"singleGossip":{if(h.confirmationStatus==="processed")return;break}case"finalized":case"max":case"root":{if(h.confirmationStatus==="processed"||h.confirmationStatus==="confirmed")return;break}case"processed":case"recent":}i=!0,c({__type:Pe.PROCESSED,response:{context:p,value:h}})}})()}catch(l){u(l)}});return{abortConfirmation:()=>{s&&(s(),s=void 0),r!=null&&(this.removeSignatureListener(r),r=void 0)},confirmationPromise:o}}async confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:e,strategy:{abortSignal:t,lastValidBlockHeight:r,signature:s}}){let i=!1;const o=new Promise(f=>{const p=async()=>{try{return await this.getBlockHeight(e)}catch{return-1}};(async()=>{let h=await p();if(!i){for(;h<=r;)if(await bt(1e3),i||(h=await p(),i))return;f({__type:Pe.BLOCKHEIGHT_EXCEEDED})}})()}),{abortConfirmation:a,confirmationPromise:c}=this.getTransactionConfirmationPromise({commitment:e,signature:s}),u=this.getCancellationPromise(t);let l;try{const f=await Promise.race([u,c,o]);if(f.__type===Pe.PROCESSED)l=f.response;else throw new di(s)}finally{i=!0,a()}return l}async confirmTransactionUsingDurableNonceStrategy({commitment:e,strategy:{abortSignal:t,minContextSlot:r,nonceAccountPubkey:s,nonceValue:i,signature:o}}){let a=!1;const c=new Promise(h=>{let d=i,y=null;const g=async()=>{try{const{context:k,value:v}=await this.getNonceAndContext(s,{commitment:e,minContextSlot:r});return y=k.slot,v==null?void 0:v.nonce}catch{return d}};(async()=>{if(d=await g(),!a)for(;;){if(i!==d){h({__type:Pe.NONCE_INVALID,slotInWhichNonceDidAdvance:y});return}if(await bt(2e3),a||(d=await g(),a))return}})()}),{abortConfirmation:u,confirmationPromise:l}=this.getTransactionConfirmationPromise({commitment:e,signature:o}),f=this.getCancellationPromise(t);let p;try{const h=await Promise.race([f,l,c]);if(h.__type===Pe.PROCESSED)p=h.response;else{let d;for(;;){const y=await this.getSignatureStatus(o);if(y==null)break;if(y.context.slot<(h.slotInWhichNonceDidAdvance??r)){await bt(400);continue}d=y;break}if(d!=null&&d.value){const y=e||"finalized",{confirmationStatus:g}=d.value;switch(y){case"processed":case"recent":if(g!=="processed"&&g!=="confirmed"&&g!=="finalized")throw new Tt(o);break;case"confirmed":case"single":case"singleGossip":if(g!=="confirmed"&&g!=="finalized")throw new Tt(o);break;case"finalized":case"max":case"root":if(g!=="finalized")throw new Tt(o);break;default:(k=>{})(y)}p={context:d.context,value:{err:d.value.err}}}else throw new Tt(o)}}finally{a=!0,u()}return p}async confirmTransactionUsingLegacyTimeoutStrategy({commitment:e,signature:t}){let r;const s=new Promise(c=>{let u=this._confirmTransactionInitialTimeout||6e4;switch(e){case"processed":case"recent":case"single":case"confirmed":case"singleGossip":{u=this._confirmTransactionInitialTimeout||3e4;break}}r=setTimeout(()=>c({__type:Pe.TIMED_OUT,timeoutMs:u}),u)}),{abortConfirmation:i,confirmationPromise:o}=this.getTransactionConfirmationPromise({commitment:e,signature:t});let a;try{const c=await Promise.race([o,s]);if(c.__type===Pe.PROCESSED)a=c.response;else throw new pi(t,c.timeoutMs/1e3)}finally{clearTimeout(r),i()}return a}async getClusterNodes(){const e=await this._rpcRequest("getClusterNodes",[]),t=I(e,q(B(Cu)));if("error"in t)throw new U(t.error,"failed to get cluster nodes");return t.result}async getVoteAccounts(e){const t=this._buildArgs([],e),r=await this._rpcRequest("getVoteAccounts",t),s=I(r,Tu);if("error"in s)throw new U(s.error,"failed to get vote accounts");return s.result}async getSlot(e){const{commitment:t,config:r}=Q(e),s=this._buildArgs([],t,void 0,r),i=await this._rpcRequest("getSlot",s),o=I(i,q(m()));if("error"in o)throw new U(o.error,"failed to get slot");return o.result}async getSlotLeader(e){const{commitment:t,config:r}=Q(e),s=this._buildArgs([],t,void 0,r),i=await this._rpcRequest("getSlotLeader",s),o=I(i,q(E()));if("error"in o)throw new U(o.error,"failed to get slot leader");return o.result}async getSlotLeaders(e,t){const r=[e,t],s=await this._rpcRequest("getSlotLeaders",r),i=I(s,q(B(ie)));if("error"in i)throw new U(i.error,"failed to get slot leaders");return i.result}async getSignatureStatus(e,t){const{context:r,value:s}=await this.getSignatureStatuses([e],t);ne(s.length===1);const i=s[0];return{context:r,value:i}}async getSignatureStatuses(e,t){const r=[e];t&&r.push(t);const s=await this._rpcRequest("getSignatureStatuses",r),i=I(s,Ou);if("error"in i)throw new U(i.error,"failed to get signature status");return i.result}async getTransactionCount(e){const{commitment:t,config:r}=Q(e),s=this._buildArgs([],t,void 0,r),i=await this._rpcRequest("getTransactionCount",s),o=I(i,q(m()));if("error"in o)throw new U(o.error,"failed to get transaction count");return o.result}async getTotalSupply(e){return(await this.getSupply({commitment:e,excludeNonCirculatingAccountsList:!0})).value.total}async getInflationGovernor(e){const t=this._buildArgs([],e),r=await this._rpcRequest("getInflationGovernor",t),s=I(r,nu);if("error"in s)throw new U(s.error,"failed to get inflation");return s.result}async getInflationReward(e,t,r){const{commitment:s,config:i}=Q(r),o=this._buildArgs([e.map(u=>u.toBase58())],s,void 0,{...i,epoch:t??(i==null?void 0:i.epoch)}),a=await this._rpcRequest("getInflationReward",o),c=I(a,zc);if("error"in c)throw new U(c.error,"failed to get inflation reward");return c.result}async getInflationRate(){const e=await this._rpcRequest("getInflationRate",[]),t=I(e,su);if("error"in t)throw new U(t.error,"failed to get inflation rate");return t.result}async getEpochInfo(e){const{commitment:t,config:r}=Q(e),s=this._buildArgs([],t,void 0,r),i=await this._rpcRequest("getEpochInfo",s),o=I(i,ou);if("error"in o)throw new U(o.error,"failed to get epoch info");return o.result}async getEpochSchedule(){const e=await this._rpcRequest("getEpochSchedule",[]),t=I(e,au);if("error"in t)throw new U(t.error,"failed to get epoch schedule");const r=t.result;return new Rc(r.slotsPerEpoch,r.leaderScheduleSlotOffset,r.warmup,r.firstNormalEpoch,r.firstNormalSlot)}async getLeaderSchedule(){const e=await this._rpcRequest("getLeaderSchedule",[]),t=I(e,cu);if("error"in t)throw new U(t.error,"failed to get leader schedule");return t.result}async getMinimumBalanceForRentExemption(e,t){const r=this._buildArgs([e],t),s=await this._rpcRequest("getMinimumBalanceForRentExemption",r),i=I(s,Uu);return"error"in i?(console.warn("Unable to fetch minimum balance for rent exemption"),0):i.result}async getRecentBlockhashAndContext(e){const t=this._buildArgs([],e),r=await this._rpcRequest("getRecentBlockhash",t),s=I(r,ju);if("error"in s)throw new U(s.error,"failed to get recent blockhash");return s.result}async getRecentPerformanceSamples(e){const t=await this._rpcRequest("getRecentPerformanceSamples",e?[e]:[]),r=I(t,Vu);if("error"in r)throw new U(r.error,"failed to get recent performance samples");return r.result}async getFeeCalculatorForBlockhash(e,t){const r=this._buildArgs([e],t),s=await this._rpcRequest("getFeeCalculatorForBlockhash",r),i=I(s,Ju);if("error"in i)throw new U(i.error,"failed to get fee calculator");const{context:o,value:a}=i.result;return{context:o,value:a!==null?a.feeCalculator:null}}async getFeeForMessage(e,t){const r=At(e.serialize()).toString("base64"),s=this._buildArgs([r],t),i=await this._rpcRequest("getFeeForMessage",s),o=I(i,se(R(m())));if("error"in o)throw new U(o.error,"failed to get fee for message");if(o.result===null)throw new Error("invalid blockhash");return o.result}async getRecentPrioritizationFees(e){var o;const t=(o=e==null?void 0:e.lockedWritableAccounts)==null?void 0:o.map(a=>a.toBase58()),r=this._buildArgs(t!=null&&t.length?[t]:[]),s=await this._rpcRequest("getRecentPrioritizationFees",r),i=I(s,iu);if("error"in i)throw new U(i.error,"failed to get recent prioritization fees");return i.result}async getRecentBlockhash(e){try{return(await this.getRecentBlockhashAndContext(e)).value}catch(t){throw new Error("failed to get recent blockhash: "+t)}}async getLatestBlockhash(e){try{return(await this.getLatestBlockhashAndContext(e)).value}catch(t){throw new Error("failed to get recent blockhash: "+t)}}async getLatestBlockhashAndContext(e){const{commitment:t,config:r}=Q(e),s=this._buildArgs([],t,void 0,r),i=await this._rpcRequest("getLatestBlockhash",s),o=I(i,Wu);if("error"in o)throw new U(o.error,"failed to get latest blockhash");return o.result}async getVersion(){const e=await this._rpcRequest("getVersion",[]),t=I(e,q(Yc));if("error"in t)throw new U(t.error,"failed to get version");return t.result}async getGenesisHash(){const e=await this._rpcRequest("getGenesisHash",[]),t=I(e,q(E()));if("error"in t)throw new U(t.error,"failed to get genesis hash");return t.result}async getBlock(e,t){const{commitment:r,config:s}=Q(t),i=this._buildArgsAtLeastConfirmed([e],r,void 0,s),o=await this._rpcRequest("getBlock",i);try{switch(s==null?void 0:s.transactionDetails){case"accounts":{const a=I(o,Ku);if("error"in a)throw a.error;return a.result}case"none":{const a=I(o,Mu);if("error"in a)throw a.error;return a.result}default:{const a=I(o,Fu);if("error"in a)throw a.error;const{result:c}=a;return c?{...c,transactions:c.transactions.map(({transaction:u,meta:l,version:f})=>({meta:l,transaction:{...u,message:Hr(f,u.message)},version:f}))}:null}}}catch(a){throw new U(a,"failed to get confirmed block")}}async getParsedBlock(e,t){const{commitment:r,config:s}=Q(t),i=this._buildArgsAtLeastConfirmed([e],r,"jsonParsed",s),o=await this._rpcRequest("getBlock",i);try{switch(s==null?void 0:s.transactionDetails){case"accounts":{const a=I(o,Hu);if("error"in a)throw a.error;return a.result}case"none":{const a=I(o,Du);if("error"in a)throw a.error;return a.result}default:{const a=I(o,qu);if("error"in a)throw a.error;return a.result}}}catch(a){throw new U(a,"failed to get block")}}async getBlockProduction(e){let t,r;if(typeof e=="string")r=e;else if(e){const{commitment:a,...c}=e;r=a,t=c}const s=this._buildArgs([],r,"base64",t),i=await this._rpcRequest("getBlockProduction",s),o=I(i,Qc);if("error"in o)throw new U(o.error,"failed to get block production information");return o.result}async getTransaction(e,t){const{commitment:r,config:s}=Q(t),i=this._buildArgsAtLeastConfirmed([e],r,void 0,s),o=await this._rpcRequest("getTransaction",i),a=I(o,Dr);if("error"in a)throw new U(a.error,"failed to get transaction");const c=a.result;return c&&{...c,transaction:{...c.transaction,message:Hr(c.version,c.transaction.message)}}}async getParsedTransaction(e,t){const{commitment:r,config:s}=Q(t),i=this._buildArgsAtLeastConfirmed([e],r,"jsonParsed",s),o=await this._rpcRequest("getTransaction",i),a=I(o,Yt);if("error"in a)throw new U(a.error,"failed to get transaction");return a.result}async getParsedTransactions(e,t){const{commitment:r,config:s}=Q(t),i=e.map(c=>({methodName:"getTransaction",args:this._buildArgsAtLeastConfirmed([c],r,"jsonParsed",s)}));return(await this._rpcBatchRequest(i)).map(c=>{const u=I(c,Yt);if("error"in u)throw new U(u.error,"failed to get transactions");return u.result})}async getTransactions(e,t){const{commitment:r,config:s}=Q(t),i=e.map(c=>({methodName:"getTransaction",args:this._buildArgsAtLeastConfirmed([c],r,void 0,s)}));return(await this._rpcBatchRequest(i)).map(c=>{const u=I(c,Dr);if("error"in u)throw new U(u.error,"failed to get transactions");const l=u.result;return l&&{...l,transaction:{...l.transaction,message:Hr(l.version,l.transaction.message)}}})}async getConfirmedBlock(e,t){const r=this._buildArgsAtLeastConfirmed([e],t),s=await this._rpcRequest("getConfirmedBlock",r),i=I(s,zu);if("error"in i)throw new U(i.error,"failed to get confirmed block");const o=i.result;if(!o)throw new Error("Confirmed block "+e+" not found");const a={...o,transactions:o.transactions.map(({transaction:c,meta:u})=>{const l=new rt(c.message);return{meta:u,transaction:{...c,message:l}}})};return{...a,transactions:a.transactions.map(({transaction:c,meta:u})=>({meta:u,transaction:Xe.populate(c.message,c.signatures)}))}}async getBlocks(e,t,r){const s=this._buildArgsAtLeastConfirmed(t!==void 0?[e,t]:[e],r),i=await this._rpcRequest("getBlocks",s),o=I(i,q(B(m())));if("error"in o)throw new U(o.error,"failed to get blocks");return o.result}async getBlockSignatures(e,t){const r=this._buildArgsAtLeastConfirmed([e],t,void 0,{transactionDetails:"signatures",rewards:!1}),s=await this._rpcRequest("getBlock",r),i=I(s,Yn);if("error"in i)throw new U(i.error,"failed to get block");const o=i.result;if(!o)throw new Error("Block "+e+" not found");return o}async getConfirmedBlockSignatures(e,t){const r=this._buildArgsAtLeastConfirmed([e],t,void 0,{transactionDetails:"signatures",rewards:!1}),s=await this._rpcRequest("getConfirmedBlock",r),i=I(s,Yn);if("error"in i)throw new U(i.error,"failed to get confirmed block");const o=i.result;if(!o)throw new Error("Confirmed block "+e+" not found");return o}async getConfirmedTransaction(e,t){const r=this._buildArgsAtLeastConfirmed([e],t),s=await this._rpcRequest("getConfirmedTransaction",r),i=I(s,Dr);if("error"in i)throw new U(i.error,"failed to get transaction");const o=i.result;if(!o)return o;const a=new rt(o.transaction.message),c=o.transaction.signatures;return{...o,transaction:Xe.populate(a,c)}}async getParsedConfirmedTransaction(e,t){const r=this._buildArgsAtLeastConfirmed([e],t,"jsonParsed"),s=await this._rpcRequest("getConfirmedTransaction",r),i=I(s,Yt);if("error"in i)throw new U(i.error,"failed to get confirmed transaction");return i.result}async getParsedConfirmedTransactions(e,t){const r=e.map(o=>({methodName:"getConfirmedTransaction",args:this._buildArgsAtLeastConfirmed([o],t,"jsonParsed")}));return(await this._rpcBatchRequest(r)).map(o=>{const a=I(o,Yt);if("error"in a)throw new U(a.error,"failed to get confirmed transactions");return a.result})}async getConfirmedSignaturesForAddress(e,t,r){let s={},i=await this.getFirstAvailableBlock();for(;!("until"in s)&&(t--,!(t<=0||t<i));)try{const c=await this.getConfirmedBlockSignatures(t,"finalized");c.signatures.length>0&&(s.until=c.signatures[c.signatures.length-1].toString())}catch(c){if(c instanceof Error&&c.message.includes("skipped"))continue;throw c}let o=await this.getSlot("finalized");for(;!("before"in s)&&(r++,!(r>o));)try{const c=await this.getConfirmedBlockSignatures(r);c.signatures.length>0&&(s.before=c.signatures[c.signatures.length-1].toString())}catch(c){if(c instanceof Error&&c.message.includes("skipped"))continue;throw c}return(await this.getConfirmedSignaturesForAddress2(e,s)).map(c=>c.signature)}async getConfirmedSignaturesForAddress2(e,t,r){const s=this._buildArgsAtLeastConfirmed([e.toBase58()],r,void 0,t),i=await this._rpcRequest("getConfirmedSignaturesForAddress2",s),o=I(i,bu);if("error"in o)throw new U(o.error,"failed to get confirmed signatures for address");return o.result}async getSignaturesForAddress(e,t,r){const s=this._buildArgsAtLeastConfirmed([e.toBase58()],r,void 0,t),i=await this._rpcRequest("getSignaturesForAddress",s),o=I(i,vu);if("error"in o)throw new U(o.error,"failed to get signatures for address");return o.result}async getAddressLookupTable(e,t){const{context:r,value:s}=await this.getAccountInfoAndContext(e,t);let i=null;return s!==null&&(i=new Jn({key:e,state:Jn.deserialize(s.data)})),{context:r,value:i}}async getNonceAndContext(e,t){const{context:r,value:s}=await this.getAccountInfoAndContext(e,t);let i=null;return s!==null&&(i=An.fromAccountData(s.data)),{context:r,value:i}}async getNonce(e,t){return await this.getNonceAndContext(e,t).then(r=>r.value).catch(r=>{throw new Error("failed to get nonce for account "+e.toBase58()+": "+r)})}async requestAirdrop(e,t){const r=await this._rpcRequest("requestAirdrop",[e.toBase58(),t]),s=I(r,Zu);if("error"in s)throw new U(s.error,`airdrop to ${e.toBase58()} failed`);return s.result}async _blockhashWithExpiryBlockHeight(e){if(!e){for(;this._pollingBlockhash;)await bt(100);const r=Date.now()-this._blockhashInfo.lastFetch>=Kc;if(this._blockhashInfo.latestBlockhash!==null&&!r)return this._blockhashInfo.latestBlockhash}return await this._pollNewBlockhash()}async _pollNewBlockhash(){this._pollingBlockhash=!0;try{const e=Date.now(),t=this._blockhashInfo.latestBlockhash,r=t?t.blockhash:null;for(let s=0;s<50;s++){const i=await this.getLatestBlockhash("finalized");if(r!==i.blockhash)return this._blockhashInfo={latestBlockhash:i,lastFetch:Date.now(),transactionSignatures:[],simulatedSignatures:[]},i;await bt(Uc/2)}throw new Error(`Unable to obtain a new blockhash after ${Date.now()-e}ms`)}finally{this._pollingBlockhash=!1}}async getStakeMinimumDelegation(e){const{commitment:t,config:r}=Q(e),s=this._buildArgs([],t,"base64",r),i=await this._rpcRequest("getStakeMinimumDelegation",s),o=I(i,se(m()));if("error"in o)throw new U(o.error,"failed to get stake minimum delegation");return o.result}async simulateTransaction(e,t,r){if("message"in e){const y=e.serialize(),g=H.Buffer.from(y).toString("base64");if(Array.isArray(t)||r!==void 0)throw new Error("Invalid arguments");const k=t||{};k.encoding="base64","commitment"in k||(k.commitment=this.commitment);const v=[g,k],b=await this._rpcRequest("simulateTransaction",v),P=I(b,Zn);if("error"in P)throw new Error("failed to simulate transaction: "+P.error.message);return P.result}let s;if(e instanceof Xe){let d=e;s=new Xe,s.feePayer=d.feePayer,s.instructions=e.instructions,s.nonceInfo=d.nonceInfo,s.signatures=d.signatures}else s=Xe.populate(e),s._message=s._json=void 0;if(t!==void 0&&!Array.isArray(t))throw new Error("Invalid arguments");const i=t;if(s.nonceInfo&&i)s.sign(...i);else{let d=this._disableBlockhashCaching;for(;;){const y=await this._blockhashWithExpiryBlockHeight(d);if(s.lastValidBlockHeight=y.lastValidBlockHeight,s.recentBlockhash=y.blockhash,!i)break;if(s.sign(...i),!s.signature)throw new Error("!signature");const g=s.signature.toString("base64");if(!this._blockhashInfo.simulatedSignatures.includes(g)&&!this._blockhashInfo.transactionSignatures.includes(g)){this._blockhashInfo.simulatedSignatures.push(g);break}else d=!0}}const o=s._compile(),a=o.serialize(),u=s._serialize(a).toString("base64"),l={encoding:"base64",commitment:this.commitment};if(r){const d=(Array.isArray(r)?r:o.nonProgramIds()).map(y=>y.toBase58());l.accounts={encoding:"base64",addresses:d}}i&&(l.sigVerify=!0);const f=[u,l],p=await this._rpcRequest("simulateTransaction",f),h=I(p,Zn);if("error"in h){let d;if("data"in h.error&&(d=h.error.data.logs,d&&Array.isArray(d))){const y=`
    `,g=y+d.join(y);console.error(h.error.message,g)}throw new Gn("failed to simulate transaction: "+h.error.message,d)}return h.result}async sendTransaction(e,t,r){if("version"in e){if(t&&Array.isArray(t))throw new Error("Invalid arguments");const o=e.serialize();return await this.sendRawTransaction(o,t)}if(t===void 0||!Array.isArray(t))throw new Error("Invalid arguments");const s=t;if(e.nonceInfo)e.sign(...s);else{let o=this._disableBlockhashCaching;for(;;){const a=await this._blockhashWithExpiryBlockHeight(o);if(e.lastValidBlockHeight=a.lastValidBlockHeight,e.recentBlockhash=a.blockhash,e.sign(...s),!e.signature)throw new Error("!signature");const c=e.signature.toString("base64");if(this._blockhashInfo.transactionSignatures.includes(c))o=!0;else{this._blockhashInfo.transactionSignatures.push(c);break}}}const i=e.serialize();return await this.sendRawTransaction(i,r)}async sendRawTransaction(e,t){const r=At(e).toString("base64");return await this.sendEncodedTransaction(r,t)}async sendEncodedTransaction(e,t){const r={encoding:"base64"},s=t&&t.skipPreflight,i=t&&t.preflightCommitment||this.commitment;t&&t.maxRetries!=null&&(r.maxRetries=t.maxRetries),t&&t.minContextSlot!=null&&(r.minContextSlot=t.minContextSlot),s&&(r.skipPreflight=s),i&&(r.preflightCommitment=i);const o=[e,r],a=await this._rpcRequest("sendTransaction",o),c=I(a,Xu);if("error"in c){let u;throw"data"in c.error&&(u=c.error.data.logs),new Gn("failed to send transaction: "+c.error.message,u)}return c.result}_wsOnOpen(){this._rpcWebSocketConnected=!0,this._rpcWebSocketHeartbeat=setInterval(()=>{(async()=>{try{await this._rpcWebSocket.notify("ping")}catch{}})()},5e3),this._updateSubscriptions()}_wsOnError(e){this._rpcWebSocketConnected=!1,console.error("ws error:",e.message)}_wsOnClose(e){if(this._rpcWebSocketConnected=!1,this._rpcWebSocketGeneration=(this._rpcWebSocketGeneration+1)%Number.MAX_SAFE_INTEGER,this._rpcWebSocketIdleTimeout&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null),this._rpcWebSocketHeartbeat&&(clearInterval(this._rpcWebSocketHeartbeat),this._rpcWebSocketHeartbeat=null),e===1e3){this._updateSubscriptions();return}this._subscriptionCallbacksByServerSubscriptionId={},Object.entries(this._subscriptionsByHash).forEach(([t,r])=>{this._setSubscription(t,{...r,state:"pending"})})}_setSubscription(e,t){var s;const r=(s=this._subscriptionsByHash[e])==null?void 0:s.state;if(this._subscriptionsByHash[e]=t,r!==t.state){const i=this._subscriptionStateChangeCallbacksByHash[e];i&&i.forEach(o=>{try{o(t.state)}catch{}})}}_onSubscriptionStateChange(e,t){var r;const s=this._subscriptionHashByClientSubscriptionId[e];if(s==null)return()=>{};const i=(r=this._subscriptionStateChangeCallbacksByHash)[s]||(r[s]=new Set);return i.add(t),()=>{i.delete(t),i.size===0&&delete this._subscriptionStateChangeCallbacksByHash[s]}}async _updateSubscriptions(){if(Object.keys(this._subscriptionsByHash).length===0){this._rpcWebSocketConnected&&(this._rpcWebSocketConnected=!1,this._rpcWebSocketIdleTimeout=setTimeout(()=>{this._rpcWebSocketIdleTimeout=null;try{this._rpcWebSocket.close()}catch(r){r instanceof Error&&console.log(`Error when closing socket connection: ${r.message}`)}},500));return}if(this._rpcWebSocketIdleTimeout!==null&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketConnected=!0),!this._rpcWebSocketConnected){this._rpcWebSocket.connect();return}const e=this._rpcWebSocketGeneration,t=()=>e===this._rpcWebSocketGeneration;await Promise.all(Object.keys(this._subscriptionsByHash).map(async r=>{const s=this._subscriptionsByHash[r];if(s!==void 0)switch(s.state){case"pending":case"unsubscribed":if(s.callbacks.size===0){delete this._subscriptionsByHash[r],s.state==="unsubscribed"&&delete this._subscriptionCallbacksByServerSubscriptionId[s.serverSubscriptionId],await this._updateSubscriptions();return}await(async()=>{const{args:i,method:o}=s;try{this._setSubscription(r,{...s,state:"subscribing"});const a=await this._rpcWebSocket.call(o,i);this._setSubscription(r,{...s,serverSubscriptionId:a,state:"subscribed"}),this._subscriptionCallbacksByServerSubscriptionId[a]=s.callbacks,await this._updateSubscriptions()}catch(a){if(a instanceof Error&&console.error(`${o} error for argument`,i,a.message),!t())return;this._setSubscription(r,{...s,state:"pending"}),await this._updateSubscriptions()}})();break;case"subscribed":s.callbacks.size===0&&await(async()=>{const{serverSubscriptionId:i,unsubscribeMethod:o}=s;if(this._subscriptionsAutoDisposedByRpc.has(i))this._subscriptionsAutoDisposedByRpc.delete(i);else{this._setSubscription(r,{...s,state:"unsubscribing"}),this._setSubscription(r,{...s,state:"unsubscribing"});try{await this._rpcWebSocket.call(o,[i])}catch(a){if(a instanceof Error&&console.error(`${o} error:`,a.message),!t())return;this._setSubscription(r,{...s,state:"subscribed"}),await this._updateSubscriptions();return}}this._setSubscription(r,{...s,state:"unsubscribed"}),await this._updateSubscriptions()})();break}}))}_handleServerNotification(e,t){const r=this._subscriptionCallbacksByServerSubscriptionId[e];r!==void 0&&r.forEach(s=>{try{s(...t)}catch(i){console.error(i)}})}_wsOnAccountNotification(e){const{result:t,subscription:r}=I(e,Su);this._handleServerNotification(r,[t.value,t.context])}_makeSubscription(e,t){const r=this._nextClientSubscriptionId++,s=Wn([e.method,t]),i=this._subscriptionsByHash[s];return i===void 0?this._subscriptionsByHash[s]={...e,args:t,callbacks:new Set([e.callback]),state:"pending"}:i.callbacks.add(e.callback),this._subscriptionHashByClientSubscriptionId[r]=s,this._subscriptionDisposeFunctionsByClientSubscriptionId[r]=async()=>{delete this._subscriptionDisposeFunctionsByClientSubscriptionId[r],delete this._subscriptionHashByClientSubscriptionId[r];const o=this._subscriptionsByHash[s];ne(o!==void 0,`Could not find a \`Subscription\` when tearing down client subscription #${r}`),o.callbacks.delete(e.callback),await this._updateSubscriptions()},this._updateSubscriptions(),r}onAccountChange(e,t,r){const s=this._buildArgs([e.toBase58()],r||this._commitment||"finalized","base64");return this._makeSubscription({callback:t,method:"accountSubscribe",unsubscribeMethod:"accountUnsubscribe"},s)}async removeAccountChangeListener(e){await this._unsubscribeClientSubscription(e,"account change")}_wsOnProgramAccountNotification(e){const{result:t,subscription:r}=I(e,Au);this._handleServerNotification(r,[{accountId:t.value.pubkey,accountInfo:t.value.account},t.context])}onProgramAccountChange(e,t,r,s){const i=this._buildArgs([e.toBase58()],r||this._commitment||"finalized","base64",s?{filters:s}:void 0);return this._makeSubscription({callback:t,method:"programSubscribe",unsubscribeMethod:"programUnsubscribe"},i)}async removeProgramAccountChangeListener(e){await this._unsubscribeClientSubscription(e,"program account change")}onLogs(e,t,r){const s=this._buildArgs([typeof e=="object"?{mentions:[e.toString()]}:e],r||this._commitment||"finalized");return this._makeSubscription({callback:t,method:"logsSubscribe",unsubscribeMethod:"logsUnsubscribe"},s)}async removeOnLogsListener(e){await this._unsubscribeClientSubscription(e,"logs")}_wsOnLogsNotification(e){const{result:t,subscription:r}=I(e,Qu);this._handleServerNotification(r,[t.value,t.context])}_wsOnSlotNotification(e){const{result:t,subscription:r}=I(e,_u);this._handleServerNotification(r,[t])}onSlotChange(e){return this._makeSubscription({callback:e,method:"slotSubscribe",unsubscribeMethod:"slotUnsubscribe"},[])}async removeSlotChangeListener(e){await this._unsubscribeClientSubscription(e,"slot change")}_wsOnSlotUpdatesNotification(e){const{result:t,subscription:r}=I(e,Iu);this._handleServerNotification(r,[t])}onSlotUpdate(e){return this._makeSubscription({callback:e,method:"slotsUpdatesSubscribe",unsubscribeMethod:"slotsUpdatesUnsubscribe"},[])}async removeSlotUpdateListener(e){await this._unsubscribeClientSubscription(e,"slot update")}async _unsubscribeClientSubscription(e,t){const r=this._subscriptionDisposeFunctionsByClientSubscriptionId[e];r?await r():console.warn(`Ignored unsubscribe request because an active subscription with id \`${e}\` for '${t}' events could not be found.`)}_buildArgs(e,t,r,s){const i=t||this._commitment;if(i||r||s){let o={};r&&(o.encoding=r),i&&(o.commitment=i),s&&(o=Object.assign(o,s)),e.push(o)}return e}_buildArgsAtLeastConfirmed(e,t,r,s){const i=t||this._commitment;if(i&&!["confirmed","finalized"].includes(i))throw new Error("Using Connection with default commitment: `"+this._commitment+"`, but method requires at least `confirmed`");return this._buildArgs(e,t,r,s)}_wsOnSignatureNotification(e){const{result:t,subscription:r}=I(e,Bu);t.value!=="receivedSignature"&&this._subscriptionsAutoDisposedByRpc.add(r),this._handleServerNotification(r,t.value==="receivedSignature"?[{type:"received"},t.context]:[{type:"status",result:t.value},t.context])}onSignature(e,t,r){const s=this._buildArgs([e],r||this._commitment||"finalized"),i=this._makeSubscription({callback:(o,a)=>{if(o.type==="status"){t(o.result,a);try{this.removeSignatureListener(i)}catch{}}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},s);return i}onSignatureWithOptions(e,t,r){const{commitment:s,...i}={...r,commitment:r&&r.commitment||this._commitment||"finalized"},o=this._buildArgs([e],s,void 0,i),a=this._makeSubscription({callback:(c,u)=>{t(c,u);try{this.removeSignatureListener(a)}catch{}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},o);return a}async removeSignatureListener(e){await this._unsubscribeClientSubscription(e,"signature result")}_wsOnRootNotification(e){const{result:t,subscription:r}=I(e,Ru);this._handleServerNotification(r,[t])}onRootChange(e){return this._makeSubscription({callback:e,method:"rootSubscribe",unsubscribeMethod:"rootUnsubscribe"},[])}async removeRootChangeListener(e){await this._unsubscribeClientSubscription(e,"root change")}}class Ut{constructor(e){this._keypair=void 0,this._keypair=e??Hn()}static generate(){return new Ut(Hn())}static fromSecretKey(e,t){if(e.byteLength!==64)throw new Error("bad secret key size");const r=e.slice(32,64);if(!t||!t.skipValidation){const s=e.slice(0,32),i=Jr(s);for(let o=0;o<32;o++)if(r[o]!==i[o])throw new Error("provided secretKey is invalid")}return new Ut({publicKey:r,secretKey:e})}static fromSeed(e){const t=Jr(e),r=new Uint8Array(64);return r.set(e),r.set(t,32),new Ut({publicKey:t,secretKey:r})}get publicKey(){return new $(this._keypair.publicKey)}get secretKey(){return new Uint8Array(this._keypair.secretKey)}}Object.freeze({CreateLookupTable:{index:0,layout:O([N("instruction"),xt("recentSlot"),V("bumpSeed")])},FreezeLookupTable:{index:1,layout:O([N("instruction")])},ExtendLookupTable:{index:2,layout:O([N("instruction"),xt(),ge(D(),ct(N(),-8),"addresses")])},DeactivateLookupTable:{index:3,layout:O([N("instruction")])},CloseLookupTable:{index:4,layout:O([N("instruction")])}});new $("AddressLookupTab1e1111111111111111111111111");Object.freeze({RequestUnits:{index:0,layout:O([V("instruction"),N("units"),N("additionalFee")])},RequestHeapFrame:{index:1,layout:O([V("instruction"),N("bytes")])},SetComputeUnitLimit:{index:2,layout:O([V("instruction"),N("units")])},SetComputeUnitPrice:{index:3,layout:O([V("instruction"),xt("microLamports")])}});new $("ComputeBudget111111111111111111111111111111");O([V("numSignatures"),V("padding"),Ae("signatureOffset"),Ae("signatureInstructionIndex"),Ae("publicKeyOffset"),Ae("publicKeyInstructionIndex"),Ae("messageDataOffset"),Ae("messageDataSize"),Ae("messageInstructionIndex")]);new $("Ed25519SigVerify111111111111111111111111111");us.hmacSha256Sync=(n,...e)=>{const t=li.create(Gr,n);return e.forEach(r=>t.update(r)),t.digest()};us.isValidPrivateKey;O([V("numSignatures"),Ae("signatureOffset"),V("signatureInstructionIndex"),Ae("ethAddressOffset"),V("ethAddressInstructionIndex"),Ae("messageDataOffset"),Ae("messageDataSize"),V("messageInstructionIndex"),re(20,"ethAddress"),re(64,"signature"),V("recoveryId")]);new $("KeccakSecp256k11111111111111111111111111111");new $("StakeConfig11111111111111111111111111111111");class Qn{constructor(e,t,r){this.unixTimestamp=void 0,this.epoch=void 0,this.custodian=void 0,this.unixTimestamp=e,this.epoch=t,this.custodian=r}}Qn.default=new Qn(0,0,$.default);Object.freeze({Initialize:{index:0,layout:O([N("instruction"),mc(),wc()])},Authorize:{index:1,layout:O([N("instruction"),D("newAuthorized"),N("stakeAuthorizationType")])},Delegate:{index:2,layout:O([N("instruction")])},Split:{index:3,layout:O([N("instruction"),be("lamports")])},Withdraw:{index:4,layout:O([N("instruction"),be("lamports")])},Deactivate:{index:5,layout:O([N("instruction")])},Merge:{index:7,layout:O([N("instruction")])},AuthorizeWithSeed:{index:8,layout:O([N("instruction"),D("newAuthorized"),N("stakeAuthorizationType"),vt("authoritySeed"),D("authorityOwner")])}});new $("Stake11111111111111111111111111111111111111");Object.freeze({InitializeAccount:{index:0,layout:O([N("instruction"),bc()])},Authorize:{index:1,layout:O([N("instruction"),D("newAuthorized"),N("voteAuthorizationType")])},Withdraw:{index:3,layout:O([N("instruction"),be("lamports")])},AuthorizeWithSeed:{index:10,layout:O([N("instruction"),vc()])}});new $("Vote111111111111111111111111111111111111111");new $("Va1idator1nfo111111111111111111111111111111");_({name:E(),website:M(E()),details:M(E()),keybaseUsername:M(E())});new $("Vote111111111111111111111111111111111111111");O([D("nodePubkey"),D("authorizedWithdrawer"),V("commission"),ae(),ge(O([ae("slot"),N("confirmationCount")]),ct(N(),-8),"votes"),V("rootSlotValid"),ae("rootSlot"),ae(),ge(O([ae("epoch"),D("authorizedVoter")]),ct(N(),-8),"authorizedVoters"),O([ge(O([D("authorizedPubkey"),ae("epochOfLastAuthorizedSwitch"),ae("targetEpoch")]),32,"buf"),ae("idx"),V("isEmpty")],"priorVoters"),ae(),ge(O([ae("epoch"),ae("credits"),ae("prevCredits")]),ct(N(),-8),"epochCredits"),O([ae("slot"),ae("timestamp")],"lastTimestamp")]);function tl(n){return function(e,t,r,s){return e.method==="solana_chainId"?(t.result=n,s()):r()}}function rl(n){return function(e,t,r,s){return e.method==="solana_provider_config"?(t.result=n,s()):r()}}function Ei(n){var e=n.chainId;return Kt([tl(e),rl(n)])}function nl(n){var e=n.rpcTarget,t=Fi({rpcTarget:e}),r=Kt([Ei(n),t]);return{networkMiddleware:r,fetchMiddleware:t}}function sl(n){var e=n.getAccounts;return gr(function(){var t=T(S.mark(function r(s,i,o){var a,c;return S.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(a=s.method,a==="getAccounts"){l.next=3;break}return l.abrupt("return",o());case 3:if(e){l.next=5;break}throw new Error("WalletMiddleware - opts.getAccounts not provided");case 5:return l.next=7,e(s);case 7:return c=l.sent,i.result=c,l.abrupt("return",void 0);case 10:case"end":return l.stop()}},r)}));return function(r,s,i){return t.apply(this,arguments)}}())}function il(n){var e=n.requestAccounts;return gr(function(){var t=T(S.mark(function r(s,i,o){var a,c;return S.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(a=s.method,a==="requestAccounts"){l.next=3;break}return l.abrupt("return",o());case 3:if(e){l.next=5;break}throw new Error("WalletMiddleware - opts.requestAccounts not provided");case 5:return l.next=7,e(s);case 7:return c=l.sent,i.result=c,l.abrupt("return",void 0);case 10:case"end":return l.stop()}},r)}));return function(r,s,i){return t.apply(this,arguments)}}())}function Me(n,e){return gr(function(){var t=T(S.mark(function r(s,i,o){var a,c;return S.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(a=s.method,a===n){l.next=3;break}return l.abrupt("return",o());case 3:if(e){l.next=5;break}throw new Error("WalletMiddleware - ".concat(n," not provided"));case 5:return l.next=7,e(s);case 7:return c=l.sent,i.result=c,l.abrupt("return",void 0);case 10:case"end":return l.stop()}},r)}));return function(r,s,i){return t.apply(this,arguments)}}())}function Bn(n){var e=n.getAccounts,t=n.requestAccounts,r=n.signTransaction,s=n.signAndSendTransaction,i=n.signAllTransactions,o=n.signMessage,a=n.getPrivateKey,c=n.getSecretKey;return Kt([il({requestAccounts:t}),sl({getAccounts:e}),Me("signTransaction",r),Me("signAndSendTransaction",s),Me("signAllTransactions",i),Me("signMessage",o),Me("solanaPrivateKey",a),Me("solanaSecretKey",c)])}function ol(n){var e=n.addNewChainConfig,t=n.switchSolanaChain;return Kt([Me("addSolanaChain",e),Me("switchSolanaChain",t)])}function al(n){var e=n.updatePrivatekey;return Kt([Me("updateAccount",e)])}function es(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function ts(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?es(Object(t),!0).forEach(function(r){_t(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):es(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function cl(n){var e=ul();return function(){var r=me(n),s;if(e){var i=me(this).constructor;s=Reflect.construct(r,arguments,i)}else s=r.apply(this,arguments);return ft(this,s)}}function ul(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Br=function(n){lt(t,n);var e=cl(t);function t(r){var s=r.config,i=r.state;return nt(this,t),e.call(this,{config:{chainConfig:ts(ts({},s.chainConfig),{},{chainNamespace:tr.SOLANA})},state:i})}return st(t,[{key:"switchChain",value:function(){var r=T(S.mark(function i(o){return S.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",Promise.resolve());case 1:case"end":return c.stop()}},i)}));function s(i){return r.apply(this,arguments)}return s}()},{key:"setupProvider",value:function(){var r=T(S.mark(function i(o){var a,c,u,l,f,p;return S.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return a=new nn,c=this.getProviderHandlers(o),u=Bn(c),a.push(u),l=Ei(this.config.chainConfig),a.push(l),f=this.getInjectedProviderProxy(o),f&&a.push(f),p=sn(a),this.updateProviderEngineProxy(p),d.next=12,this.lookupNetwork();case 12:case"end":return d.stop()}},i,this)}));function s(i){return r.apply(this,arguments)}return s}()},{key:"lookupNetwork",value:function(){var r=T(S.mark(function i(){var o;return S.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return o=this.config.chainConfig,this.update({chainId:o.chainId}),c.abrupt("return",o.chainId||"");case 3:case"end":return c.stop()}},i,this)}));function s(){return r.apply(this,arguments)}return s}()},{key:"getInjectedProviderProxy",value:function(s){}}]),t}(tn),Rn=function(e){var t={requestAccounts:function(){var r=T(S.mark(function i(){return S.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",e.publicKey?[J.encode(e.publicKey.toBytes())]:[]);case 1:case"end":return a.stop()}},i)}));function s(){return r.apply(this,arguments)}return s}(),getAccounts:function(){var r=T(S.mark(function i(){return S.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",e.publicKey?[J.encode(e.publicKey.toBytes())]:[]);case 1:case"end":return a.stop()}},i)}));function s(){return r.apply(this,arguments)}return s}(),getPrivateKey:function(){var r=T(S.mark(function i(){return S.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:throw z.ethErrors.rpc.methodNotSupported();case 1:case"end":return a.stop()}},i)}));function s(){return r.apply(this,arguments)}return s}(),getSecretKey:function(){var r=T(S.mark(function i(){return S.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:throw z.ethErrors.rpc.methodNotSupported();case 1:case"end":return a.stop()}},i)}));function s(){return r.apply(this,arguments)}return s}(),signTransaction:function(){var r=T(S.mark(function i(o){var a;return S.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,e.signTransaction(o.params.message);case 2:return a=u.sent,u.abrupt("return",a);case 4:case"end":return u.stop()}},i)}));function s(i){return r.apply(this,arguments)}return s}(),signMessage:function(){var r=T(S.mark(function i(o){var a;return S.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,e.signMessage(o.params.message,o.params.display);case 2:return a=u.sent,u.abrupt("return",a.signature);case 4:case"end":return u.stop()}},i)}));function s(i){return r.apply(this,arguments)}return s}(),signAllTransactions:function(){var r=T(S.mark(function i(o){var a,c,u;return S.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!(!((a=o.params)!==null&&a!==void 0&&a.message)||!((c=o.params)!==null&&c!==void 0&&c.message.length))){f.next=2;break}throw z.ethErrors.rpc.invalidParams("message");case 2:return f.next=4,e.signAllTransactions(o.params.message);case 4:return u=f.sent,f.abrupt("return",u);case 6:case"end":return f.stop()}},i)}));function s(i){return r.apply(this,arguments)}return s}(),signAndSendTransaction:function(){var r=T(S.mark(function i(o){var a;return S.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,e.signAndSendTransaction(o.params.message);case 2:return a=u.sent,u.abrupt("return",{signature:a.signature});case 4:case"end":return u.stop()}},i)}));function s(i){return r.apply(this,arguments)}return s}()};return t};function rs(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function ll(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?rs(Object(t),!0).forEach(function(r){_t(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):rs(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function Ii(n){return gr(function(){var e=T(S.mark(function t(r,s,i){var o;return S.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,n.request(ll({},r));case 2:o=c.sent,s.result=o;case 4:case"end":return c.stop()}},t)}));return function(t,r,s){return e.apply(this,arguments)}}())}function fl(n){var e=hl();return function(){var r=me(n),s;if(e){var i=me(this).constructor;s=Reflect.construct(r,arguments,i)}else s=r.apply(this,arguments);return ft(this,s)}}function hl(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Ol=function(n){lt(t,n);var e=fl(t);function t(){return nt(this,t),e.apply(this,arguments)}return st(t,[{key:"getProviderHandlers",value:function(s){return Rn(s)}},{key:"getInjectedProviderProxy",value:function(s){return Ii(s)}}]),t}(Br),dl=function(e,t){var r={requestAccounts:function(){var s=T(S.mark(function o(){var a,c;return S.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,e.connect();case 2:return a=l.sent,c=a.data,l.abrupt("return",[c.publicKey]);case 5:case"end":return l.stop()}},o)}));function i(){return s.apply(this,arguments)}return i}(),getAccounts:function(){var s=T(S.mark(function o(){var a,c;return S.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,e.connect();case 2:return a=l.sent,c=a.data,l.abrupt("return",[c.publicKey]);case 5:case"end":return l.stop()}},o)}));function i(){return s.apply(this,arguments)}return i}(),getPrivateKey:function(){var s=T(S.mark(function o(){return S.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:throw z.ethErrors.rpc.methodNotSupported();case 1:case"end":return c.stop()}},o)}));function i(){return s.apply(this,arguments)}return i}(),getSecretKey:function(){var s=T(S.mark(function o(){return S.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:throw z.ethErrors.rpc.methodNotSupported();case 1:case"end":return c.stop()}},o)}));function i(){return s.apply(this,arguments)}return i}(),signTransaction:function(){var s=T(S.mark(function o(a){var c,u,l,f,p;return S.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(c=a.params.message,c){d.next=3;break}throw z.ethErrors.rpc.invalidRequest({message:"Invalid transaction message"});case 3:return d.next=5,e.signTransaction(J.encode(c.serializeMessage()));case 5:if(u=d.sent,l=u.data,!(!l.publicKey||!l.signature)){d.next=9;break}throw new Error("Invalid signature from slope wallet");case 9:return f=new $(l.publicKey),p=J.decode(l.signature),c.addSignature(f,Buffer.from(p)),d.abrupt("return",c);case 13:case"end":return d.stop()}},o)}));function i(o){return s.apply(this,arguments)}return i}(),signMessage:function(){var s=T(S.mark(function o(a){var c;return S.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,e.signMessage(a.params.message);case 2:return c=l.sent,l.abrupt("return",J.decode(c.data.signature));case 4:case"end":return l.stop()}},o)}));function i(o){return s.apply(this,arguments)}return i}(),signAndSendTransaction:function(){var s=T(S.mark(function o(a){var c,u,l,f,p,h,d,y,g;return S.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(c=t(),c){v.next=3;break}throw z.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 3:if(u=a.params.message,u){v.next=6;break}throw z.ethErrors.rpc.invalidRequest({message:"Invalid transaction message"});case 6:return v.next=8,e.signTransaction(J.encode(u.serializeMessage()));case 8:if(l=v.sent,f=l.data,!(!f.publicKey||!f.signature)){v.next=12;break}throw new Error("Invalid signature from slope wallet");case 12:return p=new $(f.publicKey),h=J.decode(f.signature),u.addSignature(p,Buffer.from(h)),v.next=17,c.request({method:"solana_provider_config",params:[]});case 17:return d=v.sent,y=new In(d.rpcTarget),v.next=21,y.sendRawTransaction(u.serialize());case 21:return g=v.sent,v.abrupt("return",{signature:g});case 23:case"end":return v.stop()}},o)}));function i(o){return s.apply(this,arguments)}return i}(),signAllTransactions:function(){var s=T(S.mark(function o(a){var c,u,l,f,p,h,d,y,g,k,v,b;return S.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(!(!((c=a.params)!==null&&c!==void 0&&c.message)||!((u=a.params)!==null&&u!==void 0&&u.message.length))){x.next=2;break}throw z.ethErrors.rpc.invalidParams("message");case 2:for(f=a.params.message,p=f.length,h=[],d=0;d<p;d++)h.push(J.encode(a.params.message[d].serializeMessage()));return x.next=8,e.signAllTransactions(h);case 8:if(y=x.sent,g=y.msg,k=y.data,!(!k.publicKey||((l=k.signatures)===null||l===void 0?void 0:l.length)!==p)){x.next=13;break}throw new Error(g);case 13:for(v=new $(k.publicKey),d=0;d<p;d++)b=J.decode(k.signatures[d]),f[d].addSignature(v,Buffer.from(b));return x.abrupt("return",f);case 16:case"end":return x.stop()}},o)}));function i(o){return s.apply(this,arguments)}return i}()};return r};function pl(n){var e=gl();return function(){var r=me(n),s;if(e){var i=me(this).constructor;s=Reflect.construct(r,arguments,i)}else s=r.apply(this,arguments);return ft(this,s)}}function gl(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Ul=function(n){lt(t,n);var e=pl(t);function t(){return nt(this,t),e.apply(this,arguments)}return st(t,[{key:"getProviderHandlers",value:function(s){return dl(s,this.getProviderEngineProxy.bind(this))}}]),t}(Br),yl=function(e,t){var r=Rn(e);return r.signAndSendTransaction=function(){var s=T(S.mark(function i(o){var a,c,u,l,f;return S.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(a=t(),a){h.next=3;break}throw z.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 3:return h.next=5,e.signTransaction(o.params.message);case 5:return c=h.sent,h.next=8,a.request({method:"solana_provider_config",params:[]});case 8:return u=h.sent,l=new In(u.rpcTarget),h.next=12,l.sendRawTransaction(c.serialize());case 12:return f=h.sent,h.abrupt("return",{signature:f});case 14:case"end":return h.stop()}},i)}));return function(i){return s.apply(this,arguments)}}(),r};function ml(n){var e=wl();return function(){var r=me(n),s;if(e){var i=me(this).constructor;s=Reflect.construct(r,arguments,i)}else s=r.apply(this,arguments);return ft(this,s)}}function wl(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Nl=function(n){lt(t,n);var e=ml(t);function t(){return nt(this,t),e.apply(this,arguments)}return st(t,[{key:"getProviderHandlers",value:function(s){return yl(s,this.getProviderEngineProxy.bind(this))}}]),t}(Br),bl=function(e,t){var r=Rn(e);return r.signMessage=function(){var s=T(S.mark(function i(o){var a,c;return S.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,e.sign(o.params.message,"utf8");case 2:return a=l.sent,c=a.signature,l.abrupt("return",c);case 5:case"end":return l.stop()}},i)}));return function(i){return s.apply(this,arguments)}}(),r.signAndSendTransaction=function(){var s=T(S.mark(function i(o){var a,c,u,l,f;return S.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(a=t(),a){h.next=3;break}throw z.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 3:return h.next=5,e.signTransaction(o.params.message);case 5:return c=h.sent,h.next=8,a.request({method:"solana_provider_config",params:[]});case 8:return u=h.sent,l=new In(u.rpcTarget),h.next=12,l.sendRawTransaction(c.serialize());case 12:return f=h.sent,h.abrupt("return",{signature:f});case 14:case"end":return h.stop()}},i)}));return function(i){return s.apply(this,arguments)}}(),r};function vl(n){var e=Sl();return function(){var r=me(n),s;if(e){var i=me(this).constructor;s=Reflect.construct(r,arguments,i)}else s=r.apply(this,arguments);return ft(this,s)}}function Sl(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var $l=function(n){lt(t,n);var e=vl(t);function t(){return nt(this,t),e.apply(this,arguments)}return st(t,[{key:"getProviderHandlers",value:function(s){return bl(s,this.getProviderEngineProxy.bind(this))}}]),t}(Br),kl=function(e){var t={requestAccounts:function(){var r=T(S.mark(function i(){var o;return S.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,e.request({method:"solana_requestAccounts",params:{}});case 2:return o=c.sent,c.abrupt("return",o);case 4:case"end":return c.stop()}},i)}));function s(){return r.apply(this,arguments)}return s}(),getAccounts:function(){var r=T(S.mark(function i(){var o;return S.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,e.request({method:"solana_requestAccounts",params:{}});case 2:return o=c.sent,c.abrupt("return",o);case 4:case"end":return c.stop()}},i)}));function s(){return r.apply(this,arguments)}return s}(),getPrivateKey:function(){var r=T(S.mark(function i(){return S.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:throw z.ethErrors.rpc.methodNotSupported();case 1:case"end":return a.stop()}},i)}));function s(){return r.apply(this,arguments)}return s}(),getSecretKey:function(){var r=T(S.mark(function i(){return S.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:throw z.ethErrors.rpc.methodNotSupported();case 1:case"end":return a.stop()}},i)}));function s(){return r.apply(this,arguments)}return s}(),signMessage:function(){var r=T(S.mark(function i(o){var a,c;return S.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if((a=o.params)!==null&&a!==void 0&&a.message){l.next=2;break}throw z.ethErrors.rpc.invalidParams("message");case 2:return l.next=4,e.signMessage(o.params.message);case 4:return c=l.sent,l.abrupt("return",c);case 6:case"end":return l.stop()}},i)}));function s(i){return r.apply(this,arguments)}return s}(),signTransaction:function(){var r=T(S.mark(function i(o){var a,c,u;return S.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if((a=o.params)!==null&&a!==void 0&&a.message){f.next=2;break}throw z.ethErrors.rpc.invalidParams("message");case 2:return c=o.params.message,f.next=5,e.signTransaction(c);case 5:return u=f.sent,f.abrupt("return",u);case 7:case"end":return f.stop()}},i)}));function s(i){return r.apply(this,arguments)}return s}(),signAndSendTransaction:function(){var r=T(S.mark(function i(o){var a,c,u;return S.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if((a=o.params)!==null&&a!==void 0&&a.message){f.next=2;break}throw z.ethErrors.rpc.invalidParams("message");case 2:return c=o.params.message,f.next=5,e.sendTransaction(c);case 5:return u=f.sent,f.abrupt("return",{signature:u});case 7:case"end":return f.stop()}},i)}));function s(i){return r.apply(this,arguments)}return s}(),signAllTransactions:function(){var r=T(S.mark(function i(o){var a,c,u,l;return S.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(!(!((a=o.params)!==null&&a!==void 0&&a.message)||!((c=o.params)!==null&&c!==void 0&&c.message.length))){p.next=2;break}throw z.ethErrors.rpc.invalidParams("message");case 2:return u=o.params.message,p.next=5,e.signAllTransactions(u);case 5:return l=p.sent,p.abrupt("return",l);case 7:case"end":return p.stop()}},i)}));function s(i){return r.apply(this,arguments)}return s}()};return t};function ns(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function Qt(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ns(Object(t),!0).forEach(function(r){_t(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):ns(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function Al(n){var e=xl();return function(){var r=me(n),s;if(e){var i=me(this).constructor;s=Reflect.construct(r,arguments,i)}else s=r.apply(this,arguments);return ft(this,s)}}function xl(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Fl=function(n){lt(t,n);var e=Al(t);function t(r){var s=r.config,i=r.state;return nt(this,t),e.call(this,{config:{chainConfig:Qt(Qt({},s.chainConfig),{},{chainNamespace:tr.SOLANA})},state:i})}return st(t,[{key:"switchChain",value:function(){var r=T(S.mark(function i(o){return S.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",Promise.resolve());case 1:case"end":return c.stop()}},i)}));function s(i){return r.apply(this,arguments)}return s}()},{key:"setupProvider",value:function(){var r=T(S.mark(function i(o){return S.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.handleInjectedProviderUpdate(o),c.next=3,this.setupEngine(o);case 3:case"end":return c.stop()}},i,this)}));function s(i){return r.apply(this,arguments)}return s}()},{key:"lookupNetwork",value:function(){var r=T(S.mark(function i(){var o,a,c;return S.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(this.provider){l.next=2;break}throw z.ethErrors.provider.custom({message:"Torus solana provider is not initialized",code:4902});case 2:return o=this.config.chainConfig.chainId,l.next=5,this.provider.request({method:"solana_chainId"});case 5:if(a=l.sent,c=Tn(a.toString())?a:"0x".concat(parseInt(a,10).toString(16)),o===c){l.next=9;break}throw rn.rpcConnectionError("Invalid network, net_version is: ".concat(c,", expected: ").concat(o));case 9:return this.update({chainId:c}),this.provider.emit("connect",{chainId:this.state.chainId}),this.provider.emit("chainChanged",this.state.chainId),l.abrupt("return",this.state.chainId);case 13:case"end":return l.stop()}},i,this)}));function s(){return r.apply(this,arguments)}return s}()},{key:"setupEngine",value:function(){var r=T(S.mark(function i(o){var a,c,u,l,f;return S.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return a=kl(o),c=Bn(a),u=Ii(o),l=new nn,l.push(c),l.push(u),f=sn(l),this.updateProviderEngineProxy(f),h.next=10,this.lookupNetwork();case 10:case"end":return h.stop()}},i,this)}));function s(i){return r.apply(this,arguments)}return s}()},{key:"handleInjectedProviderUpdate",value:function(){var r=T(S.mark(function i(o){var a=this;return S.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:o.on("accountsChanged",function(){var l=T(S.mark(function f(p){return S.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:a.provider.emit("accountsChanged",p);case 1:case"end":return d.stop()}},f)}));return function(f){return l.apply(this,arguments)}}()),o.on("chainChanged",function(){var l=T(S.mark(function f(p){var h;return S.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return h=Tn(p)?p:"0x".concat(parseInt(p,10).toString(16)),a.configure({chainConfig:Qt(Qt({},a.config.chainConfig),{},{chainId:h})}),y.next=4,a.setupProvider(o);case 4:case"end":return y.stop()}},f)}));return function(f){return l.apply(this,arguments)}}());case 2:case"end":return u.stop()}},i)}));function s(i){return r.apply(this,arguments)}return s}()}]),t}(tn);function _l(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=El(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,s=function(){};return{s,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(u){throw u},f:s}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,a;return{s:function(){t=t.call(n)},n:function(){var u=t.next();return i=u.done,u},e:function(u){o=!0,a=u},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw a}}}}function El(n,e){if(n){if(typeof n=="string")return ss(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return ss(n,e)}}function ss(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function Il(n){return en.apply(this,arguments)}function en(){return en=T(S.mark(function n(e){var t,r,s,i,o;return S.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(t=e.privKey,r=e.getProviderEngineProxy,s=function(){return Ut.fromSecretKey(Buffer.from(t,"hex"))},typeof t=="string"){c.next=4;break}throw rn.invalidParams("privKey must be a string");case 4:return i=s(),o={requestAccounts:function(){var u=T(S.mark(function f(){return S.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",[i.publicKey.toBase58()]);case 1:case"end":return h.stop()}},f)}));function l(){return u.apply(this,arguments)}return l}(),getAccounts:function(){var u=T(S.mark(function f(){return S.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",[i.publicKey.toBase58()]);case 1:case"end":return h.stop()}},f)}));function l(){return u.apply(this,arguments)}return l}(),getPrivateKey:function(){var u=T(S.mark(function f(){return S.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",t);case 1:case"end":return h.stop()}},f)}));function l(){return u.apply(this,arguments)}return l}(),getSecretKey:function(){var u=T(S.mark(function f(){return S.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",J.encode(i.secretKey));case 1:case"end":return h.stop()}},f)}));function l(){return u.apply(this,arguments)}return l}(),signTransaction:function(){var u=T(S.mark(function f(p){var h,d;return S.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if((h=p.params)!==null&&h!==void 0&&h.message){g.next=2;break}throw z.ethErrors.rpc.invalidParams("message");case 2:return d=p.params.message,d.partialSign(i),g.abrupt("return",d);case 5:case"end":return g.stop()}},f)}));function l(f){return u.apply(this,arguments)}return l}(),signMessage:function(){var u=T(S.mark(function f(p){var h,d;return S.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if((h=p.params)!==null&&h!==void 0&&h.message){g.next=2;break}throw z.ethErrors.rpc.invalidParams("message");case 2:return d=Mi.sign.detached(p.params.message,i.secretKey),g.abrupt("return",d);case 4:case"end":return g.stop()}},f)}));function l(f){return u.apply(this,arguments)}return l}(),signAndSendTransaction:function(){var u=T(S.mark(function f(p){var h,d,y,g;return S.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if((h=p.params)!==null&&h!==void 0&&h.message){v.next=2;break}throw z.ethErrors.rpc.invalidParams("message");case 2:if(d=r(),d){v.next=5;break}throw z.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 5:return y=p.params.message,y.sign(i),v.next=9,d.request({method:"sendTransaction",params:[J.encode(y.serialize())]});case 9:return g=v.sent,v.abrupt("return",{signature:g});case 11:case"end":return v.stop()}},f)}));function l(f){return u.apply(this,arguments)}return l}(),signAllTransactions:function(){var u=T(S.mark(function f(p){var h,d,y,g,k,v,b,P;return S.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:if(!(!((h=p.params)!==null&&h!==void 0&&h.message)||!((d=p.params)!==null&&d!==void 0&&d.message.length))){L.next=2;break}throw z.ethErrors.rpc.invalidParams("message");case 2:g=(y=p.params)===null||y===void 0?void 0:y.message,k=_l(g||[]);try{for(k.s();!(v=k.n()).done;)b=v.value,P=b,P.partialSign(i)}catch(C){k.e(C)}finally{k.f()}return L.abrupt("return",g);case 6:case"end":return L.stop()}},f)}));function l(f){return u.apply(this,arguments)}return l}()},c.abrupt("return",o);case 7:case"end":return c.stop()}},n)})),en.apply(this,arguments)}function is(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function os(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?is(Object(t),!0).forEach(function(r){_t(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):is(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function Bl(n){var e=Rl();return function(){var r=me(n),s;if(e){var i=me(this).constructor;s=Reflect.construct(r,arguments,i)}else s=r.apply(this,arguments);return ft(this,s)}}function Rl(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var as=function(n){lt(t,n);var e=Bl(t);function t(r){var s=r.config,i=r.state;return nt(this,t),e.call(this,{config:{chainConfig:os(os({},s.chainConfig),{},{chainNamespace:tr.SOLANA})},state:i})}return st(t,[{key:"enable",value:function(){var r=T(S.mark(function i(){return S.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(this.state.privateKey){a.next=2;break}throw z.ethErrors.provider.custom({message:"Private key is not found in state, plz pass it in constructor state param",code:4902});case 2:return a.next=4,this.setupProvider(this.state.privateKey);case 4:return a.abrupt("return",this._providerEngineProxy.request({method:"eth_accounts"}));case 5:case"end":return a.stop()}},i,this)}));function s(){return r.apply(this,arguments)}return s}()},{key:"setupProvider",value:function(){var r=T(S.mark(function i(o){var a,c,u,l,f,p;return S.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,Il({privKey:o,getProviderEngineProxy:this.getProviderEngineProxy.bind(this)});case 2:return a=d.sent,c=Bn(a),u=new nn,l=nl(this.config.chainConfig),f=l.networkMiddleware,u.push(this.getChainSwitchMiddleware()),u.push(this.getAccountMiddleware()),u.push(c),u.push(f),p=sn(u),this.updateProviderEngineProxy(p),d.next=14,this.lookupNetwork();case 14:case"end":return d.stop()}},i,this)}));function s(i){return r.apply(this,arguments)}return s}()},{key:"updateAccount",value:function(){var r=T(S.mark(function i(o){var a;return S.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(this._providerEngineProxy){u.next=2;break}throw z.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 2:return u.next=4,this._providerEngineProxy.request({method:"solanaPrivateKey"});case 4:if(a=u.sent,a===o.privateKey){u.next=14;break}return u.next=8,this.setupProvider(o.privateKey);case 8:return u.t0=this._providerEngineProxy,u.next=11,this._providerEngineProxy.request({method:"requestAccounts"});case 11:u.t1=u.sent,u.t2={accounts:u.t1},u.t0.emit.call(u.t0,"accountsChanged",u.t2);case 14:case"end":return u.stop()}},i,this)}));function s(i){return r.apply(this,arguments)}return s}()},{key:"switchChain",value:function(){var r=T(S.mark(function i(o){var a,c;return S.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(this._providerEngineProxy){l.next=2;break}throw z.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 2:return a=this.getChainConfig(o.chainId),this.update({chainId:"loading"}),this.configure({chainConfig:a}),l.next=7,this._providerEngineProxy.request({method:"solanaPrivateKey"});case 7:return c=l.sent,l.next=10,this.setupProvider(c);case 10:case"end":return l.stop()}},i,this)}));function s(i){return r.apply(this,arguments)}return s}()},{key:"lookupNetwork",value:function(){var r=T(S.mark(function i(){var o,a;return S.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(this._providerEngineProxy){u.next=2;break}throw z.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 2:return u.next=4,this._providerEngineProxy.request({method:"getHealth",params:[]});case 4:if(o=u.sent,a=this.config.chainConfig,o==="ok"){u.next=8;break}throw rn.rpcConnectionError("Failed to lookup network for following rpc target: ".concat(a.rpcTarget));case 8:return this.update({chainId:a.chainId}),this.state.chainId!==a.chainId&&(this.provider.emit("chainChanged",this.state.chainId),this.provider.emit("connect",{chainId:this.state.chainId})),u.abrupt("return",this.state.chainId);case 11:case"end":return u.stop()}},i,this)}));function s(){return r.apply(this,arguments)}return s}()},{key:"getChainSwitchMiddleware",value:function(){var s=this,i={addNewChainConfig:function(){var a=T(S.mark(function u(l){var f,p,h,d,y,g;return S.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(l.params){v.next=2;break}throw z.ethErrors.rpc.invalidParams("Missing request params");case 2:if(f=l.params,p=f.chainId,h=f.chainName,d=f.rpcUrls,y=f.blockExplorerUrls,g=f.nativeCurrency,p){v.next=5;break}throw z.ethErrors.rpc.invalidParams("Missing chainId in chainParams");case 5:if(!(!d||d.length===0)){v.next=7;break}throw z.ethErrors.rpc.invalidParams("Missing rpcUrls in chainParams");case 7:if(g){v.next=9;break}throw z.ethErrors.rpc.invalidParams("Missing nativeCurrency in chainParams");case 9:s.addChain({chainNamespace:tr.SOLANA,chainId:p,ticker:(g==null?void 0:g.symbol)||"SOL",tickerName:(g==null?void 0:g.name)||"Solana",displayName:h,rpcTarget:d[0],blockExplorer:(y==null?void 0:y[0])||""});case 10:case"end":return v.stop()}},u)}));function c(u){return a.apply(this,arguments)}return c}(),switchSolanaChain:function(){var a=T(S.mark(function u(l){return S.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(l.params){p.next=2;break}throw z.ethErrors.rpc.invalidParams("Missing request params");case 2:if(l.params.chainId){p.next=4;break}throw z.ethErrors.rpc.invalidParams("Missing chainId");case 4:return p.next=6,s.switchChain(l.params);case 6:case"end":return p.stop()}},u)}));function c(u){return a.apply(this,arguments)}return c}()},o=ol(i);return o}},{key:"getAccountMiddleware",value:function(){var s=this,i={updatePrivatekey:function(){var o=T(S.mark(function c(u){var l;return S.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(u.params){p.next=2;break}throw z.ethErrors.rpc.invalidParams("Missing request params");case 2:if(u.params.privateKey){p.next=4;break}throw z.ethErrors.rpc.invalidParams("Missing privateKey");case 4:return l=u.params.privateKey,p.next=7,s.updateAccount({privateKey:l});case 7:case"end":return p.stop()}},c)}));function a(c){return o.apply(this,arguments)}return a}()};return al(i)}}]),t}(tn);_t(as,"getProviderInstance",function(){var n=T(S.mark(function e(t){var r;return S.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return r=new as({config:{chainConfig:t.chainConfig}}),i.next=3,r.setupProvider(t.privKey);case 3:return i.abrupt("return",r);case 4:case"end":return i.stop()}},e)}));return function(e){return n.apply(this,arguments)}}());var Ml=function(){function n(e){nt(this,n),_t(this,"provider",void 0),this.provider=e}return st(n,[{key:"requestAccounts",value:function(){var e=T(S.mark(function r(){var s;return S.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.provider.request({method:"requestAccounts",params:{}});case 2:return s=o.sent,o.abrupt("return",s);case 4:case"end":return o.stop()}},r,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"signAndSendTransaction",value:function(){var e=T(S.mark(function r(s){var i,o;return S.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.provider.request({method:"signAndSendTransaction",params:{message:s}});case 2:return i=c.sent,o=i.signature,c.abrupt("return",{signature:o});case 5:case"end":return c.stop()}},r,this)}));function t(r){return e.apply(this,arguments)}return t}()},{key:"signTransaction",value:function(){var e=T(S.mark(function r(s){var i;return S.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.provider.request({method:"signTransaction",params:{message:s}});case 2:return i=a.sent,a.abrupt("return",i);case 4:case"end":return a.stop()}},r,this)}));function t(r){return e.apply(this,arguments)}return t}()},{key:"signAllTransactions",value:function(){var e=T(S.mark(function r(s){var i;return S.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.provider.request({method:"signAllTransactions",params:{message:s}});case 2:return i=a.sent,a.abrupt("return",i);case 4:case"end":return a.stop()}},r,this)}));function t(r){return e.apply(this,arguments)}return t}()},{key:"signMessage",value:function(){var e=T(S.mark(function r(s){var i;return S.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.provider.request({method:"signMessage",params:{message:s}});case 2:return i=a.sent,a.abrupt("return",i);case 4:case"end":return a.stop()}},r,this)}));function t(r){return e.apply(this,arguments)}return t}()},{key:"request",value:function(){var e=T(S.mark(function r(s){var i;return S.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.provider.request(s);case 2:return i=a.sent,a.abrupt("return",i);case 4:case"end":return a.stop()}},r,this)}));function t(r){return e.apply(this,arguments)}return t}()}]),n}();export{Ol as PhantomInjectedProvider,Ul as SlopeInjectedProxyProvider,as as SolanaPrivateKeyProvider,Ml as SolanaWallet,Nl as SolflareInjectedProvider,$l as SolletInjectedProvider,Fl as TorusInjectedProvider};
